<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Brian Cervantes Alvarez">
<meta name="dcterms.date" content="2023-03-11">

<title>Brian Cervantes Alvarez - Predicting Customer Returns</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<link href="https://fonts.cdnfonts.com/css/dm-sans" rel="stylesheet">


<link rel="stylesheet" href="../../styles.css">
<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Brian Cervantes Alvarez</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Portfolio</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../resume.html">
 <span class="menu-text">Resume</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About Me</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/bcervantesalvarez/"><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/bcervantesalvarez/"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:briancervantesalvarez@gmail.com"><i class="bi bi-envelope-fill" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-page-left">
      <h1 class="title">Predicting Customer Returns</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">R</div>
                <div class="quarto-category">machine learning</div>
                <div class="quarto-category">logistical model</div>
                <div class="quarto-category">data visualization</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Brian Cervantes Alvarez </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 11, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#approach-and-methodology" id="toc-approach-and-methodology" class="nav-link active" data-scroll-target="#approach-and-methodology">Approach and Methodology</a></li>
  <li><a href="#load-the-required-packages" id="toc-load-the-required-packages" class="nav-link" data-scroll-target="#load-the-required-packages">Load the required packages</a></li>
  <li><a href="#load-the-training-and-test-data" id="toc-load-the-training-and-test-data" class="nav-link" data-scroll-target="#load-the-training-and-test-data">Load the training and test data</a></li>
  <li><a href="#data-exploration" id="toc-data-exploration" class="nav-link" data-scroll-target="#data-exploration">Data Exploration</a></li>
  <li><a href="#feature-engineering" id="toc-feature-engineering" class="nav-link" data-scroll-target="#feature-engineering">Feature Engineering</a></li>
  <li><a href="#fit-a-logistical-regression-model" id="toc-fit-a-logistical-regression-model" class="nav-link" data-scroll-target="#fit-a-logistical-regression-model">Fit a Logistical Regression Model</a></li>
  <li><a href="#make-prediction-on-the-test-data" id="toc-make-prediction-on-the-test-data" class="nav-link" data-scroll-target="#make-prediction-on-the-test-data">Make prediction on the test data</a></li>
  <li><a href="#writing-the-submission-file" id="toc-writing-the-submission-file" class="nav-link" data-scroll-target="#writing-the-submission-file">Writing the Submission File</a></li>
  <li><a href="#leftout-features-that-were-considered" id="toc-leftout-features-that-were-considered" class="nav-link" data-scroll-target="#leftout-features-that-were-considered">Leftout Features that were considered</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block column-page-left" id="quarto-document-content">




<p><img src="return.jpeg" class="img-fluid"></p>
<section id="approach-and-methodology" class="level2">
<h2 class="anchored" data-anchor-id="approach-and-methodology">Approach and Methodology</h2>
<p>To ensure proper analysis, I began by loading the necessary libraries and examining the train and test datasets to identify the variables available for analysis. Exploration of the data revealed trends in the number of returns across various variables such as ProductDepartment, ProductSize, and Returns Per State. Given the project objective of predicting the probability of item returns, I selected logistic regression, a well-suited model for binary dependent variables. To prepare the data, I developed a function to transform both the train and test data, ensuring dimensionality was kept in check by removing unnecessary columns such as dates and IDs. Additionally, I updated character data types to factors. Further exploration of the data led to the inclusion of additional features, such as “Season”, “CustomerAge”, “MSRP”, and “PriceRange”, that may play a significant role in predicting a customer’s probability of returning their product. I then ran the logistic model and examined the coefficients, noting the highest ratios for ProductDepartment, with a significant influence from men’s and women’s products. Noting that for future exploration, I concluded my model and wrote the submssion file.</p>
<p>Note: I had explored the idea of using rpart, rf and gbm, however I was not accustomed to using those models. There was much more refinement to be done, but the 3 hour constraint kept me focused on building a draft of the model. Would this go into production? No, but it would be a step in the right direction.</p>
</section>
<section id="load-the-required-packages" class="level2">
<h2 class="anchored" data-anchor-id="load-the-required-packages">Load the required packages</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="load-the-training-and-test-data" class="level2">
<h2 class="anchored" data-anchor-id="load-the-training-and-test-data">Load the training and test data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"train.csv"</span>) </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"test.csv"</span>) </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 64,912
Columns: 12
$ ID                &lt;chr&gt; "58334388-e72d-40d3-afcf-59561c262e86", "fb73c186-ca…
$ OrderID           &lt;chr&gt; "4fc2f4ea-7098-4e9d-87b1-52b6a9ee21fd", "4fc2f4ea-70…
$ CustomerID        &lt;chr&gt; "c401d50e-37b7-45ea-801a-d71c13ea6387", "c401d50e-37…
$ CustomerState     &lt;chr&gt; "Kentucky", "Kentucky", "Kentucky", "Kentucky", "Ind…
$ CustomerBirthDate &lt;date&gt; 1967-01-06, 1967-01-06, 1967-01-06, 1967-01-06, 197…
$ OrderDate         &lt;date&gt; 2016-01-06, 2016-01-06, 2016-01-06, 2016-01-06, 201…
$ ProductDepartment &lt;chr&gt; "Youth", "Mens", "Mens", "Mens", "Womens", "Womens",…
$ ProductSize       &lt;chr&gt; "M", "L", "XL", "L", "XS", "M", "XS", "M", "M", "M",…
$ ProductCost       &lt;dbl&gt; 9, 17, 20, 17, 42, 39, 13, 3, 12, 27, 20, 23, 49, 16…
$ DiscountPct       &lt;dbl&gt; 0.0356, 0.1192, 0.1698, 0.1973, 0.0663, 0.0501, 0.08…
$ PurchasePrice     &lt;dbl&gt; 28.93, 44.92, 48.98, 51.37, 113.91, 121.59, 41.40, 1…
$ Returned          &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 1…</code></pre>
</div>
</div>
</section>
<section id="data-exploration" class="level2">
<h2 class="anchored" data-anchor-id="data-exploration">Data Exploration</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at Product Department</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>train <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Returned <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ProductDepartment)) <span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"#e67838"</span>) <span class="sc">+</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Number of Returns Per Department"</span>) <span class="sc">+</span> </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at Product Size</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>train <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Returned <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ProductSize)) <span class="sc">+</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"#e67838"</span>) <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Number of Returns Per Product Size"</span>) <span class="sc">+</span> </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-3-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#This won't be that valuable</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>train <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">CustomerState =</span> <span class="fu">factor</span>(CustomerState)) <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Returned <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> CustomerState)) <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"#e67838"</span>) <span class="sc">+</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Number of Returns Per State"</span>) <span class="sc">+</span> </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-3-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="feature-engineering" class="level2">
<h2 class="anchored" data-anchor-id="feature-engineering">Feature Engineering</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creates the features</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>buildFeatures <span class="ot">&lt;-</span> <span class="cf">function</span>(ds){</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  CurrentDate <span class="ot">&lt;-</span> <span class="fu">Sys.Date</span>()</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  ds <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Returned =</span> <span class="fu">factor</span>(Returned, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>,<span class="st">"Yes"</span>)),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Season =</span> <span class="fu">factor</span>(<span class="fu">case_when</span>(<span class="fu">months</span>(OrderDate) <span class="sc">%in%</span> month.name[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>] <span class="sc">~</span> <span class="st">"Winter"</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">months</span>(OrderDate) <span class="sc">%in%</span> month.name[<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>] <span class="sc">~</span> <span class="st">"Spring"</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">months</span>(OrderDate) <span class="sc">%in%</span> month.name[<span class="dv">7</span><span class="sc">:</span><span class="dv">9</span>] <span class="sc">~</span> <span class="st">"Summer"</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">months</span>(OrderDate) <span class="sc">%in%</span> month.name[<span class="dv">10</span><span class="sc">:</span><span class="dv">12</span>] <span class="sc">~</span> <span class="st">"Fall"</span>)), </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">CustomerAge =</span> <span class="fu">year</span>(<span class="fu">as.period</span>(<span class="fu">interval</span>(CustomerBirthDate,CurrentDate))),</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">MSRP =</span> <span class="fu">round</span>(PurchasePrice <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> DiscountPct)),</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">PriceRange =</span> <span class="fu">factor</span>(<span class="fu">case_when</span>(MSRP <span class="sc">&gt;=</span> <span class="dv">13</span> <span class="sc">&amp;</span> MSRP <span class="sc">&lt;=</span> <span class="dv">30</span> <span class="sc">~</span> <span class="st">"$13-$30"</span>,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>                             MSRP <span class="sc">&gt;</span> <span class="dv">30</span> <span class="sc">&amp;</span> MSRP <span class="sc">&lt;=</span> <span class="dv">60</span> <span class="sc">~</span> <span class="st">"$31-$60"</span>,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>                             MSRP <span class="sc">&gt;</span> <span class="dv">60</span> <span class="sc">&amp;</span> MSRP <span class="sc">&lt;=</span> <span class="dv">100</span> <span class="sc">~</span> <span class="st">"$61-$100"</span>,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>                             MSRP <span class="sc">&gt;</span> <span class="dv">100</span> <span class="sc">~</span> <span class="st">"&gt;$100"</span>)),</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">ProductDepartment =</span> <span class="fu">as.factor</span>(ProductDepartment),</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">ProductSize =</span> <span class="fu">as.factor</span>(ProductSize),</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">CustomerState =</span> <span class="fu">as.factor</span>(CustomerState)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>OrderDate, </span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span>CustomerBirthDate, </span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span>ID, </span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span>OrderID, </span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span>CustomerID)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>IDCols <span class="ot">&lt;-</span> test<span class="sc">$</span>ID</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a><span class="co">#Removes and adds columns for train and test sets</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="fu">buildFeatures</span>(train)</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">buildFeatures</span>(test)</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a><span class="co">#Inspect the dataset before training the model</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 64,912
Columns: 11
$ CustomerState     &lt;fct&gt; Kentucky, Kentucky, Kentucky, Kentucky, Indiana, Ind…
$ ProductDepartment &lt;fct&gt; Youth, Mens, Mens, Mens, Womens, Womens, Youth, Yout…
$ ProductSize       &lt;fct&gt; M, L, XL, L, XS, M, XS, M, M, M, L, L, XL, M, XXL, M…
$ ProductCost       &lt;dbl&gt; 9, 17, 20, 17, 42, 39, 13, 3, 12, 27, 20, 23, 49, 16…
$ DiscountPct       &lt;dbl&gt; 0.0356, 0.1192, 0.1698, 0.1973, 0.0663, 0.0501, 0.08…
$ PurchasePrice     &lt;dbl&gt; 28.93, 44.92, 48.98, 51.37, 113.91, 121.59, 41.40, 1…
$ Returned          &lt;fct&gt; No, No, No, No, No, No, No, No, No, Yes, No, No, No,…
$ Season            &lt;fct&gt; Winter, Winter, Winter, Winter, Winter, Winter, Wint…
$ CustomerAge       &lt;dbl&gt; 56, 56, 56, 56, 44, 44, 44, 56, 56, 56, 58, 58, 39, …
$ MSRP              &lt;dbl&gt; 30, 51, 59, 64, 122, 128, 45, 17, 55, 82, 91, 108, 9…
$ PriceRange        &lt;fct&gt; $13-$30, $31-$60, $31-$60, $61-$100, &gt;$100, &gt;$100, $…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      CustomerState     ProductDepartment ProductSize  ProductCost   
 California  : 7612   Accessories: 3952   ~  : 3952   Min.   : 3.00  
 Texas       : 5455   Mens       :27695   L  :16588   1st Qu.:18.00  
 New York    : 4002   Womens     :26922   M  :16223   Median :25.00  
 Florida     : 3875   Youth      : 6343   S  : 9674   Mean   :26.01  
 Illinois    : 2686                       XL : 8874   3rd Qu.:33.00  
 Pennsylvania: 2547                       XS : 5235   Max.   :59.00  
 (Other)     :38735                       XXL: 4366                  
  DiscountPct     PurchasePrice    Returned       Season       CustomerAge   
 Min.   :0.0019   Min.   :  8.73   No :42035   Fall  :23194   Min.   :26.00  
 1st Qu.:0.0882   1st Qu.: 44.79   Yes:22877   Spring:12576   1st Qu.:36.00  
 Median :0.1717   Median : 62.54               Summer:16620   Median :47.00  
 Mean   :0.1689   Mean   : 65.42               Winter:12522   Mean   :48.26  
 3rd Qu.:0.2541   3rd Qu.: 84.84                              3rd Qu.:60.00  
 Max.   :0.3329   Max.   :132.72                              Max.   :77.00  
                                                                             
      MSRP           PriceRange   
 Min.   : 13.00   &gt;$100   :17087  
 1st Qu.: 55.00   $13-$30 : 2720  
 Median : 77.00   $31-$60 :18193  
 Mean   : 78.51   $61-$100:26912  
 3rd Qu.:102.00                   
 Max.   :133.00                   
                                  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(train<span class="sc">$</span>Returned)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   No   Yes 
42035 22877 </code></pre>
</div>
</div>
</section>
<section id="fit-a-logistical-regression-model" class="level2">
<h2 class="anchored" data-anchor-id="fit-a-logistical-regression-model">Fit a Logistical Regression Model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">345</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Model using Logistical Regression</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>logModel <span class="ot">&lt;-</span> <span class="fu">glm</span>(Returned <span class="sc">~</span> .,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> train,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logModel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Returned ~ ., family = "binomial", data = train)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.2617  -0.9725  -0.8697   1.3508   2.2074  

Coefficients: (1 not defined because of singularities)
                              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                 -1.5204170  0.1444030 -10.529  &lt; 2e-16 ***
CustomerStateAlaska         -0.3745168  0.2706629  -1.384  0.16645    
CustomerStateArizona        -0.1559535  0.0865001  -1.803  0.07140 .  
CustomerStateArkansas       -0.1680269  0.1086315  -1.547  0.12192    
CustomerStateCalifornia     -0.1757649  0.0719039  -2.444  0.01451 *  
CustomerStateColorado       -0.1682868  0.0931554  -1.807  0.07084 .  
CustomerStateConnecticut    -0.1087649  0.1043767  -1.042  0.29739    
CustomerStateDC             -0.1803593  0.2203419  -0.819  0.41305    
CustomerStateDelaware        0.1134396  0.1748311   0.649  0.51643    
CustomerStateFlorida        -0.1420662  0.0757237  -1.876  0.06064 .  
CustomerStateGeorgia        -0.0615201  0.0818030  -0.752  0.45202    
CustomerStateHawaii         -0.1545264  0.1520539  -1.016  0.30951    
CustomerStateIdaho          -0.1194081  0.1236664  -0.966  0.33426    
CustomerStateIllinois       -0.1515665  0.0790256  -1.918  0.05512 .  
CustomerStateIndiana        -0.0053376  0.0872975  -0.061  0.95125    
CustomerStateIowa           -0.1039855  0.1103701  -0.942  0.34611    
CustomerStateKansas         -0.2496458  0.1112347  -2.244  0.02481 *  
CustomerStateKentucky       -0.3531264  0.1073438  -3.290  0.00100 ** 
CustomerStateLouisiana      -0.2381560  0.0915155  -2.602  0.00926 ** 
CustomerStateMaine          -0.2986534  0.1477344  -2.022  0.04322 *  
CustomerStateMaryland       -0.1224028  0.0910360  -1.345  0.17877    
CustomerStateMassachusetts  -0.1545115  0.0849803  -1.818  0.06903 .  
CustomerStateMichigan       -0.2591744  0.0849511  -3.051  0.00228 ** 
CustomerStateMinnesota      -0.1422575  0.0912242  -1.559  0.11890    
CustomerStateMississippi    -0.0312455  0.1186160  -0.263  0.79223    
CustomerStateMissouri       -0.2411922  0.0950728  -2.537  0.01118 *  
CustomerStateMontana        -0.1814644  0.1471433  -1.233  0.21748    
CustomerStateNebraska       -0.2027473  0.1442761  -1.405  0.15994    
CustomerStateNevada         -0.0743860  0.1120681  -0.664  0.50685    
CustomerStateNew Hampshire  -0.0996571  0.1588999  -0.627  0.53055    
CustomerStateNew Jersey     -0.1238822  0.0855308  -1.448  0.14751    
CustomerStateNew Mexico     -0.3891323  0.1352394  -2.877  0.00401 ** 
CustomerStateNew York       -0.1653762  0.0755573  -2.189  0.02862 *  
CustomerStateNorth Carolina -0.0281690  0.0820686  -0.343  0.73142    
CustomerStateNorth Dakota   -0.1843492  0.1735505  -1.062  0.28813    
CustomerStateOhio           -0.1949632  0.0798819  -2.441  0.01466 *  
CustomerStateOklahoma       -0.2468512  0.1055238  -2.339  0.01932 *  
CustomerStateOregon         -0.0733648  0.0871922  -0.841  0.40012    
CustomerStatePennsylvania   -0.1311007  0.0795873  -1.647  0.09951 .  
CustomerStateRhode Island   -0.1558779  0.1663353  -0.937  0.34869    
CustomerStateSouth Carolina -0.2159403  0.0967242  -2.233  0.02558 *  
CustomerStateSouth Dakota   -0.1269469  0.1633225  -0.777  0.43699    
CustomerStateTennessee      -0.0368559  0.0889942  -0.414  0.67877    
CustomerStateTexas          -0.0777116  0.0733482  -1.059  0.28938    
CustomerStateUtah           -0.1711151  0.1082903  -1.580  0.11407    
CustomerStateVermont        -0.0439923  0.2076074  -0.212  0.83218    
CustomerStateVirginia       -0.1540969  0.0840292  -1.834  0.06668 .  
CustomerStateWashington     -0.1241350  0.0861621  -1.441  0.14967    
CustomerStateWest Virginia  -0.1091140  0.1396389  -0.781  0.43457    
CustomerStateWisconsin      -0.0821141  0.0921258  -0.891  0.37275    
CustomerStateWyoming        -0.3274862  0.2007843  -1.631  0.10288    
ProductDepartmentMens        1.4347920  0.0631408  22.724  &lt; 2e-16 ***
ProductDepartmentWomens      1.4951526  0.0638800  23.406  &lt; 2e-16 ***
ProductDepartmentYouth       0.9448759  0.0657464  14.372  &lt; 2e-16 ***
ProductSizeL                -0.0385464  0.0353477  -1.090  0.27550    
ProductSizeM                -0.0780394  0.0354060  -2.204  0.02752 *  
ProductSizeS                -0.0406230  0.0378432  -1.073  0.28307    
ProductSizeXL               -0.0377867  0.0381043  -0.992  0.32136    
ProductSizeXS               -0.0753978  0.0426810  -1.767  0.07730 .  
ProductSizeXXL                      NA         NA      NA       NA    
ProductCost                 -0.0041875  0.0012801  -3.271  0.00107 ** 
DiscountPct                 -0.3452542  0.2723834  -1.268  0.20497    
PurchasePrice               -0.0036330  0.0030623  -1.186  0.23549    
SeasonSpring                -0.2631769  0.0236683 -11.119  &lt; 2e-16 ***
SeasonSummer                -0.1764066  0.0215047  -8.203 2.34e-16 ***
SeasonWinter                -0.1910545  0.0235449  -8.114 4.88e-16 ***
CustomerAge                  0.0068431  0.0005897  11.604  &lt; 2e-16 ***
MSRP                         0.0016353  0.0026851   0.609  0.54251    
PriceRange$13-$30           -0.4153545  0.0984400  -4.219 2.45e-05 ***
PriceRange$31-$60           -0.2517772  0.0628835  -4.004 6.23e-05 ***
PriceRange$61-$100          -0.2086855  0.0375943  -5.551 2.84e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 84248  on 64911  degrees of freedom
Residual deviance: 82399  on 64842  degrees of freedom
AIC: 82539

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>odds_ratio <span class="ot">&lt;-</span> <span class="fu">exp</span>(logModel<span class="sc">$</span>coefficients)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">name =</span> <span class="fu">names</span>(odds_ratio), <span class="at">odds_ratio =</span> odds_ratio) <span class="sc">%&gt;%</span>  </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(odds_ratio)) <span class="sc">%&gt;%</span> </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                           name odds_ratio
ProductDepartmentWomens ProductDepartmentWomens   4.460017
ProductDepartmentMens     ProductDepartmentMens   4.198772
ProductDepartmentYouth   ProductDepartmentYouth   2.572494
CustomerStateDelaware     CustomerStateDelaware   1.120124
CustomerAge                         CustomerAge   1.006867
MSRP                                       MSRP   1.001637</code></pre>
</div>
</div>
</section>
<section id="make-prediction-on-the-test-data" class="level2">
<h2 class="anchored" data-anchor-id="make-prediction-on-the-test-data">Make prediction on the test data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>testPredictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(logModel, <span class="at">newdata =</span> test, <span class="at">type =</span> <span class="st">"response"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="writing-the-submission-file" class="level2">
<h2 class="anchored" data-anchor-id="writing-the-submission-file">Writing the Submission File</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>submission <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ID =</span> IDCols, <span class="at">Prediction =</span> testPredictions)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(submission, <span class="st">"submission.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="leftout-features-that-were-considered" class="level2">
<h2 class="anchored" data-anchor-id="leftout-features-that-were-considered">Leftout Features that were considered</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#odds_ratio &lt;- exp(coef(fit$finalModel))</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co">#data.frame(name = names(odds_ratio), odds_ratio = odds_ratio) %&gt;%  </span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  arrange(desc(odds_ratio)) %&gt;% </span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  head()</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Sampling</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co">#train_index &lt;- createDataPartition(returns_train$Returned, times = 1, p = 0.7, list = FALSE)</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co">#train &lt;- returns_train[train_index, ]</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co">#test &lt;- returns_train[-train_index, ]</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Returned = factor(Returned, levels = c(0, 1), labels = c("No","Yes"))</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="co">#AgeGroup = factor(case_when(CustomerAge &gt;= 18 &amp; CustomerAge &lt;= 30 ~ "18-30",</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                              CustomerAge &gt; 30 &amp; CustomerAge &lt;= 45 ~ "31-45",</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                              CustomerAge &gt; 45 &amp; CustomerAge &lt;= 60 ~ "46-60",</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="co">#                              CustomerAge &gt; 60 ~ "&gt;61"),</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="co">#                           levels = c("18-30", "31-45", "46-60", "&gt;61"))</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="co">#select(-OrderDate, </span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="co">#         -CustomerBirthDate, </span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a><span class="co">#         -ID, </span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a><span class="co">#         -OrderID, </span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="co">#         -CustomerID,</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a><span class="co">#         -PurchasePrice,</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a><span class="co">#         -DiscountPct,</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a><span class="co">#         -MSRP,</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a><span class="co">#         -ProductCost,</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a><span class="co">#         -CustomerState)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>