<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.55">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Brian Cervantes Alvarez">
<meta name="dcterms.date" content="2023-12-14">
<meta name="description" content="Exploring wine attributes through EDA, MANOVA, and classification models reveals significant chemical differences and predictors of wine type and quality.">

<title>Applied Multivariate Analysis – Home</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../assets/images/preview.png" rel="icon" type="image/png">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="Applied Multivariate Analysis – Home">
<meta property="og:description" content="Exploring wine attributes through EDA, MANOVA, and classification models reveals significant chemical differences and predictors of wine type and quality.">
<meta property="og:image" content="https://datascienceyapper.com/assets/images/redwhite.jpeg">
<meta property="og:site_name" content="Home">
<meta name="twitter:title" content="Applied Multivariate Analysis – Home">
<meta name="twitter:description" content="Exploring wine attributes through EDA, MANOVA, and classification models reveals significant chemical differences and predictors of wine type and quality.">
<meta name="twitter:image" content="https://datascienceyapper.com/assets/images/redwhite.jpeg">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Home</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../content/about/index.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../content/projects/index.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../content/blog/index.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../content/talks/index.html"> 
<span class="menu-text">Talks</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../content/resources/index.html"> 
<span class="menu-text">Resources</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#distinguish-white-wines-from-red-wines" id="toc-distinguish-white-wines-from-red-wines" class="nav-link active" data-scroll-target="#distinguish-white-wines-from-red-wines">Distinguish White Wines From Red Wines</a>
  <ul class="collapse">
  <li><a href="#perform-eda-on-red-white-wine-means" id="toc-perform-eda-on-red-white-wine-means" class="nav-link" data-scroll-target="#perform-eda-on-red-white-wine-means">Perform EDA on Red &amp; White Wine Means:</a></li>
  <li><a href="#perform-manova-to-determine-if-there-are-a-significant-difference-in-mean-vectors-between-red-and-white-wines-with-a-95-confidence-level." id="toc-perform-manova-to-determine-if-there-are-a-significant-difference-in-mean-vectors-between-red-and-white-wines-with-a-95-confidence-level." class="nav-link" data-scroll-target="#perform-manova-to-determine-if-there-are-a-significant-difference-in-mean-vectors-between-red-and-white-wines-with-a-95-confidence-level.">Perform MANOVA to determine if there are a significant difference in mean vectors between red and white wines with a 95% confidence level.</a>
  <ul class="collapse">
  <li><a href="#manova-results" id="toc-manova-results" class="nav-link" data-scroll-target="#manova-results">MANOVA Results</a></li>
  </ul></li>
  <li><a href="#perform-classification-modeling-on-red-white-wines" id="toc-perform-classification-modeling-on-red-white-wines" class="nav-link" data-scroll-target="#perform-classification-modeling-on-red-white-wines">Perform Classification Modeling on Red &amp; White Wines</a>
  <ul class="collapse">
  <li><a href="#train-test-split-cross-validation-set-up" id="toc-train-test-split-cross-validation-set-up" class="nav-link" data-scroll-target="#train-test-split-cross-validation-set-up">Train-Test Split &amp; Cross-Validation Set up</a></li>
  <li><a href="#random-forest-svm-and-logistic-models" id="toc-random-forest-svm-and-logistic-models" class="nav-link" data-scroll-target="#random-forest-svm-and-logistic-models">Random Forest, SVM and Logistic Models</a></li>
  <li><a href="#metrics-variable-importance" id="toc-metrics-variable-importance" class="nav-link" data-scroll-target="#metrics-variable-importance">Metrics &amp; Variable Importance</a></li>
  <li><a href="#classifying-a-new-red-wine-drawn-from-the-same-population" id="toc-classifying-a-new-red-wine-drawn-from-the-same-population" class="nav-link" data-scroll-target="#classifying-a-new-red-wine-drawn-from-the-same-population">Classifying a New Red Wine Drawn From The Same Population</a></li>
  </ul></li>
  <li><a href="#k-means-clustering" id="toc-k-means-clustering" class="nav-link" data-scroll-target="#k-means-clustering">K-Means Clustering</a></li>
  </ul></li>
  <li><a href="#which-variables-are-the-most-important-to-wine-quality-in-red-wines" id="toc-which-variables-are-the-most-important-to-wine-quality-in-red-wines" class="nav-link" data-scroll-target="#which-variables-are-the-most-important-to-wine-quality-in-red-wines">Which Variables Are The Most Important To Wine Quality In Red Wines?</a>
  <ul class="collapse">
  <li><a href="#perform-manovas-to-determine-if-there-are-a-significant-difference-in-mean-vectors-between-wines-with-different-qualityquality-groups-with-a-95-confidence-level." id="toc-perform-manovas-to-determine-if-there-are-a-significant-difference-in-mean-vectors-between-wines-with-different-qualityquality-groups-with-a-95-confidence-level." class="nav-link" data-scroll-target="#perform-manovas-to-determine-if-there-are-a-significant-difference-in-mean-vectors-between-wines-with-different-qualityquality-groups-with-a-95-confidence-level.">Perform MANOVAs To Determine If There Are A Significant Difference In Mean Vectors Between Wines With Different Quality/Quality Groups With A 95% Confidence Level.</a>
  <ul class="collapse">
  <li><a href="#manova-for-quality-levels-3-4-5-6-7-8" id="toc-manova-for-quality-levels-3-4-5-6-7-8" class="nav-link" data-scroll-target="#manova-for-quality-levels-3-4-5-6-7-8">MANOVA for Quality Levels 3, 4, 5, 6, 7, 8</a></li>
  <li><a href="#manova-for-quality-groups-low-medium-high" id="toc-manova-for-quality-groups-low-medium-high" class="nav-link" data-scroll-target="#manova-for-quality-groups-low-medium-high">MANOVA for Quality Groups [Low, Medium, High]</a></li>
  <li><a href="#overall-manova-test-conclusion" id="toc-overall-manova-test-conclusion" class="nav-link" data-scroll-target="#overall-manova-test-conclusion">Overall MANOVA Test Conclusion</a></li>
  </ul></li>
  <li><a href="#perform-classification-on-quality-for-red-wines" id="toc-perform-classification-on-quality-for-red-wines" class="nav-link" data-scroll-target="#perform-classification-on-quality-for-red-wines">Perform Classification on Quality for Red Wines</a>
  <ul class="collapse">
  <li><a href="#random-forest-and-svm-models" id="toc-random-forest-and-svm-models" class="nav-link" data-scroll-target="#random-forest-and-svm-models">Random Forest and SVM models</a></li>
  <li><a href="#metrics-variable-importance-1" id="toc-metrics-variable-importance-1" class="nav-link" data-scroll-target="#metrics-variable-importance-1">Metrics &amp; Variable Importance</a></li>
  </ul></li>
  <li><a href="#perform-principal-component-analysis" id="toc-perform-principal-component-analysis" class="nav-link" data-scroll-target="#perform-principal-component-analysis">Perform Principal Component Analysis</a>
  <ul class="collapse">
  <li><a href="#explaining-pc1-pc2" id="toc-explaining-pc1-pc2" class="nav-link" data-scroll-target="#explaining-pc1-pc2">Explaining PC1 &amp; PC2</a></li>
  <li><a href="#random-forest-model-with-2-pca" id="toc-random-forest-model-with-2-pca" class="nav-link" data-scroll-target="#random-forest-model-with-2-pca">Random Forest Model with 2 PCA</a></li>
  <li><a href="#random-forest-model-with-11-pcas" id="toc-random-forest-model-with-11-pcas" class="nav-link" data-scroll-target="#random-forest-model-with-11-pcas">Random Forest Model with 11 PCAs</a></li>
  <li><a href="#comparison-between-random-forest-models-normal-2pcs-11pcs" id="toc-comparison-between-random-forest-models-normal-2pcs-11pcs" class="nav-link" data-scroll-target="#comparison-between-random-forest-models-normal-2pcs-11pcs">Comparison between Random Forest Models (normal, 2PCs, 11PCs)</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#appendix" id="toc-appendix" class="nav-link" data-scroll-target="#appendix">Appendix</a></li>
  <li><a href="#goal-1-distinguish-white-wines-from-red-wines" id="toc-goal-1-distinguish-white-wines-from-red-wines" class="nav-link" data-scroll-target="#goal-1-distinguish-white-wines-from-red-wines">Goal 1: Distinguish White Wines From Red Wines</a>
  <ul class="collapse">
  <li><a href="#perform-eda-on-red-white-wine-means-1" id="toc-perform-eda-on-red-white-wine-means-1" class="nav-link" data-scroll-target="#perform-eda-on-red-white-wine-means-1">Perform EDA on Red &amp; White Wine Means:</a></li>
  <li><a href="#perform-manova-to-determine-if-there-are-a-significant-difference-in-mean-vectors-between-red-and-white-wines-with-a-95-confidence-level.-1" id="toc-perform-manova-to-determine-if-there-are-a-significant-difference-in-mean-vectors-between-red-and-white-wines-with-a-95-confidence-level.-1" class="nav-link" data-scroll-target="#perform-manova-to-determine-if-there-are-a-significant-difference-in-mean-vectors-between-red-and-white-wines-with-a-95-confidence-level.-1">Perform MANOVA to determine if there are a significant difference in mean vectors between red and white wines with a 95% confidence level.</a>
  <ul class="collapse">
  <li><a href="#manova-results-1" id="toc-manova-results-1" class="nav-link" data-scroll-target="#manova-results-1">MANOVA Results</a></li>
  </ul></li>
  <li><a href="#perform-classification-modeling-on-red-white-wines-1" id="toc-perform-classification-modeling-on-red-white-wines-1" class="nav-link" data-scroll-target="#perform-classification-modeling-on-red-white-wines-1">Perform Classification Modeling on Red &amp; White Wines</a>
  <ul class="collapse">
  <li><a href="#train-test-split-cross-validation-set-up-1" id="toc-train-test-split-cross-validation-set-up-1" class="nav-link" data-scroll-target="#train-test-split-cross-validation-set-up-1">Train-Test Split &amp; Cross-Validation Set up</a></li>
  <li><a href="#random-forest-svm-and-logistic-models-1" id="toc-random-forest-svm-and-logistic-models-1" class="nav-link" data-scroll-target="#random-forest-svm-and-logistic-models-1">Random Forest, SVM and Logistic Models</a></li>
  <li><a href="#metrics-variable-importance-2" id="toc-metrics-variable-importance-2" class="nav-link" data-scroll-target="#metrics-variable-importance-2">Metrics &amp; Variable Importance</a></li>
  <li><a href="#classifying-a-new-red-wine-drawn-from-the-same-population-1" id="toc-classifying-a-new-red-wine-drawn-from-the-same-population-1" class="nav-link" data-scroll-target="#classifying-a-new-red-wine-drawn-from-the-same-population-1">Classifying a New Red Wine Drawn From The Same Population</a></li>
  </ul></li>
  <li><a href="#clustering" id="toc-clustering" class="nav-link" data-scroll-target="#clustering">Clustering:</a></li>
  </ul></li>
  <li><a href="#goal-2-which-variables-are-the-most-important-to-wine-quality-in-red-wines." id="toc-goal-2-which-variables-are-the-most-important-to-wine-quality-in-red-wines." class="nav-link" data-scroll-target="#goal-2-which-variables-are-the-most-important-to-wine-quality-in-red-wines.">Goal 2: Which Variables Are The Most Important To Wine Quality In Red Wines.</a>
  <ul class="collapse">
  <li><a href="#perform-manovas-to-determine-if-there-are-a-significant-difference-in-mean-vectors-between-wines-with-different-qualityquality-groups-with-a-95-confidence-level" id="toc-perform-manovas-to-determine-if-there-are-a-significant-difference-in-mean-vectors-between-wines-with-different-qualityquality-groups-with-a-95-confidence-level" class="nav-link" data-scroll-target="#perform-manovas-to-determine-if-there-are-a-significant-difference-in-mean-vectors-between-wines-with-different-qualityquality-groups-with-a-95-confidence-level">Perform MANOVAs to determine if there are a significant difference in mean vectors between wines with different quality/quality groups with a 95% confidence level?</a>
  <ul class="collapse">
  <li><a href="#manova-for-quality-levels-3-4-5-6-7-8-1" id="toc-manova-for-quality-levels-3-4-5-6-7-8-1" class="nav-link" data-scroll-target="#manova-for-quality-levels-3-4-5-6-7-8-1">MANOVA for Quality Levels 3, 4, 5, 6, 7, 8</a></li>
  <li><a href="#manova-for-quality-groups-low-medium-high-1" id="toc-manova-for-quality-groups-low-medium-high-1" class="nav-link" data-scroll-target="#manova-for-quality-groups-low-medium-high-1">MANOVA for Quality Groups [Low, Medium, High]</a></li>
  <li><a href="#overall-manova-test-conclusion-1" id="toc-overall-manova-test-conclusion-1" class="nav-link" data-scroll-target="#overall-manova-test-conclusion-1">Overall MANOVA Test Conclusion</a></li>
  </ul></li>
  <li><a href="#perform-classification-on-quality-for-red-wines-1" id="toc-perform-classification-on-quality-for-red-wines-1" class="nav-link" data-scroll-target="#perform-classification-on-quality-for-red-wines-1">Perform Classification on Quality for Red Wines</a>
  <ul class="collapse">
  <li><a href="#random-forest-and-svm-models-1" id="toc-random-forest-and-svm-models-1" class="nav-link" data-scroll-target="#random-forest-and-svm-models-1">Random Forest and SVM models</a></li>
  <li><a href="#metrics-variable-importance-3" id="toc-metrics-variable-importance-3" class="nav-link" data-scroll-target="#metrics-variable-importance-3">Metrics &amp; Variable Importance</a></li>
  </ul></li>
  <li><a href="#perform-principal-component-analysis-1" id="toc-perform-principal-component-analysis-1" class="nav-link" data-scroll-target="#perform-principal-component-analysis-1">Perform Principal Component Analysis</a>
  <ul class="collapse">
  <li><a href="#part-1" id="toc-part-1" class="nav-link" data-scroll-target="#part-1">Part 1</a></li>
  <li><a href="#part-2" id="toc-part-2" class="nav-link" data-scroll-target="#part-2">Part 2</a></li>
  </ul></li>
  <li><a href="#repeat-for-grouped-quality-setting-low-medium-high" id="toc-repeat-for-grouped-quality-setting-low-medium-high" class="nav-link" data-scroll-target="#repeat-for-grouped-quality-setting-low-medium-high">Repeat for Grouped Quality Setting (Low, Medium, High)</a>
  <ul class="collapse">
  <li><a href="#setting-up-data-for-classification" id="toc-setting-up-data-for-classification" class="nav-link" data-scroll-target="#setting-up-data-for-classification">Setting up data for classification</a></li>
  <li><a href="#train-test-split-cross-validation-set-up-2" id="toc-train-test-split-cross-validation-set-up-2" class="nav-link" data-scroll-target="#train-test-split-cross-validation-set-up-2">Train-Test-Split &amp; Cross-Validation Set up</a></li>
  <li><a href="#random-forest-and-svm-models-2" id="toc-random-forest-and-svm-models-2" class="nav-link" data-scroll-target="#random-forest-and-svm-models-2">Random Forest and SVM models</a></li>
  <li><a href="#metrics" id="toc-metrics" class="nav-link" data-scroll-target="#metrics">Metrics</a></li>
  <li><a href="#look-at-variable-importance" id="toc-look-at-variable-importance" class="nav-link" data-scroll-target="#look-at-variable-importance">Look at variable importance</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Applied Multivariate Analysis</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">Statistics</div>
  </div>
  </div>

<div>
  <div class="description">
    Exploring wine attributes through EDA, MANOVA, and classification models reveals significant chemical differences and predictors of wine type and quality.
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Brian Cervantes Alvarez </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 14, 2023</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">April 8, 2025</p>
    </div>
  </div>
    
  </div>
  


</header>


<style>
.AI-Summary {
  margin: 20px auto;
  padding: 40px;
  background-color: #fff;
  box-shadow: rgba(6, 24, 44, 0.4) 0px 0px 0px 2px, 
              rgba(6, 24, 44, 0.65) 0px 4px 6px -1px, 
              rgba(255, 255, 255, 0.08) 0px 1px 0px inset;
  border-radius: 15px;
  max-width: 100%;
  font-size: 1.2em;
  line-height: 1.5;
  font-family: "Open Sans", sans-serif;
}
.mini-banner {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 16px;
  margin-bottom: 15px;
  background: linear-gradient(90deg, #2d2d2d, #1a1a1a);
  color: #ffffff;
  border-radius: 15px;
  box-shadow: rgba(0, 0, 0, 0.4) 0px 2px 4px, 
              rgba(0, 0, 0, 0.3) 0px 7px 13px -3px, 
              rgba(0, 0, 0, 0.2) 0px -3px 0px inset;
}
.mini-banner .openai-logo {
  width: 35px;
  height: 35px;
  margin-right: 1px;
}
.AI-Summary p {
  margin: 0;
  padding: 10px;
  font-size: 1em;
  line-height: 1.5;
}
</style>

<div class="AI-Summary" markdown="1">
  <div class="mini-banner">
    <span class="left-banner">Yapper Labs | AI Summary</span>
    <span class="right-banner">
      <img src="../../../assets/images/OpenAI-white-monoblossom.svg" alt="Model Logo" class="openai-logo">
      Model: ChatGPT 4.5    </span>
  </div>
  <p>I performed exploratory data analysis and applied multivariate statistical methods, including MANOVA and Principal Component Analysis (PCA), to distinguish red from white wines and identify key variables predicting wine quality. My Random Forest classification model achieved an excellent recall of approximately 98.96% in distinguishing wine types, and an accuracy of 69.2% in predicting wine quality categories. PCA identified influential components like ‘Wine Body’ and ‘Fermentation Characteristics,’ contributing significantly (68.13% accuracy with 11 principal components) to effective classification performance.</p>
</div>

<p><img src="../../../assets/images/redwhite.jpeg" class="img-fluid"></p>
<section id="distinguish-white-wines-from-red-wines" class="level1">
<h1>Distinguish White Wines From Red Wines</h1>
<section id="perform-eda-on-red-white-wine-means" class="level2">
<h2 class="anchored" data-anchor-id="perform-eda-on-red-white-wine-means">Perform EDA on Red &amp; White Wine Means:</h2>
<p>I conducted an exploratory data analysis in comparing means for the 11 chemical attributes in the red and white wines. Notably, ‘totalSulfurDioxide’ showed significant mean differences, followed by ‘freeSulfurDioxide’ and ‘residualSugar.’ These attributes currently stand out showing a clear difference between the means of white and red wines.</p>
</section>
<section id="perform-manova-to-determine-if-there-are-a-significant-difference-in-mean-vectors-between-red-and-white-wines-with-a-95-confidence-level." class="level2">
<h2 class="anchored" data-anchor-id="perform-manova-to-determine-if-there-are-a-significant-difference-in-mean-vectors-between-red-and-white-wines-with-a-95-confidence-level.">Perform MANOVA to determine if there are a significant difference in mean vectors between red and white wines with a 95% confidence level.</h2>
<p><span class="math display">\begin{align*}
&amp;H_0: \bar{\mu}_{\text{red}} = \bar{\mu}_{\text{white}} \\
&amp;H_A: \bar{\mu}_{\text{red}} \neq \bar{\mu}_{\text{white}}
\end{align*}</span></p>
<section id="manova-results" class="level3">
<h3 class="anchored" data-anchor-id="manova-results">MANOVA Results</h3>
<p>The MANOVA reveals a significant disparity in the means for specific chemical traits between red and white wines. Notably, Pillai’s Trace <span class="math inline">(0.86158)</span> indicates a robust effect, accounting for approximately <span class="math inline">86.128\%</span> of the variance. The p-value of <span class="math inline">2.2 \times 10^{-16}</span> signifies significant differences in the mean vectors. Hence, the MANOVA decisively rejects the null hypothesis of no difference in means, and we have exceptionally high confidence in accepting the alternative-that there is a difference in means between each wine.</p>
</section>
</section>
<section id="perform-classification-modeling-on-red-white-wines" class="level2">
<h2 class="anchored" data-anchor-id="perform-classification-modeling-on-red-white-wines">Perform Classification Modeling on Red &amp; White Wines</h2>
<section id="train-test-split-cross-validation-set-up" class="level3">
<h3 class="anchored" data-anchor-id="train-test-split-cross-validation-set-up">Train-Test Split &amp; Cross-Validation Set up</h3>
<p>I performed a train-test split to ensure the models can handle new, unseen data. I allocated <span class="math inline">70\%</span> to the training data to have a larger sample for the testing data <span class="math inline">(30\%)</span>. To enhance reliability, I employed cross-validation, repeatedly splitting the data into different training and testing sets. This approach provides a more comprehensive evaluation of the model’s effectiveness.</p>
</section>
<section id="random-forest-svm-and-logistic-models" class="level3">
<h3 class="anchored" data-anchor-id="random-forest-svm-and-logistic-models">Random Forest, SVM and Logistic Models</h3>
<p>For my models, I’ve selected Random Forest, Support Vector Machine, and Logistic Regression as promising candidates for effective classification. Logistic Regression is particularly beneficial in binary classification scenarios due to its simplicity and interpretability. Meanwhile, Random Forest excels in capturing complex relationships through ensemble learning, and Support Vector Machine demonstrates proficiency in handling both linear and non-linear patterns. As the results will show later, Random Forest performed the best followed by SVM. Note, the models were not tuned to use their best hyperparameters.</p>
</section>
<section id="metrics-variable-importance" class="level3">
<h3 class="anchored" data-anchor-id="metrics-variable-importance">Metrics &amp; Variable Importance</h3>
<p>The confusion matrix for the red and white wine classification using the Random Forest model shows strong performance. The model correctly identified <span class="math inline">474</span> red wines and <span class="math inline">1464</span> white wines, with only <span class="math inline">5</span> red wines and <span class="math inline">5</span> white wines misclassified. This indicates high accuracy in both precision and recall. In comparison to the Support Vector Machine (SVM) and Logistic Regression models, the Random Forest performed better by minimizing misclassifications. The SVM model had slightly more misclassified instances (<span class="math inline">13</span> in total), while the Logistic Regression model had <span class="math inline">17</span> misclassifications. The Random Forest’s performance makes it a better choice for this classifying red and white wines compared to SVM and Logistic Regression.</p>
<p>The variable importance analysis shows that “chlorides,” with a significance of <span class="math inline">100%</span>, is the most crucial feature for distinguishing red and white wines. Additionally, “totalSulfurDioxide” <span class="math inline">(96.92%)</span> and “volatileAcidity” <span class="math inline">(43.47%)</span> also played key roles, contributing to the model’s clear performance in wine classification.</p>
</section>
<section id="classifying-a-new-red-wine-drawn-from-the-same-population" class="level3">
<h3 class="anchored" data-anchor-id="classifying-a-new-red-wine-drawn-from-the-same-population">Classifying a New Red Wine Drawn From The Same Population</h3>
<p>To estimate the probability of correctly classifying a new red wine drawn from the same population, we can use the concept of recall.</p>
<p>In our confusion matrix:</p>
<p><span class="math display"> \text{Recall (for red wine)} = \frac{\text{True Positives (TP)}}{\text{True Positives (TP) + False Negatives (FN)}} </span></p>
<p>To find the probability:</p>
<p><span class="math display"> \text{Recall (for red wine)} = \frac{474}{474 + 5} = \frac{474}{479}  = 0.9896</span></p>
<p>So, the estimated probability of correctly classifying a new red wine, drawn from the same population, is approximately <span class="math inline">\frac{474}{479}</span>, or roughly <span class="math inline">98.96\%</span>. This suggests a very high probability of correctly identifying red wines based on the model’s current performance.</p>
</section>
</section>
<section id="k-means-clustering" class="level2">
<h2 class="anchored" data-anchor-id="k-means-clustering">K-Means Clustering</h2>
<p>I chose k-means clustering with Euclidean distance for its efficiency with standardized numerical data. While k = 2 visually showed a clear distinction between red and white wines, higher k values (for example, 3 or 4) led to overlapping clusters, affecting the meaningful separation observed with k = 2.</p>
</section>
</section>
<section id="which-variables-are-the-most-important-to-wine-quality-in-red-wines" class="level1">
<h1>Which Variables Are The Most Important To Wine Quality In Red Wines?</h1>
<section id="perform-manovas-to-determine-if-there-are-a-significant-difference-in-mean-vectors-between-wines-with-different-qualityquality-groups-with-a-95-confidence-level." class="level2">
<h2 class="anchored" data-anchor-id="perform-manovas-to-determine-if-there-are-a-significant-difference-in-mean-vectors-between-wines-with-different-qualityquality-groups-with-a-95-confidence-level.">Perform MANOVAs To Determine If There Are A Significant Difference In Mean Vectors Between Wines With Different Quality/Quality Groups With A 95% Confidence Level.</h2>
<section id="manova-for-quality-levels-3-4-5-6-7-8" class="level3">
<h3 class="anchored" data-anchor-id="manova-for-quality-levels-3-4-5-6-7-8">MANOVA for Quality Levels 3, 4, 5, 6, 7, 8</h3>
<p><span class="math display">\begin{align*}
&amp;H_0: \mu_2 = \mu_3 = \mu_4 = \mu_5 = \mu_6 = \mu_7 = \mu_8 \\
&amp;H_A: \text{At least one of } \mu_2, \mu_3, \mu_4, \mu_5, \mu_6, \mu_7, \text{ or } \mu_8 \text{ is different}
\end{align*}</span></p>
<p>In the first analysis, we looked at the Original Quality Scores, and the results were highly significant. The p-value was super close to zero, less than <span class="math inline">2.2 x 10^{-16}</span>. This means there are big differences in the average chemical properties for different quality scores. Therefore, the mean vectors for each quality level varied, providing strong support for rejecting the null hypothesis.</p>
</section>
<section id="manova-for-quality-groups-low-medium-high" class="level3">
<h3 class="anchored" data-anchor-id="manova-for-quality-groups-low-medium-high">MANOVA for Quality Groups [Low, Medium, High]</h3>
<p><span class="math display">\begin{align*}
&amp;H_0: \mu_{\text{Low}} = \mu_{\text{Medium}} = \mu_{\text{High}} \\
&amp;H_A: \text{At least one of } \mu_{\text{Low}}, \mu_{\text{Medium}}, \text{ or } \mu_{\text{High}} \text{ is different}
\end{align*}</span></p>
<p>In the second analysis, we focused on Quality Groups (Low, Medium, High), and the results were also highly significant. The p-value was very close to zero, less than <span class="math inline">2.2 x 10^{-16}</span>. This indicates significant differences in the average chemical properties across different quality groups. We have strong evidence that the mean vectors between each quality group differed. Therefore, we have evidence to reject the null and be in favor of the alternative.</p>
</section>
<section id="overall-manova-test-conclusion" class="level3">
<h3 class="anchored" data-anchor-id="overall-manova-test-conclusion">Overall MANOVA Test Conclusion</h3>
<p>To summarize, our MANOVA tests reveal significant differences in average values for both original quality scores and quality groups. For original scores, statistics like Pillai’s trace and Wilks’ lambda had extremely low p-values <span class="math inline">p &lt; 2.2 x 10^{-16}</span>. Quality groups exhibited similar results.</p>
</section>
</section>
<section id="perform-classification-on-quality-for-red-wines" class="level2">
<h2 class="anchored" data-anchor-id="perform-classification-on-quality-for-red-wines">Perform Classification on Quality for Red Wines</h2>
<section id="random-forest-and-svm-models" class="level3">
<h3 class="anchored" data-anchor-id="random-forest-and-svm-models">Random Forest and SVM models</h3>
<p>I performed the same procedure from the previous classification of red and white wines. I’ve selected Random Forest &amp; Support Vector Machine the top models for classification. Logistic Regression is not designed for multiple classes. Interestingly, the Random Forest performed the best again, followed by SVM. It’s important to note that the models were not fine-tuned for hyperparameters at this stage.</p>
</section>
<section id="metrics-variable-importance-1" class="level3">
<h3 class="anchored" data-anchor-id="metrics-variable-importance-1">Metrics &amp; Variable Importance</h3>
<p>Random Forest emerged as the top-performing model once again, with an accuracy of <span class="math inline">69.2\%</span>. For instance, we can observe that quality level 5 has the highest number of correct predictions <span class="math inline">(163)</span>, while quality levels <span class="math inline">4</span> and <span class="math inline">6</span> have some misclassifications. Among the features, alcohol, total sulfur dioxide, and volatile acidity emerged as the top three influential variables, showcasing their significance in predicting wine quality in red wines.</p>
</section>
</section>
<section id="perform-principal-component-analysis" class="level2">
<h2 class="anchored" data-anchor-id="perform-principal-component-analysis">Perform Principal Component Analysis</h2>
<section id="explaining-pc1-pc2" class="level3">
<h3 class="anchored" data-anchor-id="explaining-pc1-pc2">Explaining PC1 &amp; PC2</h3>
<p>PC1 can be interpreted as representing “Wine Body.” Red wines with higher fixed acidity, citric acid, free sulfur dioxide, and total sulfur dioxide contribute positively to this component, indicating a fuller and more robust body. Hence, higher levels of volatile acidity, residual sugar, and alcohol contribute negatively to this component.</p>
<p>PC2 can be labeled as “Fermentation Characteristics.” Additionally, red wines with elevated levels of free sulfur dioxide, total sulfur dioxide, and density contribute positively to this component, highlighting aspects related to the fermentation process. On the other end, higher alcohol content and volatile acidity contribute negatively to PC2.</p>
</section>
<section id="random-forest-model-with-2-pca" class="level3">
<h3 class="anchored" data-anchor-id="random-forest-model-with-2-pca">Random Forest Model with 2 PCA</h3>
<p>In the confusion matrix, it’s evident that the model struggled to accurately predict certain classes, particularly in categories 3, 4, and 7, where the predicted values differ from the actual values. To add, random forest model achieved an accuracy of 58.07% which is quite below the previous models. Despite its limitations, the model demonstrated some success in capturing patterns related to “Wine Body” and “Fermentation Characteristics.” And it’s with just 2 variables with linear combinations.</p>
</section>
<section id="random-forest-model-with-11-pcas" class="level3">
<h3 class="anchored" data-anchor-id="random-forest-model-with-11-pcas">Random Forest Model with 11 PCAs</h3>
<p>The random forest model attained an accuracy of 68.13%. Plus, it excelled in predicting class 5 but faced challenges in classes 3, 4, 6, and 7. Principal Component Analysis (PCA) highlights PC2 as the most influential (100%), followed by PC3 (80.49%), PC5 (32.47%), and others. This suggests a need for further analysis to enhance predictions in specific classes and leverage insights from key Principal Components for optimization.</p>
</section>
<section id="comparison-between-random-forest-models-normal-2pcs-11pcs" class="level3">
<h3 class="anchored" data-anchor-id="comparison-between-random-forest-models-normal-2pcs-11pcs">Comparison between Random Forest Models (normal, 2PCs, 11PCs)</h3>
<p>In comparing the Random Forest models, both the normal model and the 11 PCs model achieve an accuracy of approximately 68%, surpassing the 2 PCs model, which attains an accuracy of 58.07%. It’s noteworthy that the 2 PCs model demonstrates the potency of PCA, albeit with a trade-off in interpretability. Despite the challenges encountered, each model variant provides valuable insights for optimizing the predictive power. The room for improvement is wide open. Factors such as hyperparameter tuning, other models that were not explored, feature engineering, and delving further into factor analysis are instances that could be used to maximize performance.</p>
<div style="page-break-after: always;"></div>
</section>
</section>
</section>
<section id="appendix" class="level1">
<h1>Appendix</h1>
</section>
<section id="goal-1-distinguish-white-wines-from-red-wines" class="level1">
<h1>Goal 1: Distinguish White Wines From Red Wines</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set scipen to a high value to disable scientific notation</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cluster) </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in the wine datasets</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>redWine <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"../../../assets/datasets/winequality-red.csv"</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>whiteWine <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"../../../assets/datasets/winequality-white.csv"</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at the structure of the wine data</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(redWine)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,599
Columns: 12
$ `fixed acidity`        &lt;dbl&gt; 7.4, 7.8, 7.8, 11.2, 7.4, 7.4, 7.9, 7.3, 7.8, 7…
$ `volatile acidity`     &lt;dbl&gt; 0.700, 0.880, 0.760, 0.280, 0.700, 0.660, 0.600…
$ `citric acid`          &lt;dbl&gt; 0.00, 0.00, 0.04, 0.56, 0.00, 0.00, 0.06, 0.00,…
$ `residual sugar`       &lt;dbl&gt; 1.9, 2.6, 2.3, 1.9, 1.9, 1.8, 1.6, 1.2, 2.0, 6.…
$ chlorides              &lt;dbl&gt; 0.076, 0.098, 0.092, 0.075, 0.076, 0.075, 0.069…
$ `free sulfur dioxide`  &lt;dbl&gt; 11, 25, 15, 17, 11, 13, 15, 15, 9, 17, 15, 17, …
$ `total sulfur dioxide` &lt;dbl&gt; 34, 67, 54, 60, 34, 40, 59, 21, 18, 102, 65, 10…
$ density                &lt;dbl&gt; 0.9978, 0.9968, 0.9970, 0.9980, 0.9978, 0.9978,…
$ pH                     &lt;dbl&gt; 3.51, 3.20, 3.26, 3.16, 3.51, 3.51, 3.30, 3.39,…
$ sulphates              &lt;dbl&gt; 0.56, 0.68, 0.65, 0.58, 0.56, 0.56, 0.46, 0.47,…
$ alcohol                &lt;dbl&gt; 9.4, 9.8, 9.8, 9.8, 9.4, 9.4, 9.4, 10.0, 9.5, 1…
$ quality                &lt;dbl&gt; 5, 5, 5, 6, 5, 5, 5, 7, 7, 5, 5, 5, 5, 5, 5, 5,…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(whiteWine)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 4,898
Columns: 12
$ `fixed acidity`        &lt;dbl&gt; 7.0, 6.3, 8.1, 7.2, 7.2, 8.1, 6.2, 7.0, 6.3, 8.…
$ `volatile acidity`     &lt;dbl&gt; 0.27, 0.30, 0.28, 0.23, 0.23, 0.28, 0.32, 0.27,…
$ `citric acid`          &lt;dbl&gt; 0.36, 0.34, 0.40, 0.32, 0.32, 0.40, 0.16, 0.36,…
$ `residual sugar`       &lt;dbl&gt; 20.70, 1.60, 6.90, 8.50, 8.50, 6.90, 7.00, 20.7…
$ chlorides              &lt;dbl&gt; 0.045, 0.049, 0.050, 0.058, 0.058, 0.050, 0.045…
$ `free sulfur dioxide`  &lt;dbl&gt; 45, 14, 30, 47, 47, 30, 30, 45, 14, 28, 11, 17,…
$ `total sulfur dioxide` &lt;dbl&gt; 170, 132, 97, 186, 186, 97, 136, 170, 132, 129,…
$ density                &lt;dbl&gt; 1.0010, 0.9940, 0.9951, 0.9956, 0.9956, 0.9951,…
$ pH                     &lt;dbl&gt; 3.00, 3.30, 3.26, 3.19, 3.19, 3.26, 3.18, 3.00,…
$ sulphates              &lt;dbl&gt; 0.45, 0.49, 0.44, 0.40, 0.40, 0.44, 0.47, 0.45,…
$ alcohol                &lt;dbl&gt; 8.8, 9.5, 10.1, 9.9, 9.9, 10.1, 9.6, 8.8, 9.5, …
$ quality                &lt;dbl&gt; 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 5, 5, 5, 7, 5, 7,…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run a quick summary for both datasets</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(redWine)</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(whiteWine)</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a 'wine_type' column to identify the wine type</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>redWine<span class="sc">$</span>wineType <span class="ot">&lt;-</span> <span class="st">"red"</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>whiteWine<span class="sc">$</span>wineType <span class="ot">&lt;-</span> <span class="st">"white"</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the datasets</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>wine <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(redWine, whiteWine)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename columns for better readability and consistency</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>wine <span class="ot">&lt;-</span> wine <span class="sc">%&gt;%</span> </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">fixedAcidity =</span> <span class="st">`</span><span class="at">fixed acidity</span><span class="st">`</span>,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">volatileAcidity =</span> <span class="st">`</span><span class="at">volatile acidity</span><span class="st">`</span>,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">citricAcid =</span> <span class="st">`</span><span class="at">citric acid</span><span class="st">`</span>,</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">residualSugar =</span> <span class="st">`</span><span class="at">residual sugar</span><span class="st">`</span>,</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">freeSulfurDioxide =</span> <span class="st">`</span><span class="at">free sulfur dioxide</span><span class="st">`</span>,</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">totalSulfurDioxide =</span> <span class="st">`</span><span class="at">total sulfur dioxide</span><span class="st">`</span>,</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">wineType =</span> <span class="fu">factor</span>(wineType, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"white"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">`</span><span class="at">fixed acidity</span><span class="st">`</span>,</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">volatile acidity</span><span class="st">`</span>,</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">citric acid</span><span class="st">`</span>,</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">residual sugar</span><span class="st">`</span>,</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">free sulfur dioxide</span><span class="st">`</span>,</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">total sulfur dioxide</span><span class="st">`</span>))</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for quality counts</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>wine <span class="sc">%&gt;%</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(quality) <span class="sc">%&gt;%</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">totalCount =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 2
  quality totalCount
    &lt;dbl&gt;      &lt;int&gt;
1       3         30
2       4        216
3       5       2138
4       6       2836
5       7       1079
6       8        193
7       9          5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>wineDs <span class="ot">&lt;-</span> wine <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>quality)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(wineDs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "chlorides"          "density"            "pH"                
 [4] "sulphates"          "alcohol"            "wineType"          
 [7] "fixedAcidity"       "volatileAcidity"    "citricAcid"        
[10] "residualSugar"      "freeSulfurDioxide"  "totalSulfurDioxide"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(wineDs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 6,497
Columns: 12
$ chlorides          &lt;dbl&gt; 0.076, 0.098, 0.092, 0.075, 0.076, 0.075, 0.069, 0.…
$ density            &lt;dbl&gt; 0.9978, 0.9968, 0.9970, 0.9980, 0.9978, 0.9978, 0.9…
$ pH                 &lt;dbl&gt; 3.51, 3.20, 3.26, 3.16, 3.51, 3.51, 3.30, 3.39, 3.3…
$ sulphates          &lt;dbl&gt; 0.56, 0.68, 0.65, 0.58, 0.56, 0.56, 0.46, 0.47, 0.5…
$ alcohol            &lt;dbl&gt; 9.4, 9.8, 9.8, 9.8, 9.4, 9.4, 9.4, 10.0, 9.5, 10.5,…
$ wineType           &lt;fct&gt; red, red, red, red, red, red, red, red, red, red, r…
$ fixedAcidity       &lt;dbl&gt; 7.4, 7.8, 7.8, 11.2, 7.4, 7.4, 7.9, 7.3, 7.8, 7.5, …
$ volatileAcidity    &lt;dbl&gt; 0.700, 0.880, 0.760, 0.280, 0.700, 0.660, 0.600, 0.…
$ citricAcid         &lt;dbl&gt; 0.00, 0.00, 0.04, 0.56, 0.00, 0.00, 0.06, 0.00, 0.0…
$ residualSugar      &lt;dbl&gt; 1.9, 2.6, 2.3, 1.9, 1.9, 1.8, 1.6, 1.2, 2.0, 6.1, 1…
$ freeSulfurDioxide  &lt;dbl&gt; 11, 25, 15, 17, 11, 13, 15, 15, 9, 17, 15, 17, 16, …
$ totalSulfurDioxide &lt;dbl&gt; 34, 67, 54, 60, 34, 40, 59, 21, 18, 102, 65, 102, 5…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(wineDs))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<section id="perform-eda-on-red-white-wine-means-1" class="level2">
<h2 class="anchored" data-anchor-id="perform-eda-on-red-white-wine-means-1">Perform EDA on Red &amp; White Wine Means:</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the mean vectors for red and white wines </span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># separately for each of the 11 chemical attributes</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>meanVectors <span class="ot">&lt;-</span> wineDs <span class="sc">%&gt;%</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(wineType) <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize_all</span>(mean)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the mean vectors</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(meanVectors, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 12
  wineType chlorides density    pH sulphates alcohol fixedAcidity
  &lt;fct&gt;        &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;        &lt;dbl&gt;
1 red         0.0875   0.997  3.31     0.658    10.4         8.32
2 white       0.0458   0.994  3.19     0.490    10.5         6.85
# ℹ 5 more variables: volatileAcidity &lt;dbl&gt;, citricAcid &lt;dbl&gt;,
#   residualSugar &lt;dbl&gt;, freeSulfurDioxide &lt;dbl&gt;, totalSulfurDioxide &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to long format for plotting</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>meanDs <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">gather</span>(meanVectors,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">key =</span> <span class="st">"attribute"</span>, </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">value =</span> <span class="st">"means"</span>, <span class="sc">-</span>wineType)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co">#meanDs</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(meanDs, <span class="fu">aes</span>(<span class="at">x =</span> means, <span class="at">y =</span> attribute, <span class="at">fill =</span> wineType)) <span class="sc">+</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Mean Values for Red|White Wines"</span>,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Mean Value"</span>,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Chemical Attributes"</span>) <span class="sc">+</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(meanDs, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(means), <span class="at">y =</span> attribute, <span class="at">fill =</span> wineType)) <span class="sc">+</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Log-Transformed Mean Values for Red|White Wines"</span>,</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Mean Value"</span>,</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Chemical Attributes"</span>) <span class="sc">+</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>meanDifDs <span class="ot">&lt;-</span> meanDs <span class="sc">%&gt;%</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(wineType, means) <span class="sc">%&gt;%</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">meanDifference =</span> red <span class="sc">-</span> white)</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the mean differences</span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(meanDifDs, <span class="fu">aes</span>(<span class="at">x =</span> meanDifference, <span class="at">y =</span> attribute)) <span class="sc">+</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>, </span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Mean Differences between Red &amp; White Wines"</span>,</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Mean Difference"</span>,</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Chemical Attributes"</span>) <span class="sc">+</span></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Show plot 1 for report</span></span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>p3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-2-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="perform-manova-to-determine-if-there-are-a-significant-difference-in-mean-vectors-between-red-and-white-wines-with-a-95-confidence-level.-1" class="level2">
<h2 class="anchored" data-anchor-id="perform-manova-to-determine-if-there-are-a-significant-difference-in-mean-vectors-between-red-and-white-wines-with-a-95-confidence-level.-1">Perform MANOVA to determine if there are a significant difference in mean vectors between red and white wines with a 95% confidence level.</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>wineManova <span class="ot">&lt;-</span> <span class="fu">manova</span>(<span class="fu">cbind</span>(chlorides, density, pH, sulphates, </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>                           alcohol, fixedAcidity, volatileAcidity, </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>                           citricAcid, residualSugar, freeSulfurDioxide,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>                           totalSulfurDioxide) <span class="sc">~</span> wineType, <span class="at">data =</span> wineDs) </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the summary of the MANOVA</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wineManova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df  Pillai approx F num Df den Df                Pr(&gt;F)    
wineType     1 0.86158   3669.6     11   6485 &lt; 0.00000000000000022 ***
Residuals 6495                                                         
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<section id="manova-results-1" class="level3">
<h3 class="anchored" data-anchor-id="manova-results-1">MANOVA Results</h3>
</section>
</section>
<section id="perform-classification-modeling-on-red-white-wines-1" class="level2">
<h2 class="anchored" data-anchor-id="perform-classification-modeling-on-red-white-wines-1">Perform Classification Modeling on Red &amp; White Wines</h2>
<section id="train-test-split-cross-validation-set-up-1" class="level3">
<h3 class="anchored" data-anchor-id="train-test-split-cross-validation-set-up-1">Train-Test Split &amp; Cross-Validation Set up</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>splitIndex <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(wineDs<span class="sc">$</span>wineType, <span class="at">p =</span> <span class="fl">0.7</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>trainData <span class="ot">&lt;-</span> wineDs[splitIndex, ]</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>testData <span class="ot">&lt;-</span> wineDs[<span class="sc">-</span>splitIndex, ]</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Repeated cross-validation</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>ctrl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"repeatedcv"</span>, </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">number =</span> <span class="dv">5</span>, </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">repeats =</span> <span class="dv">3</span>, </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">verboseIter =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="random-forest-svm-and-logistic-models-1" class="level3">
<h3 class="anchored" data-anchor-id="random-forest-svm-and-logistic-models-1">Random Forest, SVM and Logistic Models</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2013</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Train Random Forest</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>rfModel <span class="ot">&lt;-</span> <span class="fu">train</span>(wineType <span class="sc">~</span> ., </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> trainData,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"rf"</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> ctrl,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ntree =</span> <span class="dv">200</span>)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Train Logistic Regression</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>logisticModel <span class="ot">&lt;-</span> <span class="fu">train</span>(wineType <span class="sc">~</span> ., </span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> trainData,</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">method =</span> <span class="st">"glm"</span>,</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>                       <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Train Support Vector Machine</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>svmModel <span class="ot">&lt;-</span> <span class="fu">train</span>(wineType <span class="sc">~</span> ., </span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> trainData,</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"svmRadial"</span>,</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>                  <span class="at">trControl =</span> ctrl)</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test set for each model</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>rfPred <span class="ot">&lt;-</span> <span class="fu">predict</span>(rfModel, <span class="at">newdata =</span> testData)</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>logisticPred <span class="ot">&lt;-</span> <span class="fu">predict</span>(logisticModel, <span class="at">newdata =</span> testData)</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>svmPred <span class="ot">&lt;-</span> <span class="fu">predict</span>(svmModel, <span class="at">newdata =</span> testData)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="metrics-variable-importance-2" class="level3">
<h3 class="anchored" data-anchor-id="metrics-variable-importance-2">Metrics &amp; Variable Importance</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Random Forest model metrics</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>confMatrixRF <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(rfPred, testData<span class="sc">$</span>wineType, </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">dnn =</span> <span class="fu">c</span>(<span class="st">"Prediction"</span>, <span class="st">"Reference"</span>))</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>accuracyRF <span class="ot">&lt;-</span> confMatrixRF<span class="sc">$</span>overall[<span class="st">"Accuracy"</span>]</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Logistic Regression model metrics</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>confMatrixLogistic <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(logisticPred, testData<span class="sc">$</span>wineType, </span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">dnn =</span> <span class="fu">c</span>(<span class="st">"Prediction"</span>, <span class="st">"Reference"</span>))</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>accuracyLogistic <span class="ot">&lt;-</span> confMatrixLogistic<span class="sc">$</span>overall[<span class="st">"Accuracy"</span>]</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co"># SVM model metrics</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>confMatrixSVM <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(svmPred, testData<span class="sc">$</span>wineType, </span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">dnn =</span> <span class="fu">c</span>(<span class="st">"Prediction"</span>, <span class="st">"Reference"</span>))</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>accuracySVM <span class="ot">&lt;-</span> confMatrixSVM<span class="sc">$</span>overall[<span class="st">"Accuracy"</span>]</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Confusion Matrices</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>plotCM <span class="ot">&lt;-</span> <span class="cf">function</span>(confMatrix, modelName) {</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>  plt <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(confMatrix<span class="sc">$</span>table)</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>  plt<span class="sc">$</span>Prediction <span class="ot">&lt;-</span> <span class="fu">factor</span>(plt<span class="sc">$</span>Prediction, </span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>                           <span class="at">levels =</span> <span class="fu">rev</span>(<span class="fu">levels</span>(plt<span class="sc">$</span>Prediction)))</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(plt, <span class="fu">aes</span>(Prediction, Reference, <span class="at">fill =</span> Freq)) <span class="sc">+</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>() <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Freq)) <span class="sc">+</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"#00859B"</span>) <span class="sc">+</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Confusion Matrix -"</span>, modelName),</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Reference"</span>, <span class="at">y =</span> <span class="st">"Prediction"</span>) <span class="sc">+</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">levels</span>(testData<span class="sc">$</span>wineType)) <span class="sc">+</span></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> <span class="fu">levels</span>(testData<span class="sc">$</span>wineType))</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a><span class="co">#confMatrixRF</span></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>confMatrixLogistic</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction  red white
     red    473     6
     white    6  1463
                                             
               Accuracy : 0.9938             
                 95% CI : (0.9893, 0.9968)   
    No Information Rate : 0.7541             
    P-Value [Acc &gt; NIR] : &lt;0.0000000000000002
                                             
                  Kappa : 0.9834             
                                             
 Mcnemar's Test P-Value : 1                  
                                             
            Sensitivity : 0.9875             
            Specificity : 0.9959             
         Pos Pred Value : 0.9875             
         Neg Pred Value : 0.9959             
             Prevalence : 0.2459             
         Detection Rate : 0.2428             
   Detection Prevalence : 0.2459             
      Balanced Accuracy : 0.9917             
                                             
       'Positive' Class : red                
                                             </code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#confMatrixSVM</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Confusion Matrices for each model</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plotCM</span>(confMatrixRF, <span class="st">"Random Forest"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotCM</span>(confMatrixLogistic, <span class="st">"Logistic Regression"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotCM</span>(confMatrixSVM, <span class="st">"Support Vector Machine (SVM)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-6-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the metrics for each model</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Random Forest Model Results"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Random Forest Model Results"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Accuracy:"</span>, <span class="fu">round</span>(accuracyRF, <span class="dv">4</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Accuracy: 0.9938"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Logistic Regression Model Results:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Logistic Regression Model Results:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Accuracy:"</span>, <span class="fu">round</span>(accuracyLogistic, <span class="dv">4</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Accuracy: 0.9938"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Support Vector Machine (SVM) Model Results:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Support Vector Machine (SVM) Model Results:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Accuracy:"</span>, <span class="fu">round</span>(accuracySVM, <span class="dv">4</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Accuracy: 0.9964"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get variable importance from the best model</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">varImp</span>(rfModel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>rf variable importance

                   Overall
chlorides          100.000
totalSulfurDioxide  80.296
volatileAcidity     43.041
freeSulfurDioxide   23.194
density             22.347
residualSugar       18.246
sulphates           17.811
fixedAcidity        12.766
citricAcid           4.859
pH                   3.794
alcohol              0.000</code></pre>
</div>
</div>
</section>
<section id="classifying-a-new-red-wine-drawn-from-the-same-population-1" class="level3">
<h3 class="anchored" data-anchor-id="classifying-a-new-red-wine-drawn-from-the-same-population-1">Classifying a New Red Wine Drawn From The Same Population</h3>
</section>
</section>
<section id="clustering" class="level2">
<h2 class="anchored" data-anchor-id="clustering">Clustering:</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> wineDs <span class="sc">%&gt;%</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>wineType)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> <span class="fu">scale</span>(ds)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(ds, kmeans, <span class="at">method=</span><span class="st">'silhouette'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>km.final <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(ds, <span class="dv">2</span>, <span class="at">nstart =</span> <span class="dv">30</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(km.final, <span class="at">data =</span> ds, </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">geom =</span> <span class="st">"point"</span>,</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">ellipse.type =</span> <span class="st">"convex"</span>, </span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="goal-2-which-variables-are-the-most-important-to-wine-quality-in-red-wines." class="level1">
<h1>Goal 2: Which Variables Are The Most Important To Wine Quality In Red Wines.</h1>
<section id="perform-manovas-to-determine-if-there-are-a-significant-difference-in-mean-vectors-between-wines-with-different-qualityquality-groups-with-a-95-confidence-level" class="level2">
<h2 class="anchored" data-anchor-id="perform-manovas-to-determine-if-there-are-a-significant-difference-in-mean-vectors-between-wines-with-different-qualityquality-groups-with-a-95-confidence-level">Perform MANOVAs to determine if there are a significant difference in mean vectors between wines with different quality/quality groups with a 95% confidence level?</h2>
<section id="manova-for-quality-levels-3-4-5-6-7-8-1" class="level3">
<h3 class="anchored" data-anchor-id="manova-for-quality-levels-3-4-5-6-7-8-1">MANOVA for Quality Levels 3, 4, 5, 6, 7, 8</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>redWineDs <span class="ot">&lt;-</span> wine <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wineType <span class="sc">==</span> <span class="st">"red"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>wineType)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting Columns</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>colVars <span class="ot">&lt;-</span>  <span class="fu">cbind</span>(</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  redWineDs<span class="sc">$</span>chlorides, redWineDs<span class="sc">$</span>density, redWineDs<span class="sc">$</span>pH, redWineDs<span class="sc">$</span>sulphates, </span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  redWineDs<span class="sc">$</span>alcohol, redWineDs<span class="sc">$</span>fixedAcidity, redWineDs<span class="sc">$</span>volatileAcidity, </span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  redWineDs<span class="sc">$</span>citricAcid, redWineDs<span class="sc">$</span>residualSugar, redWineDs<span class="sc">$</span>freeSulfurDioxide,</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  redWineDs<span class="sc">$</span>totalSulfurDioxide</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a><span class="co"># MANOVA Analysis - Quality, levels = 3,4,5,6,7,8</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>manaovaTest <span class="ot">&lt;-</span> <span class="fu">manova</span>(colVars <span class="sc">~</span> quality, <span class="at">data =</span> redWineDs)</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(manaovaTest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df  Pillai approx F num Df den Df                Pr(&gt;F)    
quality      1 0.36055   81.348     11   1587 &lt; 0.00000000000000022 ***
Residuals 1597                                                         
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="manova-for-quality-groups-low-medium-high-1" class="level3">
<h3 class="anchored" data-anchor-id="manova-for-quality-groups-low-medium-high-1">MANOVA for Quality Groups [Low, Medium, High]</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding qualityGroup</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>redWineDs <span class="ot">&lt;-</span> redWineDs <span class="sc">%&gt;%</span> </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">qualityGroup =</span> <span class="fu">case_when</span>(</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>      quality <span class="sc">%in%</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">~</span> <span class="st">"Low"</span>,</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>      quality <span class="sc">%in%</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">6</span> <span class="sc">~</span> <span class="st">"Medium"</span>,</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>      quality <span class="sc">%in%</span> <span class="dv">7</span><span class="sc">:</span><span class="dv">8</span> <span class="sc">~</span> <span class="st">"High"</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">qualityGroup =</span> <span class="fu">factor</span>(qualityGroup, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Low"</span>, </span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>                                                        <span class="st">"Medium"</span>, </span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>                                                        <span class="st">"High"</span>)))</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>colVarsCategorized <span class="ot">&lt;-</span>  <span class="fu">cbind</span>(</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>  redWineDs<span class="sc">$</span>chlorides, redWineDs<span class="sc">$</span>density, redWineDs<span class="sc">$</span>pH, </span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>  redWineDs<span class="sc">$</span>sulphates, redWineDs<span class="sc">$</span>alcohol, redWineDs<span class="sc">$</span>fixedAcidity, </span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>  redWineDs<span class="sc">$</span>volatileAcidity, redWineDs<span class="sc">$</span>citricAcid, </span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>  redWineDs<span class="sc">$</span>residualSugar, redWineDs<span class="sc">$</span>freeSulfurDioxide,</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>  redWineDs<span class="sc">$</span>totalSulfurDioxide</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a><span class="co"># MANOVA Analysis - QualityGroup, Levels = "Low", "Medium", "High"</span></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>manaovaTest <span class="ot">&lt;-</span> <span class="fu">manova</span>(colVars <span class="sc">~</span> qualityGroup, <span class="at">data =</span> redWineDs)</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(manaovaTest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               Df  Pillai approx F num Df den Df                Pr(&gt;F)    
qualityGroup    2 0.30989   26.453     22   3174 &lt; 0.00000000000000022 ***
Residuals    1596                                                         
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="overall-manova-test-conclusion-1" class="level3">
<h3 class="anchored" data-anchor-id="overall-manova-test-conclusion-1">Overall MANOVA Test Conclusion</h3>
</section>
</section>
<section id="perform-classification-on-quality-for-red-wines-1" class="level2">
<h2 class="anchored" data-anchor-id="perform-classification-on-quality-for-red-wines-1">Perform Classification on Quality for Red Wines</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>qualityDs <span class="ot">&lt;-</span> redWineDs <span class="sc">%&gt;%</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">quality =</span> <span class="fu">factor</span>(quality, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"3"</span>,<span class="st">"4"</span>,<span class="st">"5"</span>,<span class="st">"6"</span>,<span class="st">"7"</span>,<span class="st">"8"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>qualityGroup)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the dataset into training and testing sets</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>splitIndex <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(qualityDs<span class="sc">$</span>quality, <span class="at">p =</span> <span class="fl">0.7</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>trainData <span class="ot">&lt;-</span> qualityDs[splitIndex, ]</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>testData <span class="ot">&lt;-</span> qualityDs[<span class="sc">-</span>splitIndex, ]</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a train control object for repeated cross-validation</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>ctrl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"repeatedcv"</span>, </span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">number =</span> <span class="dv">5</span>, </span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">repeats =</span> <span class="dv">3</span>, </span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">verboseIter =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="random-forest-and-svm-models-1" class="level3">
<h3 class="anchored" data-anchor-id="random-forest-and-svm-models-1">Random Forest and SVM models</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2013</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Random Forest model</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>rfModel <span class="ot">&lt;-</span> <span class="fu">train</span>(quality <span class="sc">~</span> ., </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> trainData,</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"rf"</span>,</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> ctrl,</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ntree =</span> <span class="dv">200</span>)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="co"># (SVM) model</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>svmModel <span class="ot">&lt;-</span> <span class="fu">train</span>(quality <span class="sc">~</span> ., </span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> trainData,</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"svmLinear"</span>,</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">trControl =</span> ctrl)</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test set for each model</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>rfPred <span class="ot">&lt;-</span> <span class="fu">predict</span>(rfModel, <span class="at">newdata =</span> testData)</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>svmPred <span class="ot">&lt;-</span> <span class="fu">predict</span>(svmModel, <span class="at">newdata =</span> testData)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="metrics-variable-importance-3" class="level3">
<h3 class="anchored" data-anchor-id="metrics-variable-importance-3">Metrics &amp; Variable Importance</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Random Forest confusion matrix</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>rfConfMatrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(rfPred, testData<span class="sc">$</span>quality, </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">dnn =</span> <span class="fu">c</span>(<span class="st">"Prediction"</span>, <span class="st">"Reference"</span>))</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>rfAccuracy <span class="ot">&lt;-</span> rfConfMatrix<span class="sc">$</span>overall[<span class="st">"Accuracy"</span>]</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="co"># SVM confusion matrix</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>svmConfMatrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(svmPred, testData<span class="sc">$</span>quality, </span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">dnn =</span> <span class="fu">c</span>(<span class="st">"Prediction"</span>, <span class="st">"Reference"</span>))</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>svmAccuracy <span class="ot">&lt;-</span> svmConfMatrix<span class="sc">$</span>overall[<span class="st">"Accuracy"</span>]</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Random Forest Accuracy:"</span>, rfAccuracy))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Random Forest Accuracy: 0.691823899371069"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"SVM Accuracy:"</span>, svmAccuracy))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "SVM Accuracy: 0.59538784067086"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>rfConfMatrix</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   3   4   5   6   7   8
         3   0   0   0   0   0   0
         4   0   0   0   1   0   0
         5   3  10 163  46   5   0
         6   0   4  40 137  24   4
         7   0   1   1   7  30   1
         8   0   0   0   0   0   0

Overall Statistics
                                               
               Accuracy : 0.6918               
                 95% CI : (0.6482, 0.733)      
    No Information Rate : 0.4277               
    P-Value [Acc &gt; NIR] : &lt; 0.00000000000000022
                                               
                  Kappa : 0.4953               
                                               
 Mcnemar's Test P-Value : NA                   

Statistics by Class:

                     Class: 3 Class: 4 Class: 5 Class: 6 Class: 7 Class: 8
Sensitivity          0.000000 0.000000   0.7990   0.7173  0.50847  0.00000
Specificity          1.000000 0.997835   0.7656   0.7483  0.97608  1.00000
Pos Pred Value            NaN 0.000000   0.7181   0.6555  0.75000      NaN
Neg Pred Value       0.993711 0.968487   0.8360   0.7985  0.93364  0.98952
Prevalence           0.006289 0.031447   0.4277   0.4004  0.12369  0.01048
Detection Rate       0.000000 0.000000   0.3417   0.2872  0.06289  0.00000
Detection Prevalence 0.000000 0.002096   0.4759   0.4382  0.08386  0.00000
Balanced Accuracy    0.500000 0.498918   0.7823   0.7328  0.74228  0.50000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>svmConfMatrix</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   3   4   5   6   7   8
         3   0   0   1   0   0   0
         4   0   0   0   0   0   0
         5   2  11 159  66   6   0
         6   1   4  44 125  53   5
         7   0   0   0   0   0   0
         8   0   0   0   0   0   0

Overall Statistics
                                            
               Accuracy : 0.5954            
                 95% CI : (0.5498, 0.6398)  
    No Information Rate : 0.4277            
    P-Value [Acc &gt; NIR] : 0.0000000000001356
                                            
                  Kappa : 0.3101            
                                            
 Mcnemar's Test P-Value : NA                

Statistics by Class:

                     Class: 3 Class: 4 Class: 5 Class: 6 Class: 7 Class: 8
Sensitivity          0.000000  0.00000   0.7794   0.6545   0.0000  0.00000
Specificity          0.997890  1.00000   0.6886   0.6259   1.0000  1.00000
Pos Pred Value       0.000000      NaN   0.6516   0.5388      NaN      NaN
Neg Pred Value       0.993697  0.96855   0.8069   0.7306   0.8763  0.98952
Prevalence           0.006289  0.03145   0.4277   0.4004   0.1237  0.01048
Detection Rate       0.000000  0.00000   0.3333   0.2621   0.0000  0.00000
Detection Prevalence 0.002096  0.00000   0.5115   0.4864   0.0000  0.00000
Balanced Accuracy    0.498945  0.50000   0.7340   0.6402   0.5000  0.50000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Confusion Matrices</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>plotCM <span class="ot">&lt;-</span> <span class="cf">function</span>(confMatrix, modelName) {</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  plt <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(confMatrix<span class="sc">$</span>table)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  plt<span class="sc">$</span>Prediction <span class="ot">&lt;-</span> <span class="fu">factor</span>(plt<span class="sc">$</span>Prediction, </span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">levels =</span> <span class="fu">rev</span>(<span class="fu">levels</span>(plt<span class="sc">$</span>Prediction)))</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(plt, <span class="fu">aes</span>(Prediction, Reference, <span class="at">fill =</span> Freq)) <span class="sc">+</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>() <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Freq)) <span class="sc">+</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"#00859B"</span>) <span class="sc">+</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Confusion Matrix -"</span>, modelName),</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Reference"</span>, <span class="at">y =</span> <span class="st">"Prediction"</span>) <span class="sc">+</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">levels</span>(testData<span class="sc">$</span>quality)) <span class="sc">+</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> <span class="fu">levels</span>(testData<span class="sc">$</span>quality))</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plotCM</span>(rfConfMatrix, <span class="st">"Random Forest"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotCM</span>(svmConfMatrix, <span class="st">"SVM"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">varImp</span>(rfModel))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-13-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="perform-principal-component-analysis-1" class="level2">
<h2 class="anchored" data-anchor-id="perform-principal-component-analysis-1">Perform Principal Component Analysis</h2>
<section id="part-1" class="level3">
<h3 class="anchored" data-anchor-id="part-1">Part 1</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> <span class="fu">select</span>(qualityDs, <span class="sc">-</span>quality)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform PCA</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>pcaResults <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(ds, <span class="at">scale =</span> T, <span class="at">center =</span> T)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Print PCA summary</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pcaResults)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                          PC1    PC2    PC3    PC4     PC5     PC6     PC7
Standard deviation     1.7604 1.3878 1.2452 1.1015 0.97943 0.81216 0.76406
Proportion of Variance 0.2817 0.1751 0.1410 0.1103 0.08721 0.05996 0.05307
Cumulative Proportion  0.2817 0.4568 0.5978 0.7081 0.79528 0.85525 0.90832
                           PC8     PC9    PC10    PC11
Standard deviation     0.65035 0.58706 0.42583 0.24405
Proportion of Variance 0.03845 0.03133 0.01648 0.00541
Cumulative Proportion  0.94677 0.97810 0.99459 1.00000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize PCA results</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_eig</span>(pcaResults, <span class="at">addlabels =</span> <span class="cn">TRUE</span>, <span class="at">kaiser =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(pcaResults, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">col.ind =</span> qualityDs<span class="sc">$</span>quality, <span class="at">palette =</span> <span class="st">"jco"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-14-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_biplot</span>(pcaResults, <span class="at">geom =</span> <span class="st">"arrow"</span>, <span class="at">col.var =</span> <span class="st">"contrib"</span>, <span class="at">palette =</span> <span class="st">"jco"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-14-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>pcaDs <span class="ot">&lt;-</span> <span class="fu">rownames_to_column</span>(<span class="fu">as.data.frame</span>(pcaResults<span class="sc">$</span>rotation))</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>pcaDs <span class="sc">%&gt;%</span> </span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(rowname, PC1, PC2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              rowname         PC1          PC2
1           chlorides  0.21224658  0.148051555
2             density  0.39535301  0.233575490
3                  pH -0.43851962  0.006710793
4           sulphates  0.24292133 -0.037553916
5             alcohol -0.11323207 -0.386180959
6        fixedAcidity  0.48931422 -0.110502738
7     volatileAcidity -0.23858436  0.274930480
8          citricAcid  0.46363166 -0.151791356
9       residualSugar  0.14610715  0.272080238
10  freeSulfurDioxide -0.03615752  0.513566812
11 totalSulfurDioxide  0.02357485  0.569486959</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding back the quality with principal components</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>prc <span class="ot">&lt;-</span> <span class="fu">select</span>(qualityDs, quality) <span class="sc">%&gt;%</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">as.data.frame</span>(pcaResults<span class="sc">$</span>x)) <span class="sc">%&gt;%</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(quality, PC1, PC2) </span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename columns</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>prc <span class="ot">&lt;-</span> prc <span class="sc">%&gt;%</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Quality"</span> <span class="ot">=</span> quality,</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Wine Body"</span> <span class="ot">=</span> PC1,</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Fermentation Characteristics"</span> <span class="ot">=</span> PC2</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>prc2 <span class="ot">&lt;-</span> <span class="fu">select</span>(qualityDs, quality) <span class="sc">%&gt;%</span></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">as.data.frame</span>(pcaResults<span class="sc">$</span>x)) <span class="sc">%&gt;%</span></span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(quality, PC1, PC2, PC3, PC4, PC5, PC6, PC7, PC8, PC9, PC10, PC11) </span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>prc2 <span class="ot">&lt;-</span> prc2 <span class="sc">%&gt;%</span></span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Quality"</span> <span class="ot">=</span> quality)</span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>prc2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,599 × 12
   Quality    PC1    PC2    PC3      PC4     PC5    PC6    PC7    PC8      PC9
   &lt;fct&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;
 1 5       -1.62   0.451 -1.77   0.0437  -0.0670 -0.914  0.161  0.282 -0.00510
 2 5       -0.799  1.86  -0.911  0.548    0.0184  0.929  1.01  -0.762  0.521  
 3 5       -0.748  0.882 -1.17   0.411    0.0435  0.401  0.539 -0.598  0.0868 
 4 6        2.36  -0.270  0.243 -0.928    1.50   -0.131 -0.344  0.455 -0.0915 
 5 5       -1.62   0.451 -1.77   0.0437  -0.0670 -0.914  0.161  0.282 -0.00510
 6 5       -1.58   0.569 -1.54   0.0237   0.110  -0.993  0.110  0.314  0.0343 
 7 5       -1.10   0.608 -1.08  -0.344    1.13    0.175 -0.261 -0.240  0.0273 
 8 7       -2.25  -0.417 -0.987 -0.00120  0.780   0.286 -0.131 -0.119  0.614  
 9 7       -1.09  -0.308 -1.52   0.00331  0.227  -0.512 -0.250 -0.439  0.399  
10 5        0.655  1.66   1.21  -0.824   -1.72   -0.476 -0.230 -0.839 -1.27   
# ℹ 1,589 more rows
# ℹ 2 more variables: PC10 &lt;dbl&gt;, PC11 &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="part-2" class="level3">
<h3 class="anchored" data-anchor-id="part-2">Part 2</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2013</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>splitIndex <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(prc<span class="sc">$</span>Quality, <span class="at">p =</span> <span class="fl">0.7</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>trainData <span class="ot">&lt;-</span> prc[splitIndex, ]</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>testData <span class="ot">&lt;-</span> prc[<span class="sc">-</span>splitIndex, ]</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Repeated cross-validation</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>ctrl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"repeatedcv"</span>, </span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">number =</span> <span class="dv">5</span>, </span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">repeats =</span> <span class="dv">3</span>, </span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">verboseIter =</span> <span class="cn">FALSE</span>)</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Train Random Forest</span></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>rfModel <span class="ot">&lt;-</span> <span class="fu">train</span>(Quality <span class="sc">~</span> ., </span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> trainData,</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"rf"</span>,</span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> ctrl,</span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ntree =</span> <span class="dv">200</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>note: only 1 unique complexity parameters in default grid. Truncating the grid to 1 .</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test set for each model</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>rfPred <span class="ot">&lt;-</span> <span class="fu">predict</span>(rfModel, <span class="at">newdata =</span> testData)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Confusion Matrices</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>plotCM <span class="ot">&lt;-</span> <span class="cf">function</span>(confMatrix, modelName) {</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  plt <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(confMatrix<span class="sc">$</span>table)</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>  plt<span class="sc">$</span>Prediction <span class="ot">&lt;-</span> <span class="fu">factor</span>(plt<span class="sc">$</span>Prediction, </span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>                           <span class="at">levels =</span> <span class="fu">rev</span>(<span class="fu">levels</span>(plt<span class="sc">$</span>Prediction)))</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(plt, <span class="fu">aes</span>(Prediction, Reference, <span class="at">fill =</span> Freq)) <span class="sc">+</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>() <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Freq)) <span class="sc">+</span></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"#00859B"</span>) <span class="sc">+</span></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Confusion Matrix -"</span>, modelName),</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Reference"</span>, <span class="at">y =</span> <span class="st">"Prediction"</span>) <span class="sc">+</span></span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">levels</span>(testData<span class="sc">$</span>Quality)) <span class="sc">+</span></span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> <span class="fu">levels</span>(testData<span class="sc">$</span>Quality))</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Random Forest metrics</span></span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a>rfConfMatrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(rfPred, testData<span class="sc">$</span>Quality, </span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>                                <span class="at">dnn =</span> <span class="fu">c</span>(<span class="st">"Prediction"</span>, <span class="st">"Reference"</span>))</span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a>rfAccuracy <span class="ot">&lt;-</span> rfConfMatrix<span class="sc">$</span>overall[<span class="st">"Accuracy"</span>]</span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Random Forest Accuracy:"</span>, rfAccuracy))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Random Forest Accuracy: 0.580712788259958"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotCM</span>(rfConfMatrix, <span class="st">"Random Forest"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>rfConfMatrix<span class="sc">$</span>table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Reference
Prediction   3   4   5   6   7   8
         3   0   0   0   0   0   0
         4   0   0   3   2   0   0
         5   1   7 135  53  11   1
         6   2   6  56 117  23   4
         7   0   2  10  19  25   0
         8   0   0   0   0   0   0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable Importance</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">varImp</span>(rfModel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>rf variable importance

                               Overall
`Fermentation Characteristics`     100
`Wine Body`                          0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2013</span>)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>splitIndex <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(prc2<span class="sc">$</span>Quality, <span class="at">p =</span> <span class="fl">0.7</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>trainData <span class="ot">&lt;-</span> prc2[splitIndex, ]</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>testData <span class="ot">&lt;-</span> prc2[<span class="sc">-</span>splitIndex, ]</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Repeated cross-validation</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>ctrl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"repeatedcv"</span>, </span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">number =</span> <span class="dv">5</span>, </span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">repeats =</span> <span class="dv">3</span>, </span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">verboseIter =</span> <span class="cn">FALSE</span>)</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Train Random Forest</span></span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>rfModel <span class="ot">&lt;-</span> <span class="fu">train</span>(Quality <span class="sc">~</span> ., </span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> trainData,</span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"rf"</span>,</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> ctrl,</span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ntree =</span> <span class="dv">200</span>)</span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test set for each model</span></span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>rfPred <span class="ot">&lt;-</span> <span class="fu">predict</span>(rfModel, <span class="at">newdata =</span> testData)</span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Confusion Matrices</span></span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true" tabindex="-1"></a>plotCM <span class="ot">&lt;-</span> <span class="cf">function</span>(confMatrix, modelName) {</span>
<span id="cb79-25"><a href="#cb79-25" aria-hidden="true" tabindex="-1"></a>  plt <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(confMatrix<span class="sc">$</span>table)</span>
<span id="cb79-26"><a href="#cb79-26" aria-hidden="true" tabindex="-1"></a>  plt<span class="sc">$</span>Prediction <span class="ot">&lt;-</span> <span class="fu">factor</span>(plt<span class="sc">$</span>Prediction, </span>
<span id="cb79-27"><a href="#cb79-27" aria-hidden="true" tabindex="-1"></a>                           <span class="at">levels =</span> <span class="fu">rev</span>(<span class="fu">levels</span>(plt<span class="sc">$</span>Prediction)))</span>
<span id="cb79-28"><a href="#cb79-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb79-29"><a href="#cb79-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(plt, <span class="fu">aes</span>(Prediction, Reference, <span class="at">fill =</span> Freq)) <span class="sc">+</span></span>
<span id="cb79-30"><a href="#cb79-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>() <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Freq)) <span class="sc">+</span></span>
<span id="cb79-31"><a href="#cb79-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"#00859B"</span>) <span class="sc">+</span></span>
<span id="cb79-32"><a href="#cb79-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Confusion Matrix -"</span>, modelName),</span>
<span id="cb79-33"><a href="#cb79-33" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Reference"</span>, <span class="at">y =</span> <span class="st">"Prediction"</span>) <span class="sc">+</span></span>
<span id="cb79-34"><a href="#cb79-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">levels</span>(testData<span class="sc">$</span>Quality)) <span class="sc">+</span></span>
<span id="cb79-35"><a href="#cb79-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> <span class="fu">levels</span>(testData<span class="sc">$</span>Quality))</span>
<span id="cb79-36"><a href="#cb79-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-37"><a href="#cb79-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-38"><a href="#cb79-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Random Forest metrics</span></span>
<span id="cb79-39"><a href="#cb79-39" aria-hidden="true" tabindex="-1"></a>rfConfMatrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(rfPred, testData<span class="sc">$</span>Quality, </span>
<span id="cb79-40"><a href="#cb79-40" aria-hidden="true" tabindex="-1"></a>                                <span class="at">dnn =</span> <span class="fu">c</span>(<span class="st">"Prediction"</span>, <span class="st">"Reference"</span>))</span>
<span id="cb79-41"><a href="#cb79-41" aria-hidden="true" tabindex="-1"></a>rfAccuracy <span class="ot">&lt;-</span> rfConfMatrix<span class="sc">$</span>overall[<span class="st">"Accuracy"</span>]</span>
<span id="cb79-42"><a href="#cb79-42" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Random Forest Accuracy:"</span>, rfAccuracy))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Random Forest Accuracy: 0.681341719077568"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotCM</span>(rfConfMatrix, <span class="st">"Random Forest"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>rfConfMatrix</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   3   4   5   6   7   8
         3   0   0   0   0   0   0
         4   0   0   1   0   0   0
         5   3   9 161  47   4   0
         6   0   6  39 134  25   3
         7   0   0   3  10  30   2
         8   0   0   0   0   0   0

Overall Statistics
                                               
               Accuracy : 0.6813               
                 95% CI : (0.6374, 0.723)      
    No Information Rate : 0.4277               
    P-Value [Acc &gt; NIR] : &lt; 0.00000000000000022
                                               
                  Kappa : 0.4807               
                                               
 Mcnemar's Test P-Value : NA                   

Statistics by Class:

                     Class: 3 Class: 4 Class: 5 Class: 6 Class: 7 Class: 8
Sensitivity          0.000000 0.000000   0.7892   0.7016  0.50847  0.00000
Specificity          1.000000 0.997835   0.7692   0.7448  0.96411  1.00000
Pos Pred Value            NaN 0.000000   0.7188   0.6473  0.66667      NaN
Neg Pred Value       0.993711 0.968487   0.8300   0.7889  0.93287  0.98952
Prevalence           0.006289 0.031447   0.4277   0.4004  0.12369  0.01048
Detection Rate       0.000000 0.000000   0.3375   0.2809  0.06289  0.00000
Detection Prevalence 0.000000 0.002096   0.4696   0.4340  0.09434  0.00000
Balanced Accuracy    0.500000 0.498918   0.7792   0.7232  0.73629  0.50000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable Importance</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">varImp</span>(rfModel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>rf variable importance

     Overall
PC2  100.000
PC3   80.491
PC5   32.468
PC9   30.188
PC1   16.023
PC4    7.563
PC7    6.410
PC8    5.631
PC11   3.630
PC10   3.489
PC6    0.000</code></pre>
</div>
</div>
</section>
</section>
<section id="repeat-for-grouped-quality-setting-low-medium-high" class="level2">
<h2 class="anchored" data-anchor-id="repeat-for-grouped-quality-setting-low-medium-high">Repeat for Grouped Quality Setting (Low, Medium, High)</h2>
<section id="setting-up-data-for-classification" class="level3">
<h3 class="anchored" data-anchor-id="setting-up-data-for-classification">Setting up data for classification</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>groupedQualityDs <span class="ot">&lt;-</span> redWineDs <span class="sc">%&gt;%</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>quality)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="train-test-split-cross-validation-set-up-2" class="level3">
<h3 class="anchored" data-anchor-id="train-test-split-cross-validation-set-up-2">Train-Test-Split &amp; Cross-Validation Set up</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the dataset into training and testing sets</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>splitIndex <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(groupedQualityDs<span class="sc">$</span>qualityGroup, <span class="at">p =</span> <span class="fl">0.7</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>trainData <span class="ot">&lt;-</span> groupedQualityDs[splitIndex, ]</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>testData <span class="ot">&lt;-</span> groupedQualityDs[<span class="sc">-</span>splitIndex, ]</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a train control object for repeated cross-validation</span></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>ctrl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"repeatedcv"</span>, </span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">number =</span> <span class="dv">5</span>, </span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">repeats =</span> <span class="dv">3</span>, </span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">verboseIter =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="random-forest-and-svm-models-2" class="level3">
<h3 class="anchored" data-anchor-id="random-forest-and-svm-models-2">Random Forest and SVM models</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2013</span>)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Train Random Forest classifier using caret</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>rfModel <span class="ot">&lt;-</span> <span class="fu">train</span>(qualityGroup <span class="sc">~</span> ., </span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> trainData,</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"rf"</span>,</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> ctrl,</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ntree =</span> <span class="dv">200</span>)</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Train Support Vector Machine (SVM) model using caret</span></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>svmModel <span class="ot">&lt;-</span> <span class="fu">train</span>(qualityGroup <span class="sc">~</span> ., </span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> trainData,</span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"svmRadial"</span>,</span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">trControl =</span> ctrl)</span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test set for each model</span></span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a>rfPred <span class="ot">&lt;-</span> <span class="fu">predict</span>(rfModel, <span class="at">newdata =</span> testData)</span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a>svmPred <span class="ot">&lt;-</span> <span class="fu">predict</span>(svmModel, <span class="at">newdata =</span> testData)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="metrics" class="level3">
<h3 class="anchored" data-anchor-id="metrics">Metrics</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Confusion Matrices</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>plotCM <span class="ot">&lt;-</span> <span class="cf">function</span>(confMatrix, modelName) {</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>  plt <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(confMatrix<span class="sc">$</span>table)</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>  plt<span class="sc">$</span>Prediction <span class="ot">&lt;-</span> <span class="fu">factor</span>(plt<span class="sc">$</span>Prediction, </span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">levels =</span> <span class="fu">rev</span>(<span class="fu">levels</span>(plt<span class="sc">$</span>Prediction)))</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(plt, <span class="fu">aes</span>(Prediction, Reference, <span class="at">fill =</span> Freq)) <span class="sc">+</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>() <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Freq)) <span class="sc">+</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"#00859B"</span>) <span class="sc">+</span></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Confusion Matrix -"</span>, modelName),</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Reference"</span>, <span class="at">y =</span> <span class="st">"Prediction"</span>) <span class="sc">+</span></span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">levels</span>(testData<span class="sc">$</span>qualityGroup)) <span class="sc">+</span></span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> <span class="fu">levels</span>(testData<span class="sc">$</span>qualityGroup))</span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Random Forest metrics</span></span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a>rfConfMatrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(rfPred, testData<span class="sc">$</span>qualityGroup, </span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a>                                <span class="at">dnn =</span> <span class="fu">c</span>(<span class="st">"Prediction"</span>, <span class="st">"Reference"</span>))</span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a>svmConfMatrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(svmPred, testData<span class="sc">$</span>qualityGroup, </span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">dnn =</span> <span class="fu">c</span>(<span class="st">"Prediction"</span>, <span class="st">"Reference"</span>))</span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true" tabindex="-1"></a>rfConfMatrix</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction Low Medium High
    Low      0      0    0
    Medium  18    388   39
    High     0      7   26

Overall Statistics
                                          
               Accuracy : 0.8661          
                 95% CI : (0.8323, 0.8953)
    No Information Rate : 0.8264          
    P-Value [Acc &gt; NIR] : 0.01092         
                                          
                  Kappa : 0.395           
                                          
 Mcnemar's Test P-Value : NA              

Statistics by Class:

                     Class: Low Class: Medium Class: High
Sensitivity             0.00000        0.9823     0.40000
Specificity             1.00000        0.3133     0.98305
Pos Pred Value              NaN        0.8719     0.78788
Neg Pred Value          0.96234        0.7879     0.91236
Prevalence              0.03766        0.8264     0.13598
Detection Rate          0.00000        0.8117     0.05439
Detection Prevalence    0.00000        0.9310     0.06904
Balanced Accuracy       0.50000        0.6478     0.69153</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>svmConfMatrix</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction Low Medium High
    Low      0      0    0
    Medium  18    393   50
    High     0      2   15

Overall Statistics
                                         
               Accuracy : 0.8536         
                 95% CI : (0.8186, 0.884)
    No Information Rate : 0.8264         
    P-Value [Acc &gt; NIR] : 0.06328        
                                         
                  Kappa : 0.2611         
                                         
 Mcnemar's Test P-Value : NA             

Statistics by Class:

                     Class: Low Class: Medium Class: High
Sensitivity             0.00000        0.9949     0.23077
Specificity             1.00000        0.1807     0.99516
Pos Pred Value              NaN        0.8525     0.88235
Neg Pred Value          0.96234        0.8824     0.89154
Prevalence              0.03766        0.8264     0.13598
Detection Rate          0.00000        0.8222     0.03138
Detection Prevalence    0.00000        0.9644     0.03556
Balanced Accuracy       0.50000        0.5878     0.61296</code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotCM</span>(rfConfMatrix, <span class="st">"Random Forest"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotCM</span>(svmConfMatrix, <span class="st">"SVM"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-20-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="look-at-variable-importance" class="level3">
<h3 class="anchored" data-anchor-id="look-at-variable-importance">Look at variable importance</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">varImp</span>(rfModel))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


<!-- -->

</section>
</section>
</section>

</main> <!-- /main -->
<!-- Assets/HTML/Cookies/custom-cookie-consent.html -->
<style>
    /* Cookie Consent Banner Styling */
    .cookie-consent-banner {
      position: fixed;
      bottom: 0;
      width: 100%;
      background-color: #f7f7f9; /* Using $gray-200 from your theme */
      color: #1a1a1a; /* Using $primary ($gray-900) for contrast */
      padding: 1rem;
      text-align: center;
      z-index: 1000;
      box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.1);
    }
    
    .cookie-consent-banner button {
      margin-left: 1rem;
      background-color: #0073cf; /* Using $blue */
      color: #fff;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 0.25rem;
      cursor: pointer;
      font-size: 1rem;
      transition: background-color 0.3s ease;
    }
    
    /* Styling for the Deny button */
    .cookie-consent-banner button#deny-cookies {
      margin-left: 0.5rem;
      background-color: #ced4da; /* Using a gray tone similar to $gray-400 */
      color: #1a1a1a;
    }
    
    /* Optional hover effects */
    .cookie-consent-banner button:hover {
      opacity: 0.9;
    }
  </style>
  
  <div id="cookie-consent-banner" class="cookie-consent-banner" style="display: none;">
    <span>This website uses Google Analytics to improve its functionality.</span>
    <button id="accept-cookies">Accept</button>
    <button id="deny-cookies">Deny</button>
  </div>
  
  <script>
    (function() {
      // Function to dynamically load Google Analytics and update consent mode.
      function loadGoogleAnalytics() {
        const gaScript = document.createElement('script');
        gaScript.async = true;
        gaScript.src = "https://www.googletagmanager.com/gtag/js?id=G-HN44V7BZHS";
        document.head.appendChild(gaScript);
        
        gaScript.onload = function() {
          window.dataLayer = window.dataLayer || [];
          function gtag(){ dataLayer.push(arguments); }
          
          // Update consent mode to grant storage upon acceptance.
          gtag('consent', 'update', {
            'analytics_storage': 'granted',
            'ad_storage': 'granted'
          });
          
          gtag('js', new Date());
          gtag('config', 'G-HN44V7BZHS');
        };
      }
    
      // Helper functions to get and set cookies.
      function getCookie(name) {
        const value = "; " + document.cookie;
        const parts = value.split("; " + name + "=");
        if (parts.length === 2) return parts.pop().split(";").shift();
      }
    
      function setCookie(name, value, days) {
        let expires = "";
        if (days) {
          const date = new Date();
          date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
          expires = "; expires=" + date.toUTCString();
        }
        document.cookie = name + "=" + (value || "") + expires + "; path=/";
      }
    
      document.addEventListener("DOMContentLoaded", function() {
        const consent = getCookie("cookie_consent");
        
        // If consent was previously given, load GA immediately; otherwise, show the banner.
        if (consent === "accepted") {
          loadGoogleAnalytics();
        } else {
          document.getElementById("cookie-consent-banner").style.display = "block";
        }
    
        // When the user accepts cookies...
        document.getElementById("accept-cookies").addEventListener("click", function() {
          setCookie("cookie_consent", "accepted", 365);
          document.getElementById("cookie-consent-banner").style.display = "none";
          loadGoogleAnalytics();
        });
    
        // When the user denies cookies...
        document.getElementById("deny-cookies").addEventListener("click", function() {
          setCookie("cookie_consent", "denied", 365);
          document.getElementById("cookie-consent-banner").style.display = "none";
          // Optionally, add logic to disable tracking.
        });
      });
    })();
  </script>
  
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/datascienceyapper\.com");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb96" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Applied Multivariate Analysis"</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Brian Cervantes Alvarez"</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "12-14-2023"</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="an">date-modified:</span><span class="co"> today</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "Exploring wine attributes through EDA, MANOVA, and classification models reveals significant chemical differences and predictors of wine type and quality."</span></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a><span class="an">teaser:</span><span class="co"> "Bringing modern stats to uncover wine attribute patterns and differences."</span></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> ["Statistics"]</span></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a><span class="an">image:</span><span class="co"> /assets/images/redwhite.jpeg</span></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: right</span></span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a><span class="co">    html-math-method: katex</span></span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a><span class="co">    page-layout: article</span></span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span><span class="co"> </span></span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb96-20"><a href="#cb96-20" aria-hidden="true" tabindex="-1"></a><span class="an">ai-summary:</span></span>
<span id="cb96-21"><a href="#cb96-21" aria-hidden="true" tabindex="-1"></a><span class="co">  banner-title: "Yapper Labs | AI Summary"</span></span>
<span id="cb96-22"><a href="#cb96-22" aria-hidden="true" tabindex="-1"></a><span class="co">  model-title: "Model: ChatGPT 4.5"</span></span>
<span id="cb96-23"><a href="#cb96-23" aria-hidden="true" tabindex="-1"></a><span class="co">  model-img: "/assets/images/OpenAI-white-monoblossom.svg"</span></span>
<span id="cb96-24"><a href="#cb96-24" aria-hidden="true" tabindex="-1"></a><span class="co">  summary: "I performed exploratory data analysis and applied multivariate statistical methods, including MANOVA and Principal Component Analysis (PCA), to distinguish red from white wines and identify key variables predicting wine quality. My Random Forest classification model achieved an excellent recall of approximately 98.96% in distinguishing wine types, and an accuracy of 69.2% in predicting wine quality categories. PCA identified influential components like 'Wine Body' and 'Fermentation Characteristics,' contributing significantly (68.13% accuracy with 11 principal components) to effective classification performance."</span></span>
<span id="cb96-25"><a href="#cb96-25" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb96-26"><a href="#cb96-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-27"><a href="#cb96-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-28"><a href="#cb96-28" aria-hidden="true" tabindex="-1"></a><span class="al">![](/assets/images/redwhite.jpeg)</span></span>
<span id="cb96-29"><a href="#cb96-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-30"><a href="#cb96-30" aria-hidden="true" tabindex="-1"></a><span class="fu"># Distinguish White Wines From Red Wines</span></span>
<span id="cb96-31"><a href="#cb96-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-32"><a href="#cb96-32" aria-hidden="true" tabindex="-1"></a><span class="fu">## Perform EDA on Red &amp; White Wine Means:</span></span>
<span id="cb96-33"><a href="#cb96-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-34"><a href="#cb96-34" aria-hidden="true" tabindex="-1"></a>I conducted an exploratory data analysis in comparing means for the 11 chemical attributes in the red and white wines. Notably, 'totalSulfurDioxide' showed significant mean differences, followed by 'freeSulfurDioxide' and 'residualSugar.' These attributes currently stand out showing a clear difference between the means of white and red wines.</span>
<span id="cb96-35"><a href="#cb96-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-36"><a href="#cb96-36" aria-hidden="true" tabindex="-1"></a><span class="fu">## Perform MANOVA to determine if there are a significant difference in mean vectors between red and white wines with a 95% confidence level.</span></span>
<span id="cb96-37"><a href="#cb96-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-38"><a href="#cb96-38" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb96-39"><a href="#cb96-39" aria-hidden="true" tabindex="-1"></a>&amp;H_0: \bar{\mu}_{\text{red}} = \bar{\mu}_{\text{white}} <span class="sc">\\</span></span>
<span id="cb96-40"><a href="#cb96-40" aria-hidden="true" tabindex="-1"></a>&amp;H_A: \bar{\mu}_{\text{red}} \neq \bar{\mu}_{\text{white}}</span>
<span id="cb96-41"><a href="#cb96-41" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb96-42"><a href="#cb96-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-43"><a href="#cb96-43" aria-hidden="true" tabindex="-1"></a><span class="fu">### MANOVA Results</span></span>
<span id="cb96-44"><a href="#cb96-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-45"><a href="#cb96-45" aria-hidden="true" tabindex="-1"></a>The MANOVA reveals a significant disparity in the means for specific chemical traits between red and white wines. Notably, Pillai's Trace $(0.86158)$ indicates a robust effect, accounting for approximately $86.128\%$ of the variance. The p-value of $2.2 \times 10^{-16}$ signifies significant differences in the mean vectors. Hence, the MANOVA decisively rejects the null hypothesis of no difference in means, and we have exceptionally high confidence in accepting the alternative-that there is a difference in means between each wine.</span>
<span id="cb96-46"><a href="#cb96-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-47"><a href="#cb96-47" aria-hidden="true" tabindex="-1"></a><span class="fu">## Perform Classification Modeling on Red &amp; White Wines</span></span>
<span id="cb96-48"><a href="#cb96-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-49"><a href="#cb96-49" aria-hidden="true" tabindex="-1"></a><span class="fu">### Train-Test Split &amp; Cross-Validation Set up</span></span>
<span id="cb96-50"><a href="#cb96-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-51"><a href="#cb96-51" aria-hidden="true" tabindex="-1"></a>I performed a train-test split to ensure the models can handle new, unseen data. I allocated $70\%$ to the training data to have a larger sample for the testing data $(30\%)$. To enhance reliability, I employed cross-validation, repeatedly splitting the data into different training and testing sets. This approach provides a more comprehensive evaluation of the model's effectiveness.</span>
<span id="cb96-52"><a href="#cb96-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-53"><a href="#cb96-53" aria-hidden="true" tabindex="-1"></a><span class="fu">### Random Forest, SVM and Logistic Models</span></span>
<span id="cb96-54"><a href="#cb96-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-55"><a href="#cb96-55" aria-hidden="true" tabindex="-1"></a>For my models, I've selected Random Forest, Support Vector Machine, and Logistic Regression as promising candidates for effective classification. Logistic Regression is particularly beneficial in binary classification scenarios due to its simplicity and interpretability. Meanwhile, Random Forest excels in capturing complex relationships through ensemble learning, and Support Vector Machine demonstrates proficiency in handling both linear and non-linear patterns. As the results will show later, Random Forest performed the best followed by SVM. Note, the models were not tuned to use their best hyperparameters.</span>
<span id="cb96-56"><a href="#cb96-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-57"><a href="#cb96-57" aria-hidden="true" tabindex="-1"></a><span class="fu">### Metrics &amp; Variable Importance</span></span>
<span id="cb96-58"><a href="#cb96-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-59"><a href="#cb96-59" aria-hidden="true" tabindex="-1"></a>The confusion matrix for the red and white wine classification using the Random Forest model shows strong performance. The model correctly identified $474$ red wines and $1464$ white wines, with only $5$ red wines and $5$ white wines misclassified. This indicates high accuracy in both precision and recall. In comparison to the Support Vector Machine (SVM) and Logistic Regression models, the Random Forest performed better by minimizing misclassifications. The SVM model had slightly more misclassified instances ($13$ in total), while the Logistic Regression model had $17$ misclassifications. The Random Forest's performance makes it a better choice for this classifying red and white wines compared to SVM and Logistic Regression.</span>
<span id="cb96-60"><a href="#cb96-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-61"><a href="#cb96-61" aria-hidden="true" tabindex="-1"></a>The variable importance analysis shows that "chlorides," with a significance of $100%$, is the most crucial feature for distinguishing red and white wines. Additionally, "totalSulfurDioxide" $(96.92%)$ and "volatileAcidity" $(43.47%)$ also played key roles, contributing to the model's clear performance in wine classification.</span>
<span id="cb96-62"><a href="#cb96-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-63"><a href="#cb96-63" aria-hidden="true" tabindex="-1"></a><span class="fu">### Classifying a New Red Wine Drawn From The Same Population</span></span>
<span id="cb96-64"><a href="#cb96-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-65"><a href="#cb96-65" aria-hidden="true" tabindex="-1"></a>To estimate the probability of correctly classifying a new red wine drawn from the same population, we can use the concept of recall.</span>
<span id="cb96-66"><a href="#cb96-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-67"><a href="#cb96-67" aria-hidden="true" tabindex="-1"></a>In our confusion matrix:</span>
<span id="cb96-68"><a href="#cb96-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-69"><a href="#cb96-69" aria-hidden="true" tabindex="-1"></a>$$ \text{Recall (for red wine)} = \frac{\text{True Positives (TP)}}{\text{True Positives (TP) + False Negatives (FN)}} $$</span>
<span id="cb96-70"><a href="#cb96-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-71"><a href="#cb96-71" aria-hidden="true" tabindex="-1"></a>To find the probability:</span>
<span id="cb96-72"><a href="#cb96-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-73"><a href="#cb96-73" aria-hidden="true" tabindex="-1"></a>$$ \text{Recall (for red wine)} = \frac{474}{474 + 5} = \frac{474}{479}  = 0.9896$$</span>
<span id="cb96-74"><a href="#cb96-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-75"><a href="#cb96-75" aria-hidden="true" tabindex="-1"></a>So, the estimated probability of correctly classifying a new red wine, drawn from the same population, is approximately $\frac{474}{479}$, or roughly $98.96\%$. This suggests a very high probability of correctly identifying red wines based on the model's current performance.</span>
<span id="cb96-76"><a href="#cb96-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-77"><a href="#cb96-77" aria-hidden="true" tabindex="-1"></a><span class="fu">## K-Means Clustering</span></span>
<span id="cb96-78"><a href="#cb96-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-79"><a href="#cb96-79" aria-hidden="true" tabindex="-1"></a>I chose k-means clustering with Euclidean distance for its efficiency with standardized numerical data. While k = 2 visually showed a clear distinction between red and white wines, higher k values (for example, 3 or 4) led to overlapping clusters, affecting the meaningful separation observed with k = 2.</span>
<span id="cb96-80"><a href="#cb96-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-81"><a href="#cb96-81" aria-hidden="true" tabindex="-1"></a><span class="fu"># Which Variables Are The Most Important To Wine Quality In Red Wines?</span></span>
<span id="cb96-82"><a href="#cb96-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-83"><a href="#cb96-83" aria-hidden="true" tabindex="-1"></a><span class="fu">## Perform MANOVAs To Determine If There Are A Significant Difference In Mean Vectors Between Wines With Different Quality/Quality Groups With A 95% Confidence Level.</span></span>
<span id="cb96-84"><a href="#cb96-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-85"><a href="#cb96-85" aria-hidden="true" tabindex="-1"></a><span class="fu">### MANOVA for Quality Levels 3, 4, 5, 6, 7, 8</span></span>
<span id="cb96-86"><a href="#cb96-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-87"><a href="#cb96-87" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb96-88"><a href="#cb96-88" aria-hidden="true" tabindex="-1"></a>&amp;H_0: \mu_2 = \mu_3 = \mu_4 = \mu_5 = \mu_6 = \mu_7 = \mu_8 <span class="sc">\\</span></span>
<span id="cb96-89"><a href="#cb96-89" aria-hidden="true" tabindex="-1"></a>&amp;H_A: \text{At least one of } \mu_2, \mu_3, \mu_4, \mu_5, \mu_6, \mu_7, \text{ or } \mu_8 \text{ is different}</span>
<span id="cb96-90"><a href="#cb96-90" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb96-91"><a href="#cb96-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-92"><a href="#cb96-92" aria-hidden="true" tabindex="-1"></a>In the first analysis, we looked at the Original Quality Scores, and the results were highly significant. The p-value was super close to zero, less than $2.2 x 10^{-16}$. This means there are big differences in the average chemical properties for different quality scores. Therefore, the mean vectors for each quality level varied, providing strong support for rejecting the null hypothesis.</span>
<span id="cb96-93"><a href="#cb96-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-94"><a href="#cb96-94" aria-hidden="true" tabindex="-1"></a><span class="fu">### MANOVA for Quality Groups \[Low, Medium, High\]</span></span>
<span id="cb96-95"><a href="#cb96-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-96"><a href="#cb96-96" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb96-97"><a href="#cb96-97" aria-hidden="true" tabindex="-1"></a>&amp;H_0: \mu_{\text{Low}} = \mu_{\text{Medium}} = \mu_{\text{High}} <span class="sc">\\</span></span>
<span id="cb96-98"><a href="#cb96-98" aria-hidden="true" tabindex="-1"></a>&amp;H_A: \text{At least one of } \mu_{\text{Low}}, \mu_{\text{Medium}}, \text{ or } \mu_{\text{High}} \text{ is different}</span>
<span id="cb96-99"><a href="#cb96-99" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb96-100"><a href="#cb96-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-101"><a href="#cb96-101" aria-hidden="true" tabindex="-1"></a>In the second analysis, we focused on Quality Groups (Low, Medium, High), and the results were also highly significant. The p-value was very close to zero, less than $2.2 x 10^{-16}$. This indicates significant differences in the average chemical properties across different quality groups. We have strong evidence that the mean vectors between each quality group differed. Therefore, we have evidence to reject the null and be in favor of the alternative.</span>
<span id="cb96-102"><a href="#cb96-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-103"><a href="#cb96-103" aria-hidden="true" tabindex="-1"></a><span class="fu">### Overall MANOVA Test Conclusion</span></span>
<span id="cb96-104"><a href="#cb96-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-105"><a href="#cb96-105" aria-hidden="true" tabindex="-1"></a>To summarize, our MANOVA tests reveal significant differences in average values for both original quality scores and quality groups. For original scores, statistics like Pillai's trace and Wilks' lambda had extremely low p-values $p &lt; 2.2 x 10^{-16}$. Quality groups exhibited similar results.</span>
<span id="cb96-106"><a href="#cb96-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-107"><a href="#cb96-107" aria-hidden="true" tabindex="-1"></a><span class="fu">## Perform Classification on Quality for Red Wines</span></span>
<span id="cb96-108"><a href="#cb96-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-109"><a href="#cb96-109" aria-hidden="true" tabindex="-1"></a><span class="fu">### Random Forest and SVM models</span></span>
<span id="cb96-110"><a href="#cb96-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-111"><a href="#cb96-111" aria-hidden="true" tabindex="-1"></a>I performed the same procedure from the previous classification of red and white wines. I've selected Random Forest &amp; Support Vector Machine the top models for classification. Logistic Regression is not designed for multiple classes. Interestingly, the Random Forest performed the best again, followed by SVM. It's important to note that the models were not fine-tuned for hyperparameters at this stage.</span>
<span id="cb96-112"><a href="#cb96-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-113"><a href="#cb96-113" aria-hidden="true" tabindex="-1"></a><span class="fu">### Metrics &amp; Variable Importance</span></span>
<span id="cb96-114"><a href="#cb96-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-115"><a href="#cb96-115" aria-hidden="true" tabindex="-1"></a>Random Forest emerged as the top-performing model once again, with an accuracy of $69.2\%$. For instance, we can observe that quality level 5 has the highest number of correct predictions $(163)$, while quality levels $4$ and $6$ have some misclassifications. Among the features, alcohol, total sulfur dioxide, and volatile acidity emerged as the top three influential variables, showcasing their significance in predicting wine quality in red wines.</span>
<span id="cb96-116"><a href="#cb96-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-117"><a href="#cb96-117" aria-hidden="true" tabindex="-1"></a><span class="fu">## Perform Principal Component Analysis</span></span>
<span id="cb96-118"><a href="#cb96-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-119"><a href="#cb96-119" aria-hidden="true" tabindex="-1"></a><span class="fu">### Explaining PC1 &amp; PC2</span></span>
<span id="cb96-120"><a href="#cb96-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-121"><a href="#cb96-121" aria-hidden="true" tabindex="-1"></a>PC1 can be interpreted as representing "Wine Body." Red wines with higher fixed acidity, citric acid, free sulfur dioxide, and total sulfur dioxide contribute positively to this component, indicating a fuller and more robust body. Hence, higher levels of volatile acidity, residual sugar, and alcohol contribute negatively to this component.</span>
<span id="cb96-122"><a href="#cb96-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-123"><a href="#cb96-123" aria-hidden="true" tabindex="-1"></a>PC2 can be labeled as "Fermentation Characteristics." Additionally, red wines with elevated levels of free sulfur dioxide, total sulfur dioxide, and density contribute positively to this component, highlighting aspects related to the fermentation process. On the other end, higher alcohol content and volatile acidity contribute negatively to PC2.</span>
<span id="cb96-124"><a href="#cb96-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-125"><a href="#cb96-125" aria-hidden="true" tabindex="-1"></a><span class="fu">### Random Forest Model with 2 PCA</span></span>
<span id="cb96-126"><a href="#cb96-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-127"><a href="#cb96-127" aria-hidden="true" tabindex="-1"></a>In the confusion matrix, it's evident that the model struggled to accurately predict certain classes, particularly in categories 3, 4, and 7, where the predicted values differ from the actual values. To add, random forest model achieved an accuracy of 58.07% which is quite below the previous models. Despite its limitations, the model demonstrated some success in capturing patterns related to "Wine Body" and "Fermentation Characteristics." And it's with just 2 variables with linear combinations.</span>
<span id="cb96-128"><a href="#cb96-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-129"><a href="#cb96-129" aria-hidden="true" tabindex="-1"></a><span class="fu">### Random Forest Model with 11 PCAs</span></span>
<span id="cb96-130"><a href="#cb96-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-131"><a href="#cb96-131" aria-hidden="true" tabindex="-1"></a>The random forest model attained an accuracy of 68.13%. Plus, it excelled in predicting class 5 but faced challenges in classes 3, 4, 6, and 7. Principal Component Analysis (PCA) highlights PC2 as the most influential (100%), followed by PC3 (80.49%), PC5 (32.47%), and others. This suggests a need for further analysis to enhance predictions in specific classes and leverage insights from key Principal Components for optimization.</span>
<span id="cb96-132"><a href="#cb96-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-133"><a href="#cb96-133" aria-hidden="true" tabindex="-1"></a><span class="fu">### Comparison between Random Forest Models (normal, 2PCs, 11PCs)</span></span>
<span id="cb96-134"><a href="#cb96-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-135"><a href="#cb96-135" aria-hidden="true" tabindex="-1"></a>In comparing the Random Forest models, both the normal model and the 11 PCs model achieve an accuracy of approximately 68%, surpassing the 2 PCs model, which attains an accuracy of 58.07%. It's noteworthy that the 2 PCs model demonstrates the potency of PCA, albeit with a trade-off in interpretability. Despite the challenges encountered, each model variant provides valuable insights for optimizing the predictive power. The room for improvement is wide open. Factors such as hyperparameter tuning, other models that were not explored, feature engineering, and delving further into factor analysis are instances that could be used to maximize performance.</span>
<span id="cb96-136"><a href="#cb96-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-137"><a href="#cb96-137" aria-hidden="true" tabindex="-1"></a>{{&lt; pagebreak &gt;}}</span>
<span id="cb96-138"><a href="#cb96-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-139"><a href="#cb96-139" aria-hidden="true" tabindex="-1"></a><span class="fu"># Appendix</span></span>
<span id="cb96-140"><a href="#cb96-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-141"><a href="#cb96-141" aria-hidden="true" tabindex="-1"></a><span class="fu"># Goal 1: Distinguish White Wines From Red Wines</span></span>
<span id="cb96-142"><a href="#cb96-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-145"><a href="#cb96-145" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb96-146"><a href="#cb96-146" aria-hidden="true" tabindex="-1"></a><span class="co"># Set scipen to a high value to disable scientific notation</span></span>
<span id="cb96-147"><a href="#cb96-147" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>)</span>
<span id="cb96-148"><a href="#cb96-148" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb96-149"><a href="#cb96-149" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb96-150"><a href="#cb96-150" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cluster) </span>
<span id="cb96-151"><a href="#cb96-151" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb96-152"><a href="#cb96-152" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb96-153"><a href="#cb96-153" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb96-154"><a href="#cb96-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-155"><a href="#cb96-155" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in the wine datasets</span></span>
<span id="cb96-156"><a href="#cb96-156" aria-hidden="true" tabindex="-1"></a>redWine <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"../../../assets/datasets/winequality-red.csv"</span>)</span>
<span id="cb96-157"><a href="#cb96-157" aria-hidden="true" tabindex="-1"></a>whiteWine <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"../../../assets/datasets/winequality-white.csv"</span>)</span>
<span id="cb96-158"><a href="#cb96-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-159"><a href="#cb96-159" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at the structure of the wine data</span></span>
<span id="cb96-160"><a href="#cb96-160" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(redWine)</span>
<span id="cb96-161"><a href="#cb96-161" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(whiteWine)</span>
<span id="cb96-162"><a href="#cb96-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-163"><a href="#cb96-163" aria-hidden="true" tabindex="-1"></a><span class="co"># Run a quick summary for both datasets</span></span>
<span id="cb96-164"><a href="#cb96-164" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(redWine)</span></span>
<span id="cb96-165"><a href="#cb96-165" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(whiteWine)</span></span>
<span id="cb96-166"><a href="#cb96-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-167"><a href="#cb96-167" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a 'wine_type' column to identify the wine type</span></span>
<span id="cb96-168"><a href="#cb96-168" aria-hidden="true" tabindex="-1"></a>redWine<span class="sc">$</span>wineType <span class="ot">&lt;-</span> <span class="st">"red"</span></span>
<span id="cb96-169"><a href="#cb96-169" aria-hidden="true" tabindex="-1"></a>whiteWine<span class="sc">$</span>wineType <span class="ot">&lt;-</span> <span class="st">"white"</span></span>
<span id="cb96-170"><a href="#cb96-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-171"><a href="#cb96-171" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the datasets</span></span>
<span id="cb96-172"><a href="#cb96-172" aria-hidden="true" tabindex="-1"></a>wine <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(redWine, whiteWine)</span>
<span id="cb96-173"><a href="#cb96-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-174"><a href="#cb96-174" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename columns for better readability and consistency</span></span>
<span id="cb96-175"><a href="#cb96-175" aria-hidden="true" tabindex="-1"></a>wine <span class="ot">&lt;-</span> wine <span class="sc">%&gt;%</span> </span>
<span id="cb96-176"><a href="#cb96-176" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">fixedAcidity =</span> <span class="st">`</span><span class="at">fixed acidity</span><span class="st">`</span>,</span>
<span id="cb96-177"><a href="#cb96-177" aria-hidden="true" tabindex="-1"></a>         <span class="at">volatileAcidity =</span> <span class="st">`</span><span class="at">volatile acidity</span><span class="st">`</span>,</span>
<span id="cb96-178"><a href="#cb96-178" aria-hidden="true" tabindex="-1"></a>         <span class="at">citricAcid =</span> <span class="st">`</span><span class="at">citric acid</span><span class="st">`</span>,</span>
<span id="cb96-179"><a href="#cb96-179" aria-hidden="true" tabindex="-1"></a>         <span class="at">residualSugar =</span> <span class="st">`</span><span class="at">residual sugar</span><span class="st">`</span>,</span>
<span id="cb96-180"><a href="#cb96-180" aria-hidden="true" tabindex="-1"></a>         <span class="at">freeSulfurDioxide =</span> <span class="st">`</span><span class="at">free sulfur dioxide</span><span class="st">`</span>,</span>
<span id="cb96-181"><a href="#cb96-181" aria-hidden="true" tabindex="-1"></a>         <span class="at">totalSulfurDioxide =</span> <span class="st">`</span><span class="at">total sulfur dioxide</span><span class="st">`</span>,</span>
<span id="cb96-182"><a href="#cb96-182" aria-hidden="true" tabindex="-1"></a>         <span class="at">wineType =</span> <span class="fu">factor</span>(wineType, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"white"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb96-183"><a href="#cb96-183" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">`</span><span class="at">fixed acidity</span><span class="st">`</span>,</span>
<span id="cb96-184"><a href="#cb96-184" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">volatile acidity</span><span class="st">`</span>,</span>
<span id="cb96-185"><a href="#cb96-185" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">citric acid</span><span class="st">`</span>,</span>
<span id="cb96-186"><a href="#cb96-186" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">residual sugar</span><span class="st">`</span>,</span>
<span id="cb96-187"><a href="#cb96-187" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">free sulfur dioxide</span><span class="st">`</span>,</span>
<span id="cb96-188"><a href="#cb96-188" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">total sulfur dioxide</span><span class="st">`</span>))</span>
<span id="cb96-189"><a href="#cb96-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-190"><a href="#cb96-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-191"><a href="#cb96-191" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for quality counts</span></span>
<span id="cb96-192"><a href="#cb96-192" aria-hidden="true" tabindex="-1"></a>wine <span class="sc">%&gt;%</span></span>
<span id="cb96-193"><a href="#cb96-193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(quality) <span class="sc">%&gt;%</span></span>
<span id="cb96-194"><a href="#cb96-194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">totalCount =</span> <span class="fu">n</span>())</span>
<span id="cb96-195"><a href="#cb96-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-196"><a href="#cb96-196" aria-hidden="true" tabindex="-1"></a>wineDs <span class="ot">&lt;-</span> wine <span class="sc">%&gt;%</span></span>
<span id="cb96-197"><a href="#cb96-197" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>quality)</span>
<span id="cb96-198"><a href="#cb96-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-199"><a href="#cb96-199" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(wineDs)</span>
<span id="cb96-200"><a href="#cb96-200" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(wineDs)</span>
<span id="cb96-201"><a href="#cb96-201" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(wineDs))</span>
<span id="cb96-202"><a href="#cb96-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-203"><a href="#cb96-203" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb96-204"><a href="#cb96-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-205"><a href="#cb96-205" aria-hidden="true" tabindex="-1"></a><span class="fu">## Perform EDA on Red &amp; White Wine Means:</span></span>
<span id="cb96-206"><a href="#cb96-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-209"><a href="#cb96-209" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb96-210"><a href="#cb96-210" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the mean vectors for red and white wines </span></span>
<span id="cb96-211"><a href="#cb96-211" aria-hidden="true" tabindex="-1"></a><span class="co"># separately for each of the 11 chemical attributes</span></span>
<span id="cb96-212"><a href="#cb96-212" aria-hidden="true" tabindex="-1"></a>meanVectors <span class="ot">&lt;-</span> wineDs <span class="sc">%&gt;%</span> </span>
<span id="cb96-213"><a href="#cb96-213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(wineType) <span class="sc">%&gt;%</span></span>
<span id="cb96-214"><a href="#cb96-214" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize_all</span>(mean)</span>
<span id="cb96-215"><a href="#cb96-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-216"><a href="#cb96-216" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the mean vectors</span></span>
<span id="cb96-217"><a href="#cb96-217" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(meanVectors, <span class="dv">2</span>)</span>
<span id="cb96-218"><a href="#cb96-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-219"><a href="#cb96-219" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to long format for plotting</span></span>
<span id="cb96-220"><a href="#cb96-220" aria-hidden="true" tabindex="-1"></a>meanDs <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">gather</span>(meanVectors,</span>
<span id="cb96-221"><a href="#cb96-221" aria-hidden="true" tabindex="-1"></a>                        <span class="at">key =</span> <span class="st">"attribute"</span>, </span>
<span id="cb96-222"><a href="#cb96-222" aria-hidden="true" tabindex="-1"></a>                        <span class="at">value =</span> <span class="st">"means"</span>, <span class="sc">-</span>wineType)</span>
<span id="cb96-223"><a href="#cb96-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-224"><a href="#cb96-224" aria-hidden="true" tabindex="-1"></a><span class="co">#meanDs</span></span>
<span id="cb96-225"><a href="#cb96-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-226"><a href="#cb96-226" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb96-227"><a href="#cb96-227" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(meanDs, <span class="fu">aes</span>(<span class="at">x =</span> means, <span class="at">y =</span> attribute, <span class="at">fill =</span> wineType)) <span class="sc">+</span></span>
<span id="cb96-228"><a href="#cb96-228" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb96-229"><a href="#cb96-229" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Mean Values for Red|White Wines"</span>,</span>
<span id="cb96-230"><a href="#cb96-230" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Mean Value"</span>,</span>
<span id="cb96-231"><a href="#cb96-231" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Chemical Attributes"</span>) <span class="sc">+</span></span>
<span id="cb96-232"><a href="#cb96-232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb96-233"><a href="#cb96-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-234"><a href="#cb96-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-235"><a href="#cb96-235" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb96-236"><a href="#cb96-236" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(meanDs, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(means), <span class="at">y =</span> attribute, <span class="at">fill =</span> wineType)) <span class="sc">+</span></span>
<span id="cb96-237"><a href="#cb96-237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb96-238"><a href="#cb96-238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Log-Transformed Mean Values for Red|White Wines"</span>,</span>
<span id="cb96-239"><a href="#cb96-239" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Mean Value"</span>,</span>
<span id="cb96-240"><a href="#cb96-240" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Chemical Attributes"</span>) <span class="sc">+</span></span>
<span id="cb96-241"><a href="#cb96-241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb96-242"><a href="#cb96-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-243"><a href="#cb96-243" aria-hidden="true" tabindex="-1"></a>meanDifDs <span class="ot">&lt;-</span> meanDs <span class="sc">%&gt;%</span></span>
<span id="cb96-244"><a href="#cb96-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(wineType, means) <span class="sc">%&gt;%</span></span>
<span id="cb96-245"><a href="#cb96-245" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">meanDifference =</span> red <span class="sc">-</span> white)</span>
<span id="cb96-246"><a href="#cb96-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-247"><a href="#cb96-247" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the mean differences</span></span>
<span id="cb96-248"><a href="#cb96-248" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(meanDifDs, <span class="fu">aes</span>(<span class="at">x =</span> meanDifference, <span class="at">y =</span> attribute)) <span class="sc">+</span></span>
<span id="cb96-249"><a href="#cb96-249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>, </span>
<span id="cb96-250"><a href="#cb96-250" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb96-251"><a href="#cb96-251" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Mean Differences between Red &amp; White Wines"</span>,</span>
<span id="cb96-252"><a href="#cb96-252" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Mean Difference"</span>,</span>
<span id="cb96-253"><a href="#cb96-253" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Chemical Attributes"</span>) <span class="sc">+</span></span>
<span id="cb96-254"><a href="#cb96-254" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb96-255"><a href="#cb96-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-256"><a href="#cb96-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-257"><a href="#cb96-257" aria-hidden="true" tabindex="-1"></a><span class="co"># Show plot 1 for report</span></span>
<span id="cb96-258"><a href="#cb96-258" aria-hidden="true" tabindex="-1"></a>p1</span>
<span id="cb96-259"><a href="#cb96-259" aria-hidden="true" tabindex="-1"></a>p2</span>
<span id="cb96-260"><a href="#cb96-260" aria-hidden="true" tabindex="-1"></a>p3</span>
<span id="cb96-261"><a href="#cb96-261" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb96-262"><a href="#cb96-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-263"><a href="#cb96-263" aria-hidden="true" tabindex="-1"></a><span class="fu">## Perform MANOVA to determine if there are a significant difference in mean vectors between red and white wines with a 95% confidence level.</span></span>
<span id="cb96-264"><a href="#cb96-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-267"><a href="#cb96-267" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb96-268"><a href="#cb96-268" aria-hidden="true" tabindex="-1"></a>wineManova <span class="ot">&lt;-</span> <span class="fu">manova</span>(<span class="fu">cbind</span>(chlorides, density, pH, sulphates, </span>
<span id="cb96-269"><a href="#cb96-269" aria-hidden="true" tabindex="-1"></a>                           alcohol, fixedAcidity, volatileAcidity, </span>
<span id="cb96-270"><a href="#cb96-270" aria-hidden="true" tabindex="-1"></a>                           citricAcid, residualSugar, freeSulfurDioxide,</span>
<span id="cb96-271"><a href="#cb96-271" aria-hidden="true" tabindex="-1"></a>                           totalSulfurDioxide) <span class="sc">~</span> wineType, <span class="at">data =</span> wineDs) </span>
<span id="cb96-272"><a href="#cb96-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-273"><a href="#cb96-273" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the summary of the MANOVA</span></span>
<span id="cb96-274"><a href="#cb96-274" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wineManova)</span>
<span id="cb96-275"><a href="#cb96-275" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb96-276"><a href="#cb96-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-277"><a href="#cb96-277" aria-hidden="true" tabindex="-1"></a><span class="fu">### MANOVA Results</span></span>
<span id="cb96-278"><a href="#cb96-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-279"><a href="#cb96-279" aria-hidden="true" tabindex="-1"></a><span class="fu">## Perform Classification Modeling on Red &amp; White Wines</span></span>
<span id="cb96-280"><a href="#cb96-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-281"><a href="#cb96-281" aria-hidden="true" tabindex="-1"></a><span class="fu">### Train-Test Split &amp; Cross-Validation Set up</span></span>
<span id="cb96-282"><a href="#cb96-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-285"><a href="#cb96-285" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb96-286"><a href="#cb96-286" aria-hidden="true" tabindex="-1"></a>splitIndex <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(wineDs<span class="sc">$</span>wineType, <span class="at">p =</span> <span class="fl">0.7</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb96-287"><a href="#cb96-287" aria-hidden="true" tabindex="-1"></a>trainData <span class="ot">&lt;-</span> wineDs[splitIndex, ]</span>
<span id="cb96-288"><a href="#cb96-288" aria-hidden="true" tabindex="-1"></a>testData <span class="ot">&lt;-</span> wineDs[<span class="sc">-</span>splitIndex, ]</span>
<span id="cb96-289"><a href="#cb96-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-290"><a href="#cb96-290" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Repeated cross-validation</span></span>
<span id="cb96-291"><a href="#cb96-291" aria-hidden="true" tabindex="-1"></a>ctrl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"repeatedcv"</span>, </span>
<span id="cb96-292"><a href="#cb96-292" aria-hidden="true" tabindex="-1"></a>                     <span class="at">number =</span> <span class="dv">5</span>, </span>
<span id="cb96-293"><a href="#cb96-293" aria-hidden="true" tabindex="-1"></a>                     <span class="at">repeats =</span> <span class="dv">3</span>, </span>
<span id="cb96-294"><a href="#cb96-294" aria-hidden="true" tabindex="-1"></a>                     <span class="at">verboseIter =</span> <span class="cn">FALSE</span>)</span>
<span id="cb96-295"><a href="#cb96-295" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb96-296"><a href="#cb96-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-297"><a href="#cb96-297" aria-hidden="true" tabindex="-1"></a><span class="fu">### Random Forest, SVM and Logistic Models</span></span>
<span id="cb96-298"><a href="#cb96-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-301"><a href="#cb96-301" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb96-302"><a href="#cb96-302" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2013</span>)</span>
<span id="cb96-303"><a href="#cb96-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-304"><a href="#cb96-304" aria-hidden="true" tabindex="-1"></a><span class="co"># Train Random Forest</span></span>
<span id="cb96-305"><a href="#cb96-305" aria-hidden="true" tabindex="-1"></a>rfModel <span class="ot">&lt;-</span> <span class="fu">train</span>(wineType <span class="sc">~</span> ., </span>
<span id="cb96-306"><a href="#cb96-306" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> trainData,</span>
<span id="cb96-307"><a href="#cb96-307" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"rf"</span>,</span>
<span id="cb96-308"><a href="#cb96-308" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> ctrl,</span>
<span id="cb96-309"><a href="#cb96-309" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ntree =</span> <span class="dv">200</span>)</span>
<span id="cb96-310"><a href="#cb96-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-311"><a href="#cb96-311" aria-hidden="true" tabindex="-1"></a><span class="co"># Train Logistic Regression</span></span>
<span id="cb96-312"><a href="#cb96-312" aria-hidden="true" tabindex="-1"></a>logisticModel <span class="ot">&lt;-</span> <span class="fu">train</span>(wineType <span class="sc">~</span> ., </span>
<span id="cb96-313"><a href="#cb96-313" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> trainData,</span>
<span id="cb96-314"><a href="#cb96-314" aria-hidden="true" tabindex="-1"></a>                       <span class="at">method =</span> <span class="st">"glm"</span>,</span>
<span id="cb96-315"><a href="#cb96-315" aria-hidden="true" tabindex="-1"></a>                       <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb96-316"><a href="#cb96-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-317"><a href="#cb96-317" aria-hidden="true" tabindex="-1"></a><span class="co"># Train Support Vector Machine</span></span>
<span id="cb96-318"><a href="#cb96-318" aria-hidden="true" tabindex="-1"></a>svmModel <span class="ot">&lt;-</span> <span class="fu">train</span>(wineType <span class="sc">~</span> ., </span>
<span id="cb96-319"><a href="#cb96-319" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> trainData,</span>
<span id="cb96-320"><a href="#cb96-320" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"svmRadial"</span>,</span>
<span id="cb96-321"><a href="#cb96-321" aria-hidden="true" tabindex="-1"></a>                  <span class="at">trControl =</span> ctrl)</span>
<span id="cb96-322"><a href="#cb96-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-323"><a href="#cb96-323" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test set for each model</span></span>
<span id="cb96-324"><a href="#cb96-324" aria-hidden="true" tabindex="-1"></a>rfPred <span class="ot">&lt;-</span> <span class="fu">predict</span>(rfModel, <span class="at">newdata =</span> testData)</span>
<span id="cb96-325"><a href="#cb96-325" aria-hidden="true" tabindex="-1"></a>logisticPred <span class="ot">&lt;-</span> <span class="fu">predict</span>(logisticModel, <span class="at">newdata =</span> testData)</span>
<span id="cb96-326"><a href="#cb96-326" aria-hidden="true" tabindex="-1"></a>svmPred <span class="ot">&lt;-</span> <span class="fu">predict</span>(svmModel, <span class="at">newdata =</span> testData)</span>
<span id="cb96-327"><a href="#cb96-327" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb96-328"><a href="#cb96-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-329"><a href="#cb96-329" aria-hidden="true" tabindex="-1"></a><span class="fu">### Metrics &amp; Variable Importance</span></span>
<span id="cb96-330"><a href="#cb96-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-333"><a href="#cb96-333" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb96-334"><a href="#cb96-334" aria-hidden="true" tabindex="-1"></a><span class="co"># Random Forest model metrics</span></span>
<span id="cb96-335"><a href="#cb96-335" aria-hidden="true" tabindex="-1"></a>confMatrixRF <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(rfPred, testData<span class="sc">$</span>wineType, </span>
<span id="cb96-336"><a href="#cb96-336" aria-hidden="true" tabindex="-1"></a>                                <span class="at">dnn =</span> <span class="fu">c</span>(<span class="st">"Prediction"</span>, <span class="st">"Reference"</span>))</span>
<span id="cb96-337"><a href="#cb96-337" aria-hidden="true" tabindex="-1"></a>accuracyRF <span class="ot">&lt;-</span> confMatrixRF<span class="sc">$</span>overall[<span class="st">"Accuracy"</span>]</span>
<span id="cb96-338"><a href="#cb96-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-339"><a href="#cb96-339" aria-hidden="true" tabindex="-1"></a><span class="co"># Logistic Regression model metrics</span></span>
<span id="cb96-340"><a href="#cb96-340" aria-hidden="true" tabindex="-1"></a>confMatrixLogistic <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(logisticPred, testData<span class="sc">$</span>wineType, </span>
<span id="cb96-341"><a href="#cb96-341" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">dnn =</span> <span class="fu">c</span>(<span class="st">"Prediction"</span>, <span class="st">"Reference"</span>))</span>
<span id="cb96-342"><a href="#cb96-342" aria-hidden="true" tabindex="-1"></a>accuracyLogistic <span class="ot">&lt;-</span> confMatrixLogistic<span class="sc">$</span>overall[<span class="st">"Accuracy"</span>]</span>
<span id="cb96-343"><a href="#cb96-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-344"><a href="#cb96-344" aria-hidden="true" tabindex="-1"></a><span class="co"># SVM model metrics</span></span>
<span id="cb96-345"><a href="#cb96-345" aria-hidden="true" tabindex="-1"></a>confMatrixSVM <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(svmPred, testData<span class="sc">$</span>wineType, </span>
<span id="cb96-346"><a href="#cb96-346" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">dnn =</span> <span class="fu">c</span>(<span class="st">"Prediction"</span>, <span class="st">"Reference"</span>))</span>
<span id="cb96-347"><a href="#cb96-347" aria-hidden="true" tabindex="-1"></a>accuracySVM <span class="ot">&lt;-</span> confMatrixSVM<span class="sc">$</span>overall[<span class="st">"Accuracy"</span>]</span>
<span id="cb96-348"><a href="#cb96-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-349"><a href="#cb96-349" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Confusion Matrices</span></span>
<span id="cb96-350"><a href="#cb96-350" aria-hidden="true" tabindex="-1"></a>plotCM <span class="ot">&lt;-</span> <span class="cf">function</span>(confMatrix, modelName) {</span>
<span id="cb96-351"><a href="#cb96-351" aria-hidden="true" tabindex="-1"></a>  plt <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(confMatrix<span class="sc">$</span>table)</span>
<span id="cb96-352"><a href="#cb96-352" aria-hidden="true" tabindex="-1"></a>  plt<span class="sc">$</span>Prediction <span class="ot">&lt;-</span> <span class="fu">factor</span>(plt<span class="sc">$</span>Prediction, </span>
<span id="cb96-353"><a href="#cb96-353" aria-hidden="true" tabindex="-1"></a>                           <span class="at">levels =</span> <span class="fu">rev</span>(<span class="fu">levels</span>(plt<span class="sc">$</span>Prediction)))</span>
<span id="cb96-354"><a href="#cb96-354" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb96-355"><a href="#cb96-355" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(plt, <span class="fu">aes</span>(Prediction, Reference, <span class="at">fill =</span> Freq)) <span class="sc">+</span></span>
<span id="cb96-356"><a href="#cb96-356" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>() <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Freq)) <span class="sc">+</span></span>
<span id="cb96-357"><a href="#cb96-357" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"#00859B"</span>) <span class="sc">+</span></span>
<span id="cb96-358"><a href="#cb96-358" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Confusion Matrix -"</span>, modelName),</span>
<span id="cb96-359"><a href="#cb96-359" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Reference"</span>, <span class="at">y =</span> <span class="st">"Prediction"</span>) <span class="sc">+</span></span>
<span id="cb96-360"><a href="#cb96-360" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">levels</span>(testData<span class="sc">$</span>wineType)) <span class="sc">+</span></span>
<span id="cb96-361"><a href="#cb96-361" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> <span class="fu">levels</span>(testData<span class="sc">$</span>wineType))</span>
<span id="cb96-362"><a href="#cb96-362" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb96-363"><a href="#cb96-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-364"><a href="#cb96-364" aria-hidden="true" tabindex="-1"></a><span class="co">#confMatrixRF</span></span>
<span id="cb96-365"><a href="#cb96-365" aria-hidden="true" tabindex="-1"></a>confMatrixLogistic</span>
<span id="cb96-366"><a href="#cb96-366" aria-hidden="true" tabindex="-1"></a><span class="co">#confMatrixSVM</span></span>
<span id="cb96-367"><a href="#cb96-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-368"><a href="#cb96-368" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Confusion Matrices for each model</span></span>
<span id="cb96-369"><a href="#cb96-369" aria-hidden="true" tabindex="-1"></a><span class="fu">plotCM</span>(confMatrixRF, <span class="st">"Random Forest"</span>)</span>
<span id="cb96-370"><a href="#cb96-370" aria-hidden="true" tabindex="-1"></a><span class="fu">plotCM</span>(confMatrixLogistic, <span class="st">"Logistic Regression"</span>)</span>
<span id="cb96-371"><a href="#cb96-371" aria-hidden="true" tabindex="-1"></a><span class="fu">plotCM</span>(confMatrixSVM, <span class="st">"Support Vector Machine (SVM)"</span>)</span>
<span id="cb96-372"><a href="#cb96-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-373"><a href="#cb96-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-374"><a href="#cb96-374" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the metrics for each model</span></span>
<span id="cb96-375"><a href="#cb96-375" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Random Forest Model Results"</span>)</span>
<span id="cb96-376"><a href="#cb96-376" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Accuracy:"</span>, <span class="fu">round</span>(accuracyRF, <span class="dv">4</span>)))</span>
<span id="cb96-377"><a href="#cb96-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-378"><a href="#cb96-378" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Logistic Regression Model Results:"</span>)</span>
<span id="cb96-379"><a href="#cb96-379" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Accuracy:"</span>, <span class="fu">round</span>(accuracyLogistic, <span class="dv">4</span>)))</span>
<span id="cb96-380"><a href="#cb96-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-381"><a href="#cb96-381" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Support Vector Machine (SVM) Model Results:"</span>)</span>
<span id="cb96-382"><a href="#cb96-382" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Accuracy:"</span>, <span class="fu">round</span>(accuracySVM, <span class="dv">4</span>)))</span>
<span id="cb96-383"><a href="#cb96-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-384"><a href="#cb96-384" aria-hidden="true" tabindex="-1"></a><span class="co"># Get variable importance from the best model</span></span>
<span id="cb96-385"><a href="#cb96-385" aria-hidden="true" tabindex="-1"></a><span class="fu">varImp</span>(rfModel)</span>
<span id="cb96-386"><a href="#cb96-386" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb96-387"><a href="#cb96-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-388"><a href="#cb96-388" aria-hidden="true" tabindex="-1"></a><span class="fu">### Classifying a New Red Wine Drawn From The Same Population</span></span>
<span id="cb96-389"><a href="#cb96-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-390"><a href="#cb96-390" aria-hidden="true" tabindex="-1"></a><span class="fu">## Clustering:</span></span>
<span id="cb96-391"><a href="#cb96-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-394"><a href="#cb96-394" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb96-395"><a href="#cb96-395" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb96-396"><a href="#cb96-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-397"><a href="#cb96-397" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> wineDs <span class="sc">%&gt;%</span></span>
<span id="cb96-398"><a href="#cb96-398" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>wineType)</span>
<span id="cb96-399"><a href="#cb96-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-400"><a href="#cb96-400" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> <span class="fu">scale</span>(ds)</span>
<span id="cb96-401"><a href="#cb96-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-402"><a href="#cb96-402" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(ds, kmeans, <span class="at">method=</span><span class="st">'silhouette'</span>)</span>
<span id="cb96-403"><a href="#cb96-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-404"><a href="#cb96-404" aria-hidden="true" tabindex="-1"></a>km.final <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(ds, <span class="dv">2</span>, <span class="at">nstart =</span> <span class="dv">30</span>)</span>
<span id="cb96-405"><a href="#cb96-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-406"><a href="#cb96-406" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(km.final, <span class="at">data =</span> ds, </span>
<span id="cb96-407"><a href="#cb96-407" aria-hidden="true" tabindex="-1"></a>             <span class="at">geom =</span> <span class="st">"point"</span>,</span>
<span id="cb96-408"><a href="#cb96-408" aria-hidden="true" tabindex="-1"></a>             <span class="at">ellipse.type =</span> <span class="st">"convex"</span>, </span>
<span id="cb96-409"><a href="#cb96-409" aria-hidden="true" tabindex="-1"></a>             <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>())</span>
<span id="cb96-410"><a href="#cb96-410" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb96-411"><a href="#cb96-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-412"><a href="#cb96-412" aria-hidden="true" tabindex="-1"></a><span class="fu"># Goal 2: Which Variables Are The Most Important To Wine Quality In Red Wines.</span></span>
<span id="cb96-413"><a href="#cb96-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-414"><a href="#cb96-414" aria-hidden="true" tabindex="-1"></a><span class="fu">## Perform MANOVAs to determine if there are a significant difference in mean vectors between wines with different quality/quality groups with a 95% confidence level?</span></span>
<span id="cb96-415"><a href="#cb96-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-416"><a href="#cb96-416" aria-hidden="true" tabindex="-1"></a><span class="fu">### MANOVA for Quality Levels 3, 4, 5, 6, 7, 8</span></span>
<span id="cb96-417"><a href="#cb96-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-420"><a href="#cb96-420" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb96-421"><a href="#cb96-421" aria-hidden="true" tabindex="-1"></a>redWineDs <span class="ot">&lt;-</span> wine <span class="sc">%&gt;%</span></span>
<span id="cb96-422"><a href="#cb96-422" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wineType <span class="sc">==</span> <span class="st">"red"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb96-423"><a href="#cb96-423" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>wineType)</span>
<span id="cb96-424"><a href="#cb96-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-425"><a href="#cb96-425" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting Columns</span></span>
<span id="cb96-426"><a href="#cb96-426" aria-hidden="true" tabindex="-1"></a>colVars <span class="ot">&lt;-</span>  <span class="fu">cbind</span>(</span>
<span id="cb96-427"><a href="#cb96-427" aria-hidden="true" tabindex="-1"></a>  redWineDs<span class="sc">$</span>chlorides, redWineDs<span class="sc">$</span>density, redWineDs<span class="sc">$</span>pH, redWineDs<span class="sc">$</span>sulphates, </span>
<span id="cb96-428"><a href="#cb96-428" aria-hidden="true" tabindex="-1"></a>  redWineDs<span class="sc">$</span>alcohol, redWineDs<span class="sc">$</span>fixedAcidity, redWineDs<span class="sc">$</span>volatileAcidity, </span>
<span id="cb96-429"><a href="#cb96-429" aria-hidden="true" tabindex="-1"></a>  redWineDs<span class="sc">$</span>citricAcid, redWineDs<span class="sc">$</span>residualSugar, redWineDs<span class="sc">$</span>freeSulfurDioxide,</span>
<span id="cb96-430"><a href="#cb96-430" aria-hidden="true" tabindex="-1"></a>  redWineDs<span class="sc">$</span>totalSulfurDioxide</span>
<span id="cb96-431"><a href="#cb96-431" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb96-432"><a href="#cb96-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-433"><a href="#cb96-433" aria-hidden="true" tabindex="-1"></a><span class="co"># MANOVA Analysis - Quality, levels = 3,4,5,6,7,8</span></span>
<span id="cb96-434"><a href="#cb96-434" aria-hidden="true" tabindex="-1"></a>manaovaTest <span class="ot">&lt;-</span> <span class="fu">manova</span>(colVars <span class="sc">~</span> quality, <span class="at">data =</span> redWineDs)</span>
<span id="cb96-435"><a href="#cb96-435" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(manaovaTest)</span>
<span id="cb96-436"><a href="#cb96-436" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb96-437"><a href="#cb96-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-438"><a href="#cb96-438" aria-hidden="true" tabindex="-1"></a><span class="fu">### MANOVA for Quality Groups \[Low, Medium, High\]</span></span>
<span id="cb96-439"><a href="#cb96-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-442"><a href="#cb96-442" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb96-443"><a href="#cb96-443" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding qualityGroup</span></span>
<span id="cb96-444"><a href="#cb96-444" aria-hidden="true" tabindex="-1"></a>redWineDs <span class="ot">&lt;-</span> redWineDs <span class="sc">%&gt;%</span> </span>
<span id="cb96-445"><a href="#cb96-445" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb96-446"><a href="#cb96-446" aria-hidden="true" tabindex="-1"></a>    <span class="at">qualityGroup =</span> <span class="fu">case_when</span>(</span>
<span id="cb96-447"><a href="#cb96-447" aria-hidden="true" tabindex="-1"></a>      quality <span class="sc">%in%</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">~</span> <span class="st">"Low"</span>,</span>
<span id="cb96-448"><a href="#cb96-448" aria-hidden="true" tabindex="-1"></a>      quality <span class="sc">%in%</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">6</span> <span class="sc">~</span> <span class="st">"Medium"</span>,</span>
<span id="cb96-449"><a href="#cb96-449" aria-hidden="true" tabindex="-1"></a>      quality <span class="sc">%in%</span> <span class="dv">7</span><span class="sc">:</span><span class="dv">8</span> <span class="sc">~</span> <span class="st">"High"</span></span>
<span id="cb96-450"><a href="#cb96-450" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb96-451"><a href="#cb96-451" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb96-452"><a href="#cb96-452" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">qualityGroup =</span> <span class="fu">factor</span>(qualityGroup, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Low"</span>, </span>
<span id="cb96-453"><a href="#cb96-453" aria-hidden="true" tabindex="-1"></a>                                                        <span class="st">"Medium"</span>, </span>
<span id="cb96-454"><a href="#cb96-454" aria-hidden="true" tabindex="-1"></a>                                                        <span class="st">"High"</span>)))</span>
<span id="cb96-455"><a href="#cb96-455" aria-hidden="true" tabindex="-1"></a>colVarsCategorized <span class="ot">&lt;-</span>  <span class="fu">cbind</span>(</span>
<span id="cb96-456"><a href="#cb96-456" aria-hidden="true" tabindex="-1"></a>  redWineDs<span class="sc">$</span>chlorides, redWineDs<span class="sc">$</span>density, redWineDs<span class="sc">$</span>pH, </span>
<span id="cb96-457"><a href="#cb96-457" aria-hidden="true" tabindex="-1"></a>  redWineDs<span class="sc">$</span>sulphates, redWineDs<span class="sc">$</span>alcohol, redWineDs<span class="sc">$</span>fixedAcidity, </span>
<span id="cb96-458"><a href="#cb96-458" aria-hidden="true" tabindex="-1"></a>  redWineDs<span class="sc">$</span>volatileAcidity, redWineDs<span class="sc">$</span>citricAcid, </span>
<span id="cb96-459"><a href="#cb96-459" aria-hidden="true" tabindex="-1"></a>  redWineDs<span class="sc">$</span>residualSugar, redWineDs<span class="sc">$</span>freeSulfurDioxide,</span>
<span id="cb96-460"><a href="#cb96-460" aria-hidden="true" tabindex="-1"></a>  redWineDs<span class="sc">$</span>totalSulfurDioxide</span>
<span id="cb96-461"><a href="#cb96-461" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb96-462"><a href="#cb96-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-463"><a href="#cb96-463" aria-hidden="true" tabindex="-1"></a><span class="co"># MANOVA Analysis - QualityGroup, Levels = "Low", "Medium", "High"</span></span>
<span id="cb96-464"><a href="#cb96-464" aria-hidden="true" tabindex="-1"></a>manaovaTest <span class="ot">&lt;-</span> <span class="fu">manova</span>(colVars <span class="sc">~</span> qualityGroup, <span class="at">data =</span> redWineDs)</span>
<span id="cb96-465"><a href="#cb96-465" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(manaovaTest)</span>
<span id="cb96-466"><a href="#cb96-466" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb96-467"><a href="#cb96-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-468"><a href="#cb96-468" aria-hidden="true" tabindex="-1"></a><span class="fu">### Overall MANOVA Test Conclusion</span></span>
<span id="cb96-469"><a href="#cb96-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-470"><a href="#cb96-470" aria-hidden="true" tabindex="-1"></a><span class="fu">## Perform Classification on Quality for Red Wines</span></span>
<span id="cb96-471"><a href="#cb96-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-474"><a href="#cb96-474" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb96-475"><a href="#cb96-475" aria-hidden="true" tabindex="-1"></a>qualityDs <span class="ot">&lt;-</span> redWineDs <span class="sc">%&gt;%</span></span>
<span id="cb96-476"><a href="#cb96-476" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">quality =</span> <span class="fu">factor</span>(quality, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"3"</span>,<span class="st">"4"</span>,<span class="st">"5"</span>,<span class="st">"6"</span>,<span class="st">"7"</span>,<span class="st">"8"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb96-477"><a href="#cb96-477" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>qualityGroup)</span>
<span id="cb96-478"><a href="#cb96-478" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb96-479"><a href="#cb96-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-482"><a href="#cb96-482" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb96-483"><a href="#cb96-483" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the dataset into training and testing sets</span></span>
<span id="cb96-484"><a href="#cb96-484" aria-hidden="true" tabindex="-1"></a>splitIndex <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(qualityDs<span class="sc">$</span>quality, <span class="at">p =</span> <span class="fl">0.7</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb96-485"><a href="#cb96-485" aria-hidden="true" tabindex="-1"></a>trainData <span class="ot">&lt;-</span> qualityDs[splitIndex, ]</span>
<span id="cb96-486"><a href="#cb96-486" aria-hidden="true" tabindex="-1"></a>testData <span class="ot">&lt;-</span> qualityDs[<span class="sc">-</span>splitIndex, ]</span>
<span id="cb96-487"><a href="#cb96-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-488"><a href="#cb96-488" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a train control object for repeated cross-validation</span></span>
<span id="cb96-489"><a href="#cb96-489" aria-hidden="true" tabindex="-1"></a>ctrl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"repeatedcv"</span>, </span>
<span id="cb96-490"><a href="#cb96-490" aria-hidden="true" tabindex="-1"></a>                     <span class="at">number =</span> <span class="dv">5</span>, </span>
<span id="cb96-491"><a href="#cb96-491" aria-hidden="true" tabindex="-1"></a>                     <span class="at">repeats =</span> <span class="dv">3</span>, </span>
<span id="cb96-492"><a href="#cb96-492" aria-hidden="true" tabindex="-1"></a>                     <span class="at">verboseIter =</span> <span class="cn">FALSE</span>)</span>
<span id="cb96-493"><a href="#cb96-493" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb96-494"><a href="#cb96-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-495"><a href="#cb96-495" aria-hidden="true" tabindex="-1"></a><span class="fu">### Random Forest and SVM models</span></span>
<span id="cb96-496"><a href="#cb96-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-499"><a href="#cb96-499" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb96-500"><a href="#cb96-500" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2013</span>)</span>
<span id="cb96-501"><a href="#cb96-501" aria-hidden="true" tabindex="-1"></a><span class="co"># Random Forest model</span></span>
<span id="cb96-502"><a href="#cb96-502" aria-hidden="true" tabindex="-1"></a>rfModel <span class="ot">&lt;-</span> <span class="fu">train</span>(quality <span class="sc">~</span> ., </span>
<span id="cb96-503"><a href="#cb96-503" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> trainData,</span>
<span id="cb96-504"><a href="#cb96-504" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"rf"</span>,</span>
<span id="cb96-505"><a href="#cb96-505" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> ctrl,</span>
<span id="cb96-506"><a href="#cb96-506" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ntree =</span> <span class="dv">200</span>)</span>
<span id="cb96-507"><a href="#cb96-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-508"><a href="#cb96-508" aria-hidden="true" tabindex="-1"></a><span class="co"># (SVM) model</span></span>
<span id="cb96-509"><a href="#cb96-509" aria-hidden="true" tabindex="-1"></a>svmModel <span class="ot">&lt;-</span> <span class="fu">train</span>(quality <span class="sc">~</span> ., </span>
<span id="cb96-510"><a href="#cb96-510" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> trainData,</span>
<span id="cb96-511"><a href="#cb96-511" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"svmLinear"</span>,</span>
<span id="cb96-512"><a href="#cb96-512" aria-hidden="true" tabindex="-1"></a>                  <span class="at">trControl =</span> ctrl)</span>
<span id="cb96-513"><a href="#cb96-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-514"><a href="#cb96-514" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test set for each model</span></span>
<span id="cb96-515"><a href="#cb96-515" aria-hidden="true" tabindex="-1"></a>rfPred <span class="ot">&lt;-</span> <span class="fu">predict</span>(rfModel, <span class="at">newdata =</span> testData)</span>
<span id="cb96-516"><a href="#cb96-516" aria-hidden="true" tabindex="-1"></a>svmPred <span class="ot">&lt;-</span> <span class="fu">predict</span>(svmModel, <span class="at">newdata =</span> testData)</span>
<span id="cb96-517"><a href="#cb96-517" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb96-518"><a href="#cb96-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-519"><a href="#cb96-519" aria-hidden="true" tabindex="-1"></a><span class="fu">### Metrics &amp; Variable Importance</span></span>
<span id="cb96-520"><a href="#cb96-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-523"><a href="#cb96-523" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb96-524"><a href="#cb96-524" aria-hidden="true" tabindex="-1"></a><span class="co"># Random Forest confusion matrix</span></span>
<span id="cb96-525"><a href="#cb96-525" aria-hidden="true" tabindex="-1"></a>rfConfMatrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(rfPred, testData<span class="sc">$</span>quality, </span>
<span id="cb96-526"><a href="#cb96-526" aria-hidden="true" tabindex="-1"></a>                                <span class="at">dnn =</span> <span class="fu">c</span>(<span class="st">"Prediction"</span>, <span class="st">"Reference"</span>))</span>
<span id="cb96-527"><a href="#cb96-527" aria-hidden="true" tabindex="-1"></a>rfAccuracy <span class="ot">&lt;-</span> rfConfMatrix<span class="sc">$</span>overall[<span class="st">"Accuracy"</span>]</span>
<span id="cb96-528"><a href="#cb96-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-529"><a href="#cb96-529" aria-hidden="true" tabindex="-1"></a><span class="co"># SVM confusion matrix</span></span>
<span id="cb96-530"><a href="#cb96-530" aria-hidden="true" tabindex="-1"></a>svmConfMatrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(svmPred, testData<span class="sc">$</span>quality, </span>
<span id="cb96-531"><a href="#cb96-531" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">dnn =</span> <span class="fu">c</span>(<span class="st">"Prediction"</span>, <span class="st">"Reference"</span>))</span>
<span id="cb96-532"><a href="#cb96-532" aria-hidden="true" tabindex="-1"></a>svmAccuracy <span class="ot">&lt;-</span> svmConfMatrix<span class="sc">$</span>overall[<span class="st">"Accuracy"</span>]</span>
<span id="cb96-533"><a href="#cb96-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-534"><a href="#cb96-534" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb96-535"><a href="#cb96-535" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Random Forest Accuracy:"</span>, rfAccuracy))</span>
<span id="cb96-536"><a href="#cb96-536" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"SVM Accuracy:"</span>, svmAccuracy))</span>
<span id="cb96-537"><a href="#cb96-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-538"><a href="#cb96-538" aria-hidden="true" tabindex="-1"></a>rfConfMatrix</span>
<span id="cb96-539"><a href="#cb96-539" aria-hidden="true" tabindex="-1"></a>svmConfMatrix</span>
<span id="cb96-540"><a href="#cb96-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-541"><a href="#cb96-541" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Confusion Matrices</span></span>
<span id="cb96-542"><a href="#cb96-542" aria-hidden="true" tabindex="-1"></a>plotCM <span class="ot">&lt;-</span> <span class="cf">function</span>(confMatrix, modelName) {</span>
<span id="cb96-543"><a href="#cb96-543" aria-hidden="true" tabindex="-1"></a>  plt <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(confMatrix<span class="sc">$</span>table)</span>
<span id="cb96-544"><a href="#cb96-544" aria-hidden="true" tabindex="-1"></a>  plt<span class="sc">$</span>Prediction <span class="ot">&lt;-</span> <span class="fu">factor</span>(plt<span class="sc">$</span>Prediction, </span>
<span id="cb96-545"><a href="#cb96-545" aria-hidden="true" tabindex="-1"></a>                           <span class="at">levels =</span> <span class="fu">rev</span>(<span class="fu">levels</span>(plt<span class="sc">$</span>Prediction)))</span>
<span id="cb96-546"><a href="#cb96-546" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb96-547"><a href="#cb96-547" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(plt, <span class="fu">aes</span>(Prediction, Reference, <span class="at">fill =</span> Freq)) <span class="sc">+</span></span>
<span id="cb96-548"><a href="#cb96-548" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>() <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Freq)) <span class="sc">+</span></span>
<span id="cb96-549"><a href="#cb96-549" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"#00859B"</span>) <span class="sc">+</span></span>
<span id="cb96-550"><a href="#cb96-550" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Confusion Matrix -"</span>, modelName),</span>
<span id="cb96-551"><a href="#cb96-551" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Reference"</span>, <span class="at">y =</span> <span class="st">"Prediction"</span>) <span class="sc">+</span></span>
<span id="cb96-552"><a href="#cb96-552" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">levels</span>(testData<span class="sc">$</span>quality)) <span class="sc">+</span></span>
<span id="cb96-553"><a href="#cb96-553" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> <span class="fu">levels</span>(testData<span class="sc">$</span>quality))</span>
<span id="cb96-554"><a href="#cb96-554" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb96-555"><a href="#cb96-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-556"><a href="#cb96-556" aria-hidden="true" tabindex="-1"></a><span class="fu">plotCM</span>(rfConfMatrix, <span class="st">"Random Forest"</span>)</span>
<span id="cb96-557"><a href="#cb96-557" aria-hidden="true" tabindex="-1"></a><span class="fu">plotCM</span>(svmConfMatrix, <span class="st">"SVM"</span>)</span>
<span id="cb96-558"><a href="#cb96-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-559"><a href="#cb96-559" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">varImp</span>(rfModel))</span>
<span id="cb96-560"><a href="#cb96-560" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb96-561"><a href="#cb96-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-562"><a href="#cb96-562" aria-hidden="true" tabindex="-1"></a><span class="fu">## Perform Principal Component Analysis</span></span>
<span id="cb96-563"><a href="#cb96-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-564"><a href="#cb96-564" aria-hidden="true" tabindex="-1"></a><span class="fu">### Part 1</span></span>
<span id="cb96-565"><a href="#cb96-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-568"><a href="#cb96-568" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb96-569"><a href="#cb96-569" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> <span class="fu">select</span>(qualityDs, <span class="sc">-</span>quality)</span>
<span id="cb96-570"><a href="#cb96-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-571"><a href="#cb96-571" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform PCA</span></span>
<span id="cb96-572"><a href="#cb96-572" aria-hidden="true" tabindex="-1"></a>pcaResults <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(ds, <span class="at">scale =</span> T, <span class="at">center =</span> T)</span>
<span id="cb96-573"><a href="#cb96-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-574"><a href="#cb96-574" aria-hidden="true" tabindex="-1"></a><span class="co"># Print PCA summary</span></span>
<span id="cb96-575"><a href="#cb96-575" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pcaResults)</span>
<span id="cb96-576"><a href="#cb96-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-577"><a href="#cb96-577" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize PCA results</span></span>
<span id="cb96-578"><a href="#cb96-578" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_eig</span>(pcaResults, <span class="at">addlabels =</span> <span class="cn">TRUE</span>, <span class="at">kaiser =</span> <span class="cn">TRUE</span>)</span>
<span id="cb96-579"><a href="#cb96-579" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(pcaResults, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">col.ind =</span> qualityDs<span class="sc">$</span>quality, <span class="at">palette =</span> <span class="st">"jco"</span>)</span>
<span id="cb96-580"><a href="#cb96-580" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_biplot</span>(pcaResults, <span class="at">geom =</span> <span class="st">"arrow"</span>, <span class="at">col.var =</span> <span class="st">"contrib"</span>, <span class="at">palette =</span> <span class="st">"jco"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>)</span>
<span id="cb96-581"><a href="#cb96-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-582"><a href="#cb96-582" aria-hidden="true" tabindex="-1"></a>pcaDs <span class="ot">&lt;-</span> <span class="fu">rownames_to_column</span>(<span class="fu">as.data.frame</span>(pcaResults<span class="sc">$</span>rotation))</span>
<span id="cb96-583"><a href="#cb96-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-584"><a href="#cb96-584" aria-hidden="true" tabindex="-1"></a>pcaDs <span class="sc">%&gt;%</span> </span>
<span id="cb96-585"><a href="#cb96-585" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(rowname, PC1, PC2)</span>
<span id="cb96-586"><a href="#cb96-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-587"><a href="#cb96-587" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding back the quality with principal components</span></span>
<span id="cb96-588"><a href="#cb96-588" aria-hidden="true" tabindex="-1"></a>prc <span class="ot">&lt;-</span> <span class="fu">select</span>(qualityDs, quality) <span class="sc">%&gt;%</span></span>
<span id="cb96-589"><a href="#cb96-589" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">as.data.frame</span>(pcaResults<span class="sc">$</span>x)) <span class="sc">%&gt;%</span></span>
<span id="cb96-590"><a href="#cb96-590" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(quality, PC1, PC2) </span>
<span id="cb96-591"><a href="#cb96-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-592"><a href="#cb96-592" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename columns</span></span>
<span id="cb96-593"><a href="#cb96-593" aria-hidden="true" tabindex="-1"></a>prc <span class="ot">&lt;-</span> prc <span class="sc">%&gt;%</span></span>
<span id="cb96-594"><a href="#cb96-594" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb96-595"><a href="#cb96-595" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Quality"</span> <span class="ot">=</span> quality,</span>
<span id="cb96-596"><a href="#cb96-596" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Wine Body"</span> <span class="ot">=</span> PC1,</span>
<span id="cb96-597"><a href="#cb96-597" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Fermentation Characteristics"</span> <span class="ot">=</span> PC2</span>
<span id="cb96-598"><a href="#cb96-598" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb96-599"><a href="#cb96-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-600"><a href="#cb96-600" aria-hidden="true" tabindex="-1"></a>prc2 <span class="ot">&lt;-</span> <span class="fu">select</span>(qualityDs, quality) <span class="sc">%&gt;%</span></span>
<span id="cb96-601"><a href="#cb96-601" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">as.data.frame</span>(pcaResults<span class="sc">$</span>x)) <span class="sc">%&gt;%</span></span>
<span id="cb96-602"><a href="#cb96-602" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(quality, PC1, PC2, PC3, PC4, PC5, PC6, PC7, PC8, PC9, PC10, PC11) </span>
<span id="cb96-603"><a href="#cb96-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-604"><a href="#cb96-604" aria-hidden="true" tabindex="-1"></a>prc2 <span class="ot">&lt;-</span> prc2 <span class="sc">%&gt;%</span></span>
<span id="cb96-605"><a href="#cb96-605" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Quality"</span> <span class="ot">=</span> quality)</span>
<span id="cb96-606"><a href="#cb96-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-607"><a href="#cb96-607" aria-hidden="true" tabindex="-1"></a>prc2</span>
<span id="cb96-608"><a href="#cb96-608" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb96-609"><a href="#cb96-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-610"><a href="#cb96-610" aria-hidden="true" tabindex="-1"></a><span class="fu">### Part 2</span></span>
<span id="cb96-611"><a href="#cb96-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-614"><a href="#cb96-614" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb96-615"><a href="#cb96-615" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2013</span>)</span>
<span id="cb96-616"><a href="#cb96-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-617"><a href="#cb96-617" aria-hidden="true" tabindex="-1"></a>splitIndex <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(prc<span class="sc">$</span>Quality, <span class="at">p =</span> <span class="fl">0.7</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb96-618"><a href="#cb96-618" aria-hidden="true" tabindex="-1"></a>trainData <span class="ot">&lt;-</span> prc[splitIndex, ]</span>
<span id="cb96-619"><a href="#cb96-619" aria-hidden="true" tabindex="-1"></a>testData <span class="ot">&lt;-</span> prc[<span class="sc">-</span>splitIndex, ]</span>
<span id="cb96-620"><a href="#cb96-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-621"><a href="#cb96-621" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Repeated cross-validation</span></span>
<span id="cb96-622"><a href="#cb96-622" aria-hidden="true" tabindex="-1"></a>ctrl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"repeatedcv"</span>, </span>
<span id="cb96-623"><a href="#cb96-623" aria-hidden="true" tabindex="-1"></a>                     <span class="at">number =</span> <span class="dv">5</span>, </span>
<span id="cb96-624"><a href="#cb96-624" aria-hidden="true" tabindex="-1"></a>                     <span class="at">repeats =</span> <span class="dv">3</span>, </span>
<span id="cb96-625"><a href="#cb96-625" aria-hidden="true" tabindex="-1"></a>                     <span class="at">verboseIter =</span> <span class="cn">FALSE</span>)</span>
<span id="cb96-626"><a href="#cb96-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-627"><a href="#cb96-627" aria-hidden="true" tabindex="-1"></a><span class="co"># Train Random Forest</span></span>
<span id="cb96-628"><a href="#cb96-628" aria-hidden="true" tabindex="-1"></a>rfModel <span class="ot">&lt;-</span> <span class="fu">train</span>(Quality <span class="sc">~</span> ., </span>
<span id="cb96-629"><a href="#cb96-629" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> trainData,</span>
<span id="cb96-630"><a href="#cb96-630" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"rf"</span>,</span>
<span id="cb96-631"><a href="#cb96-631" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> ctrl,</span>
<span id="cb96-632"><a href="#cb96-632" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ntree =</span> <span class="dv">200</span>)</span>
<span id="cb96-633"><a href="#cb96-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-634"><a href="#cb96-634" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test set for each model</span></span>
<span id="cb96-635"><a href="#cb96-635" aria-hidden="true" tabindex="-1"></a>rfPred <span class="ot">&lt;-</span> <span class="fu">predict</span>(rfModel, <span class="at">newdata =</span> testData)</span>
<span id="cb96-636"><a href="#cb96-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-637"><a href="#cb96-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-638"><a href="#cb96-638" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Confusion Matrices</span></span>
<span id="cb96-639"><a href="#cb96-639" aria-hidden="true" tabindex="-1"></a>plotCM <span class="ot">&lt;-</span> <span class="cf">function</span>(confMatrix, modelName) {</span>
<span id="cb96-640"><a href="#cb96-640" aria-hidden="true" tabindex="-1"></a>  plt <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(confMatrix<span class="sc">$</span>table)</span>
<span id="cb96-641"><a href="#cb96-641" aria-hidden="true" tabindex="-1"></a>  plt<span class="sc">$</span>Prediction <span class="ot">&lt;-</span> <span class="fu">factor</span>(plt<span class="sc">$</span>Prediction, </span>
<span id="cb96-642"><a href="#cb96-642" aria-hidden="true" tabindex="-1"></a>                           <span class="at">levels =</span> <span class="fu">rev</span>(<span class="fu">levels</span>(plt<span class="sc">$</span>Prediction)))</span>
<span id="cb96-643"><a href="#cb96-643" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb96-644"><a href="#cb96-644" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(plt, <span class="fu">aes</span>(Prediction, Reference, <span class="at">fill =</span> Freq)) <span class="sc">+</span></span>
<span id="cb96-645"><a href="#cb96-645" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>() <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Freq)) <span class="sc">+</span></span>
<span id="cb96-646"><a href="#cb96-646" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"#00859B"</span>) <span class="sc">+</span></span>
<span id="cb96-647"><a href="#cb96-647" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Confusion Matrix -"</span>, modelName),</span>
<span id="cb96-648"><a href="#cb96-648" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Reference"</span>, <span class="at">y =</span> <span class="st">"Prediction"</span>) <span class="sc">+</span></span>
<span id="cb96-649"><a href="#cb96-649" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">levels</span>(testData<span class="sc">$</span>Quality)) <span class="sc">+</span></span>
<span id="cb96-650"><a href="#cb96-650" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> <span class="fu">levels</span>(testData<span class="sc">$</span>Quality))</span>
<span id="cb96-651"><a href="#cb96-651" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb96-652"><a href="#cb96-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-653"><a href="#cb96-653" aria-hidden="true" tabindex="-1"></a><span class="co"># Random Forest metrics</span></span>
<span id="cb96-654"><a href="#cb96-654" aria-hidden="true" tabindex="-1"></a>rfConfMatrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(rfPred, testData<span class="sc">$</span>Quality, </span>
<span id="cb96-655"><a href="#cb96-655" aria-hidden="true" tabindex="-1"></a>                                <span class="at">dnn =</span> <span class="fu">c</span>(<span class="st">"Prediction"</span>, <span class="st">"Reference"</span>))</span>
<span id="cb96-656"><a href="#cb96-656" aria-hidden="true" tabindex="-1"></a>rfAccuracy <span class="ot">&lt;-</span> rfConfMatrix<span class="sc">$</span>overall[<span class="st">"Accuracy"</span>]</span>
<span id="cb96-657"><a href="#cb96-657" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Random Forest Accuracy:"</span>, rfAccuracy))</span>
<span id="cb96-658"><a href="#cb96-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-659"><a href="#cb96-659" aria-hidden="true" tabindex="-1"></a><span class="fu">plotCM</span>(rfConfMatrix, <span class="st">"Random Forest"</span>)</span>
<span id="cb96-660"><a href="#cb96-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-661"><a href="#cb96-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-662"><a href="#cb96-662" aria-hidden="true" tabindex="-1"></a>rfConfMatrix<span class="sc">$</span>table</span>
<span id="cb96-663"><a href="#cb96-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-664"><a href="#cb96-664" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable Importance</span></span>
<span id="cb96-665"><a href="#cb96-665" aria-hidden="true" tabindex="-1"></a><span class="fu">varImp</span>(rfModel)</span>
<span id="cb96-666"><a href="#cb96-666" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb96-667"><a href="#cb96-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-670"><a href="#cb96-670" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb96-671"><a href="#cb96-671" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2013</span>)</span>
<span id="cb96-672"><a href="#cb96-672" aria-hidden="true" tabindex="-1"></a>splitIndex <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(prc2<span class="sc">$</span>Quality, <span class="at">p =</span> <span class="fl">0.7</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb96-673"><a href="#cb96-673" aria-hidden="true" tabindex="-1"></a>trainData <span class="ot">&lt;-</span> prc2[splitIndex, ]</span>
<span id="cb96-674"><a href="#cb96-674" aria-hidden="true" tabindex="-1"></a>testData <span class="ot">&lt;-</span> prc2[<span class="sc">-</span>splitIndex, ]</span>
<span id="cb96-675"><a href="#cb96-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-676"><a href="#cb96-676" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Repeated cross-validation</span></span>
<span id="cb96-677"><a href="#cb96-677" aria-hidden="true" tabindex="-1"></a>ctrl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"repeatedcv"</span>, </span>
<span id="cb96-678"><a href="#cb96-678" aria-hidden="true" tabindex="-1"></a>                     <span class="at">number =</span> <span class="dv">5</span>, </span>
<span id="cb96-679"><a href="#cb96-679" aria-hidden="true" tabindex="-1"></a>                     <span class="at">repeats =</span> <span class="dv">3</span>, </span>
<span id="cb96-680"><a href="#cb96-680" aria-hidden="true" tabindex="-1"></a>                     <span class="at">verboseIter =</span> <span class="cn">FALSE</span>)</span>
<span id="cb96-681"><a href="#cb96-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-682"><a href="#cb96-682" aria-hidden="true" tabindex="-1"></a><span class="co"># Train Random Forest</span></span>
<span id="cb96-683"><a href="#cb96-683" aria-hidden="true" tabindex="-1"></a>rfModel <span class="ot">&lt;-</span> <span class="fu">train</span>(Quality <span class="sc">~</span> ., </span>
<span id="cb96-684"><a href="#cb96-684" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> trainData,</span>
<span id="cb96-685"><a href="#cb96-685" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"rf"</span>,</span>
<span id="cb96-686"><a href="#cb96-686" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> ctrl,</span>
<span id="cb96-687"><a href="#cb96-687" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ntree =</span> <span class="dv">200</span>)</span>
<span id="cb96-688"><a href="#cb96-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-689"><a href="#cb96-689" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test set for each model</span></span>
<span id="cb96-690"><a href="#cb96-690" aria-hidden="true" tabindex="-1"></a>rfPred <span class="ot">&lt;-</span> <span class="fu">predict</span>(rfModel, <span class="at">newdata =</span> testData)</span>
<span id="cb96-691"><a href="#cb96-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-692"><a href="#cb96-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-693"><a href="#cb96-693" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Confusion Matrices</span></span>
<span id="cb96-694"><a href="#cb96-694" aria-hidden="true" tabindex="-1"></a>plotCM <span class="ot">&lt;-</span> <span class="cf">function</span>(confMatrix, modelName) {</span>
<span id="cb96-695"><a href="#cb96-695" aria-hidden="true" tabindex="-1"></a>  plt <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(confMatrix<span class="sc">$</span>table)</span>
<span id="cb96-696"><a href="#cb96-696" aria-hidden="true" tabindex="-1"></a>  plt<span class="sc">$</span>Prediction <span class="ot">&lt;-</span> <span class="fu">factor</span>(plt<span class="sc">$</span>Prediction, </span>
<span id="cb96-697"><a href="#cb96-697" aria-hidden="true" tabindex="-1"></a>                           <span class="at">levels =</span> <span class="fu">rev</span>(<span class="fu">levels</span>(plt<span class="sc">$</span>Prediction)))</span>
<span id="cb96-698"><a href="#cb96-698" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb96-699"><a href="#cb96-699" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(plt, <span class="fu">aes</span>(Prediction, Reference, <span class="at">fill =</span> Freq)) <span class="sc">+</span></span>
<span id="cb96-700"><a href="#cb96-700" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>() <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Freq)) <span class="sc">+</span></span>
<span id="cb96-701"><a href="#cb96-701" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"#00859B"</span>) <span class="sc">+</span></span>
<span id="cb96-702"><a href="#cb96-702" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Confusion Matrix -"</span>, modelName),</span>
<span id="cb96-703"><a href="#cb96-703" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Reference"</span>, <span class="at">y =</span> <span class="st">"Prediction"</span>) <span class="sc">+</span></span>
<span id="cb96-704"><a href="#cb96-704" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">levels</span>(testData<span class="sc">$</span>Quality)) <span class="sc">+</span></span>
<span id="cb96-705"><a href="#cb96-705" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> <span class="fu">levels</span>(testData<span class="sc">$</span>Quality))</span>
<span id="cb96-706"><a href="#cb96-706" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb96-707"><a href="#cb96-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-708"><a href="#cb96-708" aria-hidden="true" tabindex="-1"></a><span class="co"># Random Forest metrics</span></span>
<span id="cb96-709"><a href="#cb96-709" aria-hidden="true" tabindex="-1"></a>rfConfMatrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(rfPred, testData<span class="sc">$</span>Quality, </span>
<span id="cb96-710"><a href="#cb96-710" aria-hidden="true" tabindex="-1"></a>                                <span class="at">dnn =</span> <span class="fu">c</span>(<span class="st">"Prediction"</span>, <span class="st">"Reference"</span>))</span>
<span id="cb96-711"><a href="#cb96-711" aria-hidden="true" tabindex="-1"></a>rfAccuracy <span class="ot">&lt;-</span> rfConfMatrix<span class="sc">$</span>overall[<span class="st">"Accuracy"</span>]</span>
<span id="cb96-712"><a href="#cb96-712" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Random Forest Accuracy:"</span>, rfAccuracy))</span>
<span id="cb96-713"><a href="#cb96-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-714"><a href="#cb96-714" aria-hidden="true" tabindex="-1"></a><span class="fu">plotCM</span>(rfConfMatrix, <span class="st">"Random Forest"</span>)</span>
<span id="cb96-715"><a href="#cb96-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-716"><a href="#cb96-716" aria-hidden="true" tabindex="-1"></a>rfConfMatrix</span>
<span id="cb96-717"><a href="#cb96-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-718"><a href="#cb96-718" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable Importance</span></span>
<span id="cb96-719"><a href="#cb96-719" aria-hidden="true" tabindex="-1"></a><span class="fu">varImp</span>(rfModel)</span>
<span id="cb96-720"><a href="#cb96-720" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb96-721"><a href="#cb96-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-722"><a href="#cb96-722" aria-hidden="true" tabindex="-1"></a><span class="fu">## Repeat for Grouped Quality Setting (Low, Medium, High)</span></span>
<span id="cb96-723"><a href="#cb96-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-724"><a href="#cb96-724" aria-hidden="true" tabindex="-1"></a><span class="fu">### Setting up data for classification</span></span>
<span id="cb96-725"><a href="#cb96-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-728"><a href="#cb96-728" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb96-729"><a href="#cb96-729" aria-hidden="true" tabindex="-1"></a>groupedQualityDs <span class="ot">&lt;-</span> redWineDs <span class="sc">%&gt;%</span></span>
<span id="cb96-730"><a href="#cb96-730" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>quality)</span>
<span id="cb96-731"><a href="#cb96-731" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb96-732"><a href="#cb96-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-733"><a href="#cb96-733" aria-hidden="true" tabindex="-1"></a><span class="fu">### Train-Test-Split &amp; Cross-Validation Set up</span></span>
<span id="cb96-734"><a href="#cb96-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-737"><a href="#cb96-737" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb96-738"><a href="#cb96-738" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the dataset into training and testing sets</span></span>
<span id="cb96-739"><a href="#cb96-739" aria-hidden="true" tabindex="-1"></a>splitIndex <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(groupedQualityDs<span class="sc">$</span>qualityGroup, <span class="at">p =</span> <span class="fl">0.7</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb96-740"><a href="#cb96-740" aria-hidden="true" tabindex="-1"></a>trainData <span class="ot">&lt;-</span> groupedQualityDs[splitIndex, ]</span>
<span id="cb96-741"><a href="#cb96-741" aria-hidden="true" tabindex="-1"></a>testData <span class="ot">&lt;-</span> groupedQualityDs[<span class="sc">-</span>splitIndex, ]</span>
<span id="cb96-742"><a href="#cb96-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-743"><a href="#cb96-743" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a train control object for repeated cross-validation</span></span>
<span id="cb96-744"><a href="#cb96-744" aria-hidden="true" tabindex="-1"></a>ctrl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"repeatedcv"</span>, </span>
<span id="cb96-745"><a href="#cb96-745" aria-hidden="true" tabindex="-1"></a>                     <span class="at">number =</span> <span class="dv">5</span>, </span>
<span id="cb96-746"><a href="#cb96-746" aria-hidden="true" tabindex="-1"></a>                     <span class="at">repeats =</span> <span class="dv">3</span>, </span>
<span id="cb96-747"><a href="#cb96-747" aria-hidden="true" tabindex="-1"></a>                     <span class="at">verboseIter =</span> <span class="cn">FALSE</span>)</span>
<span id="cb96-748"><a href="#cb96-748" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb96-749"><a href="#cb96-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-750"><a href="#cb96-750" aria-hidden="true" tabindex="-1"></a><span class="fu">### Random Forest and SVM models</span></span>
<span id="cb96-751"><a href="#cb96-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-754"><a href="#cb96-754" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb96-755"><a href="#cb96-755" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2013</span>)</span>
<span id="cb96-756"><a href="#cb96-756" aria-hidden="true" tabindex="-1"></a><span class="co"># Train Random Forest classifier using caret</span></span>
<span id="cb96-757"><a href="#cb96-757" aria-hidden="true" tabindex="-1"></a>rfModel <span class="ot">&lt;-</span> <span class="fu">train</span>(qualityGroup <span class="sc">~</span> ., </span>
<span id="cb96-758"><a href="#cb96-758" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> trainData,</span>
<span id="cb96-759"><a href="#cb96-759" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"rf"</span>,</span>
<span id="cb96-760"><a href="#cb96-760" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> ctrl,</span>
<span id="cb96-761"><a href="#cb96-761" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ntree =</span> <span class="dv">200</span>)</span>
<span id="cb96-762"><a href="#cb96-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-763"><a href="#cb96-763" aria-hidden="true" tabindex="-1"></a><span class="co"># Train Support Vector Machine (SVM) model using caret</span></span>
<span id="cb96-764"><a href="#cb96-764" aria-hidden="true" tabindex="-1"></a>svmModel <span class="ot">&lt;-</span> <span class="fu">train</span>(qualityGroup <span class="sc">~</span> ., </span>
<span id="cb96-765"><a href="#cb96-765" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> trainData,</span>
<span id="cb96-766"><a href="#cb96-766" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"svmRadial"</span>,</span>
<span id="cb96-767"><a href="#cb96-767" aria-hidden="true" tabindex="-1"></a>                  <span class="at">trControl =</span> ctrl)</span>
<span id="cb96-768"><a href="#cb96-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-769"><a href="#cb96-769" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test set for each model</span></span>
<span id="cb96-770"><a href="#cb96-770" aria-hidden="true" tabindex="-1"></a>rfPred <span class="ot">&lt;-</span> <span class="fu">predict</span>(rfModel, <span class="at">newdata =</span> testData)</span>
<span id="cb96-771"><a href="#cb96-771" aria-hidden="true" tabindex="-1"></a>svmPred <span class="ot">&lt;-</span> <span class="fu">predict</span>(svmModel, <span class="at">newdata =</span> testData)</span>
<span id="cb96-772"><a href="#cb96-772" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb96-773"><a href="#cb96-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-774"><a href="#cb96-774" aria-hidden="true" tabindex="-1"></a><span class="fu">### Metrics</span></span>
<span id="cb96-775"><a href="#cb96-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-778"><a href="#cb96-778" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb96-779"><a href="#cb96-779" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Confusion Matrices</span></span>
<span id="cb96-780"><a href="#cb96-780" aria-hidden="true" tabindex="-1"></a>plotCM <span class="ot">&lt;-</span> <span class="cf">function</span>(confMatrix, modelName) {</span>
<span id="cb96-781"><a href="#cb96-781" aria-hidden="true" tabindex="-1"></a>  plt <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(confMatrix<span class="sc">$</span>table)</span>
<span id="cb96-782"><a href="#cb96-782" aria-hidden="true" tabindex="-1"></a>  plt<span class="sc">$</span>Prediction <span class="ot">&lt;-</span> <span class="fu">factor</span>(plt<span class="sc">$</span>Prediction, </span>
<span id="cb96-783"><a href="#cb96-783" aria-hidden="true" tabindex="-1"></a>                           <span class="at">levels =</span> <span class="fu">rev</span>(<span class="fu">levels</span>(plt<span class="sc">$</span>Prediction)))</span>
<span id="cb96-784"><a href="#cb96-784" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb96-785"><a href="#cb96-785" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(plt, <span class="fu">aes</span>(Prediction, Reference, <span class="at">fill =</span> Freq)) <span class="sc">+</span></span>
<span id="cb96-786"><a href="#cb96-786" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>() <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Freq)) <span class="sc">+</span></span>
<span id="cb96-787"><a href="#cb96-787" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"#00859B"</span>) <span class="sc">+</span></span>
<span id="cb96-788"><a href="#cb96-788" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Confusion Matrix -"</span>, modelName),</span>
<span id="cb96-789"><a href="#cb96-789" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Reference"</span>, <span class="at">y =</span> <span class="st">"Prediction"</span>) <span class="sc">+</span></span>
<span id="cb96-790"><a href="#cb96-790" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">levels</span>(testData<span class="sc">$</span>qualityGroup)) <span class="sc">+</span></span>
<span id="cb96-791"><a href="#cb96-791" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> <span class="fu">levels</span>(testData<span class="sc">$</span>qualityGroup))</span>
<span id="cb96-792"><a href="#cb96-792" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb96-793"><a href="#cb96-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-794"><a href="#cb96-794" aria-hidden="true" tabindex="-1"></a><span class="co"># Random Forest metrics</span></span>
<span id="cb96-795"><a href="#cb96-795" aria-hidden="true" tabindex="-1"></a>rfConfMatrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(rfPred, testData<span class="sc">$</span>qualityGroup, </span>
<span id="cb96-796"><a href="#cb96-796" aria-hidden="true" tabindex="-1"></a>                                <span class="at">dnn =</span> <span class="fu">c</span>(<span class="st">"Prediction"</span>, <span class="st">"Reference"</span>))</span>
<span id="cb96-797"><a href="#cb96-797" aria-hidden="true" tabindex="-1"></a>svmConfMatrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(svmPred, testData<span class="sc">$</span>qualityGroup, </span>
<span id="cb96-798"><a href="#cb96-798" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">dnn =</span> <span class="fu">c</span>(<span class="st">"Prediction"</span>, <span class="st">"Reference"</span>))</span>
<span id="cb96-799"><a href="#cb96-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-800"><a href="#cb96-800" aria-hidden="true" tabindex="-1"></a>rfConfMatrix</span>
<span id="cb96-801"><a href="#cb96-801" aria-hidden="true" tabindex="-1"></a>svmConfMatrix</span>
<span id="cb96-802"><a href="#cb96-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-803"><a href="#cb96-803" aria-hidden="true" tabindex="-1"></a><span class="fu">plotCM</span>(rfConfMatrix, <span class="st">"Random Forest"</span>)</span>
<span id="cb96-804"><a href="#cb96-804" aria-hidden="true" tabindex="-1"></a><span class="fu">plotCM</span>(svmConfMatrix, <span class="st">"SVM"</span>)</span>
<span id="cb96-805"><a href="#cb96-805" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb96-806"><a href="#cb96-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-807"><a href="#cb96-807" aria-hidden="true" tabindex="-1"></a><span class="fu">### Look at variable importance</span></span>
<span id="cb96-808"><a href="#cb96-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-811"><a href="#cb96-811" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb96-812"><a href="#cb96-812" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">varImp</span>(rfModel))</span>
<span id="cb96-813"><a href="#cb96-813" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="https://www.quarto.org">
<p>Made with Quarto®</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://chatgpt.com/">
<p>Built with ChatGPT®</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://www.cloudflare.com/">
<p>Hosted with Cloudflare®</p>
</a>
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../../content/privacy/index.html">
<p>Privacy Policy</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../../content/license/index.html">
<p>License</p>
</a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/bcervantesalvarez/">
      <i class="bi bi-linkedin" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/bcervantesalvarez/">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:briancervantesalvarez@gmail.com">
      <i class="bi bi-envelope-fill" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>