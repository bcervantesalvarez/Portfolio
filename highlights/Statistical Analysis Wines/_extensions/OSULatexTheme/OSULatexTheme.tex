% load packages
\usepackage{geometry}
\usepackage{xcolor}
\usepackage{eso-pic}
\usepackage{fancyhdr}
\usepackage{sectsty}
\usepackage{fontspec}
\usepackage{titlesec}
\usepackage{listings} % For code listings
\usepackage{setspace} % Add this line to load the setspace package

% Set line spacing
\setstretch{1.2} % Adjust the value as needed

%% Set page size with a wider right margin
\geometry{a4paper, total={170mm,257mm}, left=20mm, top=20mm, bottom=20mm, right=35mm}

%% Define colors
\definecolor{light}{HTML}{D73F09}
\definecolor{highlight}{HTML}{800080}
\definecolor{dark}{HTML}{330033}

\AddToShipoutPicture{% 
    \AtPageLowerLeft{% 
        \put(\LenToUnit{\dimexpr\paperwidth-2.6cm},26.7cm){% 
            \color{light}\rule{3cm}{3cm}% Adjust the height as needed
        }%
    }%
    % logo
    \AtPageLowerLeft{% start the bar at the bottom right of the page
        \put(\LenToUnit{\dimexpr\paperwidth-2.45cm},27cm){% move it to the top right
            \color{light}\includegraphics[width=2.35cm]{_extensions/OSULatexTheme/logo2.png}
        }%
    }%
}

%% Style the page number
\fancypagestyle{mystyle}{
  \fancyhf{}
  \renewcommand\headrulewidth{3pt}
  \fancyfoot[R]{\fontsize{18}{12}\selectfont\thepage} % Increase the font size by 10pt
  \fancyfootoffset{2.5cm}
}
\setlength{\footskip}{20pt}

%% style the chapter/section fonts
\chapterfont{\color{dark}\fontsize{24}{16.8}\selectfont}
\sectionfont{\color{dark}\fontsize{22}{16.8}\selectfont}
\subsectionfont{\color{dark}\fontsize{18}{16.8}\selectfont}
\titleformat{\subsection}
  {\sffamily\Large\bfseries}{\thesection}{1em}{}[{\titlerule[0.8pt]}]
  
% left align title
\makeatletter
\renewcommand{\maketitle}{\bgroup\setlength{\parindent}{0pt}
\begin{flushleft}
  {\sffamily\huge\textbf{\MakeUppercase{\@title}}} \vspace{0.3cm} \newline
  {\Large {\@subtitle}} \newline
  {\large\@author} \newline
  {\large\today} % Include the full date here
\end{flushleft}\egroup
}
\makeatother


%% Use some custom fonts
\setsansfont{Stratum2}[
    Path=_extensions/OSULatexTheme/Stratum2/,
    Scale=1,
    Extension = .ttf,
    UprightFont=* Medium,
    BoldFont=* Bold,
    ItalicFont=* Regular,
    ]

\setmainfont{Kievit}[
    Path=_extensions/OSULatexTheme/Kievit/,
    Scale=1,
    Extension = .ttf,
    UprightFont=* Regular,
    BoldFont=* Bold,
    ItalicFont=* Black Italic,
    ]