---
title: "Predicting Premium Default (Insurance)"
author: "Brian Cervantes Alvarez"
date: "3-05-2021"
image: default.jpeg
format:
  html:
    toc: true
    toc-location: right
    html-math-method: katex
    page-layout: full
execute: 
  warning: false
  message: false
categories: [R, informative, interactive, plotly]
---

![](default.jpeg)

## Setup

```{r}
library(tidyverse)
library(caret)
library(rpart)
library(tidytext)
library(SnowballC)
test <- read_csv("test.csv")
train <- read_csv("train.csv")
```

## Wrangling

```{r}

#head(train)
#head(test)

ds <- train %>%
  mutate(age_in_years = round(age_in_days/365, 1),
         income_class = factor(case_when(Income > 24000 & Income <= 32000 ~ "24K-32K",
                                  Income > 32000 & Income <= 45000 ~ "32K-45K",
                                  Income > 45000 & Income <= 60000 ~ "45K-60K",
                                  Income > 60000 & Income <= 85000 ~ "60K-85K",
                                  Income > 85000 & Income <= 110000 ~ "85K-110K",
                                  Income > 110000 & Income <= 200000 ~ "110K-200K",
                                  Income > 200000 & Income <= 400000 ~ "200K-400K",
                                  Income > 400000 ~ ">400K"), 
                               levels = c("24K-32K",
                                          "32K-45K",
                                          "45K-60K",
                                          "60K-85K",
                                          "85K-110K",
                                          "110K-200K",
                                          "200K-400K",
                                          ">400K"))) %>%
  select(-application_underwriting_score, -sourcing_channel, - age_in_days)


```
