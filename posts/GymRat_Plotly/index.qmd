---
title: "Do You Like Stretching? I would Reconsider!"
author: "Brian Cervantes Alvarez"
image: gymRat.jpeg
date: "2-24-2023"
format:
  html:
    toc: true
    toc-location: right
    html-math-method: katex
    page-layout: full
    code-fold: true
execute: 
  warning: false
  message: false
categories: [R, informative, interactive, plotly]
---

## Background

Stretching is not a good method of building muscle for several reasons. First, stretching is primarily focused on increasing flexibility and range of motion, rather than building muscle mass or strength. While stretching can help prepare the muscles for exercise and prevent injury, it is not a sufficient method of building muscle. Second, stretching alone does not provide enough resistance or tension on the muscles to stimulate muscle growth. To build muscle, the body needs to be challenged with weight or resistance training. Finally, stretching may actually reduce muscle strength by decreasing muscle activation and power output. While stretching can be a useful addition to a muscle-building routine, it should not be relied upon as the primary method for building muscle mass and strength.



## General Setup

```{r}
#| code-fold: false
#| message: false
#| warning: false
library(tidyverse)
library(tidytext)
library(ggtext)
library(RColorBrewer)
library(extrafont)
library(plotly)
library(htmlwidgets)
#font_import()
loadfonts()


```

## Data Wrangling For Plot 1

```{r}
gymDs <- read_csv("megaGymDataset.csv")

#head(gymDs, 5)
#names(gymDs)

ds <- gymDs %>%
  mutate(ID = ...1,
         Level = factor(Level, levels = c("Beginner", "Intermediate", "Expert")),
         Type = as.factor(Type)) %>%
  select(-...1) %>% 
  drop_na() 


```

## Using Plotly for Plot 1

```{r}
myTheme <- theme(text = element_text(family = "Futura Medium"),
                 plot.margin = margin(0.5, 0.5, 0.5, 0.5, unit = "cm"),
                 plot.title = element_text(size = 15, family = "Futura Condensed ExtraBold"),
                 plot.subtitle = element_text(size = 10, family = "Futura Medium"),
                 strip.text.y = element_text(angle = 0, size = 10, family = "Futura Condensed ExtraBold"),
                 strip.placement = "inside",
                 axis.title.x = element_text(margin = margin(t = 0.5, b = 0.5, unit = "cm")),
                 axis.title.y = element_blank(),
                 axis.text = element_text(size = 9),
                 legend.position = "none",
                 panel.grid.major.y = element_blank())


plotDs <- ds %>% 
  group_by(Type, Level) %>%
  summarize(meanRating = mean(Rating)) %>%
  arrange(Type, meanRating) %>%
  ungroup()

p <- plotDs %>%
  highlight_key(., ~reorder_within(Type, meanRating, Level)) %>%
  ggplot(aes(x = meanRating, 
             y = reorder_within(Type, meanRating, Level),
             fill = fct_reorder(Type, meanRating),
             text = paste0("Rating: ", round(meanRating,2),
                           "<br>Type: ", Type))) +
  geom_col(color = "black") + 
  facet_grid(rows = vars(Level), 
             scales = "free_y", 
             switch = "y", 
             space = "free_y") +
  scale_y_reordered() +
  scale_fill_brewer(palette = "PuBuGn") +
  labs(title = "Ranking Exercise Type According to Experience Level of Individuals",
       x = "Average Rating of Each Exercise Type",
       fill = "Workout Types") + 
  theme_minimal() +
  myTheme 


ggplotly(p, tooltip = "text") %>%
  config(displayModeBar = FALSE) %>%
  highlight(on = "plotly_hover", off = "plotly_doubleclick") %>%
  layout(
    uniformtext=list(minsize=8, mode='hide'),
    margin = list(b = 70, l = 140, r = 140)
  ) 
  
```

## Data Wrangling For Plot 2

```{r}
plotDs2 <- ds %>%
  group_by(BodyPart, Level) %>%
  summarize(meanRating = mean(Rating))

head(plotDs2)
```

## Using  for Plot 2

```{r}
myTheme <- theme(text = element_text(family = "Futura Medium"),
                 plot.margin = margin(0.5, 0.5, 0.5, 0.5, unit = "cm"),
                 plot.title = element_text(size = 15, family = "Futura Condensed ExtraBold"),
                 strip.text.y = element_text(angle = 90, size = 10, family = "Futura Condensed ExtraBold"),
                 strip.placement = "outside",
                 axis.title.x = element_text(margin = margin(t = 0.5, b = 0.5, unit = "cm")),
                 axis.title.y = element_blank(),
                 axis.text = element_text(size = 9),
                 legend.position = "none",
                 panel.grid.major.y = element_blank())






#ggplotly(p)

```
