<!-- assets/html/chat.html -->

<!-- 1) Liquid-Glass SVG Filter Definition -->
<svg xmlns="http://www.w3.org/2000/svg" style="position:absolute; width:0; height:0;">
  <defs>
    <filter id="glass-distortion">
      <feTurbulence type="fractalNoise" baseFrequency="0.015" numOctaves="2" result="noise"/>
      <feDisplacementMap in="SourceGraphic" in2="noise" scale="4"
                        xChannelSelector="R" yChannelSelector="G"/>
    </filter>
  </defs>
</svg>

<!-- Chat Button -->
<button id="openChat" aria-label="Open Chat">
  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
  </svg>
</button>

<!-- Chat Overlay -->
<div id="chatOverlay">
  <div id="chatContainer">
    <!-- Header -->
    <div id="chatHeader">
      <h2>
        <span class="status-indicator"></span>
        Yappify Chat Assistant
      </h2>
      
      <!-- Header Controls Row -->
      <div class="header-controls">
        <!-- Model Selector -->
        <div class="model-selector">
          <button type="button" class="model-selector-btn" id="modelSelectorBtn">
            <svg fill="#FFFFFF" height="25px" width="25px" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="-97.28 -97.28 706.56 706.56" xml:space="preserve" stroke="#FFFFFF" stroke-width="15.872" transform="rotate(0)"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round" stroke="#000000" stroke-width="72.704"> <g> <g> <path d="M510.855,355.115L333.625,20.347c-1.692-3.197-5-5.207-8.615-5.24c-3.154,0.005-6.952,1.918-8.702,5.082l-61.49,111.149 L195.77,20.16c-1.711-3.212-5.048-5.39-8.692-5.39h-0.01c-3.644,0-6.99,2.188-8.692,5.409L1.145,355.031 c-1.615,3.053-1.519,6.6,0.269,9.557c1.779,2.961,4.981,4.643,8.433,4.643h88.615c5.442,0,9.846-4.409,9.846-9.846 c0-5.438-4.404-9.846-9.846-9.846H26.203L187.097,45.79l56.355,106.021L60.309,482.914c-1.692,3.048-1.635,6.617,0.135,9.618 c1.769,3.005,5,4.698,8.481,4.698H433.23c3.452,0,6.663-1.644,8.442-4.606c1.779-2.966,1.875-6.56,0.25-9.613l-41.49-77.962 c-2.558-4.798-8.529-6.608-13.317-4.046c-4.798,2.552-6.625,8.356-4.067,13.159l33.788,63.376H85.626l168.855-305.076 l74.711,140.54c2.548,4.793,8.509,6.653,13.317,4.109c4.798-2.553,6.625-8.494,4.067-13.297l-80.721-151.748l58.875-106.604 l161.066,304.075h-298.72c-5.442,0-9.846,4.409-9.846,9.846c0,5.438,4.404,9.846,9.846,9.846h315.075 c3.452,0,6.654-1.639,8.433-4.601C512.374,361.673,512.47,358.168,510.855,355.115z"></path> </g> </g> </g><g id="SVGRepo_iconCarrier"> <g> <g> <path d="M510.855,355.115L333.625,20.347c-1.692-3.197-5-5.207-8.615-5.24c-3.154,0.005-6.952,1.918-8.702,5.082l-61.49,111.149 L195.77,20.16c-1.711-3.212-5.048-5.39-8.692-5.39h-0.01c-3.644,0-6.99,2.188-8.692,5.409L1.145,355.031 c-1.615,3.053-1.519,6.6,0.269,9.557c1.779,2.961,4.981,4.643,8.433,4.643h88.615c5.442,0,9.846-4.409,9.846-9.846 c0-5.438-4.404-9.846-9.846-9.846H26.203L187.097,45.79l56.355,106.021L60.309,482.914c-1.692,3.048-1.635,6.617,0.135,9.618 c1.769,3.005,5,4.698,8.481,4.698H433.23c3.452,0,6.663-1.644,8.442-4.606c1.779-2.966,1.875-6.56,0.25-9.613l-41.49-77.962 c-2.558-4.798-8.529-6.608-13.317-4.046c-4.798,2.552-6.625,8.356-4.067,13.159l33.788,63.376H85.626l168.855-305.076 l74.711,140.54c2.548,4.793,8.509,6.653,13.317,4.109c4.798-2.553,6.625-8.494,4.067-13.297l-80.721-151.748l58.875-106.604 l161.066,304.075h-298.72c-5.442,0-9.846,4.409-9.846,9.846c0,5.438,4.404,9.846,9.846,9.846h315.075 c3.452,0,6.654-1.639,8.433-4.601C512.374,361.673,512.47,358.168,510.855,355.115z"></path> </g> </g> </g></svg>
            <span id="currentModelName">Yappify 1.0</span>
            <svg class="dropdown-arrow" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
              <polyline points="6,9 12,15 18,9"></polyline>
            </svg>
          </button>
          
          <div class="model-dropdown" id="modelDropdown">
            <div class="model-info-row">
              <span class="model-dropdown-title">Models</span>
              <div class="model-info-tooltip-wrapper">
                <a href="/assets/html/llm/model-info.html" target="_blank" class="model-info-link">
                    <svg class="model-info-icon"
                        id="modelInfoBtn"
                        width="16" height="16"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                        stroke-linecap="round"
                        stroke-linejoin="round">
                      <circle cx="12" cy="12" r="10"/>
                      <line x1="12" y1="16" x2="12" y2="12"/>
                      <line x1="12" y1="8" x2="12" y2="8"/>
                    </svg>
                    <span class="model-info-tooltip-text">Learn more</span>
                  </a>
              </div>
            </div>
            
            <div class="model-option active" data-model="local">
              <div class="model-info">
                <div class="model-name">Yappify-1.0 (RAG)</div>
              </div>
            </div>
            
            <div class="model-option" data-model="qwen">
              <div class="model-info">
                <div class="model-name">Qwen-2.5 (1.5B)</div>
              </div>
            </div>

            <div class="model-option" data-model="qwen3">
              <div class="model-info">
                <div class="model-name">Qwen-3 (0.6B)</div>
              </div>
            </div>

            <div class="model-option" data-model="llama">
              <div class="model-info">
                <div class="model-name">Llama-3.2 (1B)</div>
              </div>
            </div>


            <div class="model-option" data-model="phi">
              <div class="model-info">
                <div class="model-name"> Phi-3.5 Mini</div>
              </div>
            </div>


            <div class="model-option" data-model="smol">
              <div class="model-info">
                <div class="model-name">SmolLM2 (360M)</div>
              </div>
            </div>

          </div>
        </div>

        <!-- Tools Selector -->
        <div class="tools-selector">
          <button type="button" class="tools-selector-btn" id="toolsSelectorBtn">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/>
            </svg>
            <span>Tools</span>
            <svg class="dropdown-arrow" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
              <polyline points="6,9 12,15 18,9"></polyline>
            </svg>
          </button>
          
          <div class="tools-dropdown" id="toolsDropdown">
            <div class="tool-option" data-action="new-chat">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
                <line x1="12" y1="8" x2="12" y2="16"/>
                <line x1="8" y1="12" x2="16" y2="12"/>
              </svg>
              <div class="tool-info">
                <div class="tool-name">New Chat</div>
              </div>
            </div>
            
            <!-- Updated Export Tool Option with Professional Submenu -->
            <div class="tool-option" data-action="export-chat">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="7 10 12 15 17 10"></polyline>
                <line x1="12" y1="15" x2="12" y2="3"></line>
              </svg>
              <div class="tool-info">
                <div class="tool-name">Export Chat</div>
              </div>
              
              <!-- Professional Export Submenu -->
              <div class="export-submenu">
                <div class="export-format" data-format="json">
                  <div class="format-icon json-icon">.json</div>
                  <div class="format-details">
                  </div>
                </div>
                
                <div class="export-format" data-format="csv">
                  <div class="format-icon csv-icon">.csv</div>
                  <div class="format-details">
                  </div>
                </div>
              </div>
            </div>
            
            <div class="tool-option disabled" data-action="search-website">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="11" cy="11" r="8"/>
                <path d="m21 21-4.35-4.35"/>
              </svg>
              <div class="tool-info">
                <div class="tool-name">Search</div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Close Button -->
      <button id="closeChat" aria-label="Close Chat">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>

    <!-- Chat Log -->
    <div id="chatLog">
      <!-- Messages will be added here dynamically -->
    </div>

    <!-- Chat Input Form -->
    <form id="chatForm">
      <div class="input-container">
        <textarea 
          id="chatInput" 
          placeholder="Type your message..." 
          rows="1"
          maxlength="1000"
          required
        ></textarea>
        <button type="submit" id="sendButton" aria-label="Send Message">
          <svg fill="#FFFFFF" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M11 8.414V18h2V8.414l4.293 4.293 1.414-1.414L12 4.586l-6.707 6.707 1.414 1.414z"></path></g></svg>
        </button>
      </div>
      <!-- Warning text will be added dynamically -->
    </form>

    <!-- Chat Footer -->
    <div id="chatFooter">
      Yappify can make mistakes. Please double-check responses.
    </div>

  </div>
</div>

<!-- Chat Styles -->
<link rel="stylesheet" href="/assets/llm/chat.css" />

<!-- Modular JavaScript -->
<script type="module" src="/assets/llm/chat-config.js"></script>
<script type="module" src="/assets/llm/chat-ui.js"></script>
<script type="module" src="/assets/llm/chat-local.js"></script>
<script type="module" src="/assets/llm/chat-models.js"></script>
<script type="module" src="/assets/llm/chat-rag.js"></script>
<script type="module" src="/assets/llm/chat-main.js"></script>