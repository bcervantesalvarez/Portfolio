{
  "hash": "ca05fddce1e6ada37768b99b55ad9d71",
  "result": {
    "markdown": "---\ntitle: 'The Impact of Smoking on Health Insurance Premiums: Unveiling the True Costs'\ndescription: 'In this captivating investigation, we dive deep into the impact of smoking habits on medical insurance expenses, carefully examining the nuanced differences between genders, including both smokers and non-smokers.'\nauthor: Brian Cervantes Alvarez\ndate: '2022-07-14'\nimage: health_ins.jpeg\nformat:\n  html:\n    page-layout: full\n    toc: true\n    toc-location: right\n    html-math-method: katex\noutput: html_document\nexecute:\n  message: false\n  warning: false\ncategories:\n  - Python\n  - Statistics\n  - Jupyter Notebook\n  - Data Visualization\n---\n\n![](health_ins.jpeg)\n\n## Abstract:\n\nThis study confirms the significant impact of smoking on the escalation of health insurance premiums. Male and female smokers with a body mass index (BMI) of 30 or higher face additional charges, compounding their financial burden. Male smokers experience a 52% increase, while female smokers face a 49% rise in insurance charges, in addition to the base premium for smokers.\n\nThe severity of the situation is evident, as male smokers pay 408.57% more than non-smokers, and female smokers pay 350.12% more. The data unequivocally supports the notion that unhealthy lifestyle choices, such as smoking and high BMI, result in higher health insurance premiums. It is important to note that premiums also increase gradually over time with age.\n\nWhile this project provides valuable insights, further exploration opportunities exist. Applying machine learning techniques to assess the representativeness of the sample could enhance the accuracy of conclusions and foster advancements in the field of health insurance.\n\n### Data Setup and Import\n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nfrom scipy import stats\n\n#read in the csv file\ndf = pd.read_csv('insurance.csv')\nprint(df.head())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   age     sex     bmi  children smoker     region      charges\n0   19  female  27.900         0    yes  southwest  16884.92400\n1   18    male  33.770         1     no  southeast   1725.55230\n2   28    male  33.000         3     no  southeast   4449.46200\n3   33    male  22.705         0     no  northwest  21984.47061\n4   32    male  28.880         0     no  northwest   3866.85520\n```\n:::\n:::\n\n\n## Analysis of Factors Affecting Insurance Costs:\n\nThe objective of this analysis is to identify the factors influencing insurance costs and determine their impact on individuals' financial burden. Specifically, we investigate the relationship between smoking habits and increased medical insurance expenses.\n\nInitially, we examine the prevalence of smoking within the dataset. Subsequently, we conduct a comprehensive assessment of the distribution of charges among smokers, employing visual aids like box plots to illustrate quartiles and identify any outliers. Statistical measures, including minimum, maximum, mean, and median, are then employed to provide a more comprehensive understanding of the data.\n\nFurthermore, we conduct a gender-based analysis to ascertain if there are notable differences in expenses between male and female smokers. This allows us to evaluate any significant variations in insurance costs based on gender.\n\n### Histogram Plot of Smokers vs Nonsmokers\n\n-   Smoker Count: 274\n-   Nonsmoker Count: 1064\n\nTo visually illustrate the distribution of smokers and nonsmokers within the dataset, a histogram plot was generated. The plot showcases the count of individuals categorized as smokers or nonsmokers. The number of smokers is 274, while the count of nonsmokers is 1064.\n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\n#while a histogram is not necessary, it can really show in the visual count of smokers vs nonsmokers\nplt.figure(figsize = (8, 6))\nsns.set(font_scale = 1.5)\nsns.histplot(df.smoker)\nplt.title('Smoker vs Nonsmoker Count')\n\nplt.tight_layout(pad = 2)\nplt.show()\nplt.clf()\n\n#num_smokers = df.smoker.value_counts()['yes']\n#num_nonsmokers = df.smoker.value_counts()['no']\n#print(\"Exact number of smokers: {num_smokers}\".format(num_smokers = num_smokers))\n#print(\"Exact number of nonsmokers: {num_nonsmokers}\".format(num_nonsmokers = num_nonsmokers))\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-3-output-1.png){width=691 height=498}\n:::\n\n::: {.cell-output .cell-output-display}\n```\n<Figure size 672x480 with 0 Axes>\n```\n:::\n:::\n\n\n### Boxplot and Histogram Distribution of Insurance Costs for Smokers\n\nUpon analyzing the insurance costs specifically for smokers, a boxplot and histogram were constructed. The interquartile range indicates a substantial spread of \\$20,125.33 between the first and third quartiles.\n\nNotably, the distribution of insurance costs for smokers exhibits a bimodal pattern, suggesting the presence of a contributing factor that significantly impacts insurance expenses. Further investigation is required to identify the specific variable responsible for the observed increase in insurance costs among smokers. Potential factors to consider include region, BMI, sex, number of children, and age.\n\n::: {.cell execution_count=3}\n``` {.python .cell-code}\ndf_smokers = df[df.smoker == 'yes']\n#print(df_smokers.head())\nsns.set(font_scale = 0.8)\nIQR = stats.iqr(df_smokers.charges, interpolation = 'midpoint')\n#print(round(IQR,2))\n\nfig, (ax1, ax2) = plt.subplots(1,2,figsize=(8,6))\n#boxplot\nsns.boxplot(y = df_smokers.charges, ax = ax1)\nax1.set_ylabel('Insurance cost (USD)')\nax1.set_title('Insurance Cost Boxplot for Smokers')\n\n#histogram\nsns.histplot(df_smokers.charges, bins = 40, ax = ax2)\nax2.set_xlabel('Insurance Cost (USD)')\nax2.set_title('Insurance Cost Distribution for Smokers')\n\nplt.tight_layout(pad = 3)\n\nplt.show()\nplt.clf()\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-4-output-1.png){width=710 height=520}\n:::\n\n::: {.cell-output .cell-output-display}\n```\n<Figure size 672x480 with 0 Axes>\n```\n:::\n:::\n\n\n### Insurance Cost Statistics for Smokers\n\nSummary Stats:\n\n- Mean: $32,050.23\n- Median: $34,456.35\n- Max: $63,770.43\n- Min: $12,829.46\n- Standard Deviation: $11,520.47\n- Variance: 132,721,153.14\n\n::: {.cell execution_count=4}\n``` {.python .cell-code}\n#find mean of insurance cost for smokers\nsmoker_mean = round(np.mean(df_smokers.charges), 2)\n#print('The average insurance cost for being a smoker: ${mean}'.format(mean = smoker_mean))\n\n#find median of insurance cost for smokers\nsmoker_median = round(np.median(df_smokers.charges), 2)\n#print('The median insurance cost for being a smoker: ${median}'.format(median = smoker_median))\n\n#find standard deviation...\nsmoker_std = round(np.std(df_smokers.charges),2)\n#print('The standard deviation is: ${std}'.format(std = smoker_std))\n\n#let's see the variance\nsmoker_var = round(np.var(df_smokers.charges),2)\n#print('The variance is: {var}'.format(var = smoker_var))\n\n#maximum cost\nsmoker_max = round(np.max(df_smokers.charges), 2)\n#print('The maximum insurance cost for being a smoker is: ${max}'.format(max = smoker_max))\n\n#minimum cost\nsmoker_min = round(np.min(df_smokers.charges), 2)\n#print('The minimum insurance cost for being a smoker is: ${min}'.format(min = smoker_min))\n```\n:::\n\n\nThe summary statistics provide valuable insights into the distribution of insurance costs for smokers. The mean insurance cost for smokers is calculated to be $32,050.23, representing the average expense in this category. The median insurance cost, at $34,456.35, serves as the central value around which the data is evenly distributed.\n\nAdditionally, the maximum observed insurance cost for smokers is $63,770.43, indicating the highest expense recorded within this group. Conversely, the minimum cost stands at $12,829.46, representing the lowest recorded expense.\n\nThe standard deviation of $11,520.47 measures the degree of variability or dispersion among the insurance costs for smokers. Furthermore, the variance of 132,721,153.14 quantifies the average squared deviation from the mean.\n\nThese statistical measures provide a comprehensive overview of the distribution of insurance costs for smokers, enabling a better understanding of the financial implications associated with smoking.\n\n\n### Separation of Male and Female Smokers:\n\nTo examine potential differences in insurance costs, a segmentation analysis was conducted, specifically focusing on male and female smokers. This approach aims to discern any notable variations in expenses between the two genders.\n\nThe analysis reveals significant insights, as demonstrated in the accompanying graphs. It becomes evident that the primary contributor to the observed bimodal distribution is the BMI (Body Mass Index). Notably, when the BMI reaches or exceeds 30, which falls within the obese category, a substantial increase in insurance costs occurs. This finding highlights the compounding effect of both obesity and smoking on medical insurance expenses.\n\nFurthermore, it is worth noting that insurance costs gradually increase as age advances. This correlation aligns with the expected progression of health issues that typically arise with aging. Consequently, there is a gradual rise in insurance costs as individuals age, reflecting the natural occurrence of age-related health conditions.\n\nThis segmentation analysis underscores the interplay between gender, BMI, age, and insurance costs, providing valuable insights for the medical industry in understanding the multifaceted factors that influence insurance expenses.\n\n### Analysis of Male Smokers:\n\nGraph One: Cost Distribution\nThe distribution of insurance costs for male smokers exhibits a bimodal pattern, indicating the presence of two distinct clusters. This suggests the influence of an underlying variable that contributes to the observed cost disparity.\n\nGraph Two: Average Cost per Child\nThe bar plot showcasing the average insurance costs per child does not reveal any clear trends. However, it is noteworthy that individuals with four children tend to have a slightly lower average insurance cost.\n\nGraph Three: Cost vs BMI with Region\nThe scatterplot depicting insurance cost against BMI, considering different regions, demonstrates a visible linear relationship. The plot shows two clusters of individuals, but both clusters follow the same linear pattern. Notably, when the BMI reaches or exceeds 30 (indicating obesity), there is a significant and distinct increase in insurance costs for male smokers. It is important to note that BMI is not always an ideal measurement; however, in this analysis, it serves as an indicator of obesity. No notable trends were observed concerning the region.\n\nGraph Four: Cost vs Age with Children\nThe scatterplot illustrating insurance cost against age, accounting for the presence of children, exhibits a linear trend split into two distinct clusters. This finding suggests that the observed difference is likely attributed to variations in BMI among individuals. As expected, insurance costs tend to increase gradually over time.\n\nGraph Five: Average Cost per Region\nThe bar plot representing the average insurance costs per region does not yield any significant insights.\n\nGraph Six: Boxplot of Male Smoker Insurance Cost\nThe boxplot provides valuable visual information regarding the spread of insurance costs among male smokers. It allows for a better understanding of the distribution and variability within this group.\n\nThese analyses shed light on the various factors impacting insurance costs for male smokers, including BMI, age, and the presence of children. By comprehensively examining these relationships, the medical industry can gain valuable insights to inform decision-making and enhance understanding of cost dynamics.\n\n::: {.cell execution_count=5}\n``` {.python .cell-code}\n#seperate all male smokers from the main data set\ndf_male_smoker = df_smokers[df_smokers.sex == 'male']\ndf_nonsmokers = df[df.smoker == 'no']\n#print(df_nonsmokers.head())\n#print(df_male_smoker.head())\n\nfig, ax = plt.subplots(2,3,figsize=(10,6))\nsns.set_style('darkgrid')\nsns.set(font_scale = 0.5)\n\n#histogram male smoker\nsns.histplot(df_male_smoker.charges, bins = 40, ax = ax[0,0])\nax[0,0].set_title('Male Smoker Insurance Cost Distribution')\nax[0,0].set_xlabel('Insurnance Cost (USD)')\n\n#barplot for insurance cost of male smokers per child\ndf_children = df_male_smoker.groupby('children').mean().reset_index()\n#print(df_children.head())\n\nsns.barplot(x = df_children.children, y = df_children.charges, ax = ax[0,1])\nax[0,1].set_title('Average Male Smoker Insurance Cost Per Child')\nax[0,1].set_xlabel('Number of Children')\nax[0,1].set_ylabel('Insurance Cost (USD)')\n\n#scatterplot for insurance cost of male smokers by BMI\nsns.scatterplot(x = df_male_smoker.bmi, y = df_male_smoker.charges,\n                hue = df_male_smoker.region,\n                size = df_male_smoker.region,\n                sizes = (7.5, 25), ax = ax[0,2])\nax[0,2].axvline(x = 30, color = 'gray', label = 'Obese BMI')\nax[0,2].set_title('Male Smoker Insurance Cost vs BMI')\nax[0,2].set_xlabel('BMI')\nax[0,2].set_ylabel('Insurance Costs (USD)')\n\n#scatterplot for insurance cost of male smokers by age\nsns.scatterplot(x = df_male_smoker.age, y = df_male_smoker.charges,\n                hue = df_male_smoker.children,\n                size = df_male_smoker.children, sizes = (12.5,25),\n                ax = ax[1,0])\nax[1,0].set_title('Male Smoker Insurance Cost vs Age')\nax[1,0].set_xlabel('Age')\nax[1,0].set_ylabel('Insurance Costs (USD)')\n\n#barplot for insurance cost of male smokers per region\ndf_region = df_male_smoker.groupby('region').mean().reset_index()\n#print(df_region.head())\n\nsns.barplot(x = df_region.region,  y = df_region.charges, ax = ax[1,1])\nax[1,1].set_title('Average Male Smoker Insurance Cost Per Region')\nax[1,1].set_xlabel('Region')\nax[1,1].set_ylabel('Insurance Cost (USD)')\n\n#boxplot of male smoker boxplot\nsns.boxplot(x = df_male_smoker.charges, ax = ax[1,2])\nax[1,2].set_title('Male Smoker Insurance Cost Boxplot')\nax[1,2].set_xlabel('Insurance Cost (USD)')\n\nplt.tight_layout(pad = 4)\n\nplt.show()\nplt.clf()\n\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-6-output-1.png){width=915 height=533}\n:::\n\n::: {.cell-output .cell-output-display}\n```\n<Figure size 672x480 with 0 Axes>\n```\n:::\n:::\n\n\n### Analysis of Male Smokers: Highlighting BMI\n\nAs previously mentioned, the presence of two clusters in the cost distribution of male smokers can be attributed to variations in BMI. Notably, male smokers with a BMI greater than or equal to 30 experience a significant increase in expenses, approximately 47%, compared to their counterparts with a lower BMI. This finding underscores the impact of obesity on insurance costs for male smokers in the medical industry.\n\n::: {.cell execution_count=6}\n``` {.python .cell-code}\n#highlight BMI graph\nplt.figure(figsize = (8, 6))\nsns.scatterplot(x = df_male_smoker.bmi, y = df_male_smoker.charges,\n                hue = df_male_smoker.region,\n                size = df_male_smoker.region,\n                sizes = (7.5, 25))\nplt.axvline(x = 30, color = 'gray', label = 'Obese BMI')\nplt.title('Male Smoker Insurance Cost vs BMI')\nplt.xlabel('BMI')\nplt.ylabel('Insurance Costs (USD)')\n```\n\n::: {.cell-output .cell-output-display execution_count=6}\n```\nText(0, 0.5, 'Insurance Costs (USD)')\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-7-output-2.png){width=660 height=509}\n:::\n:::\n\n\n::: {.cell execution_count=7}\n``` {.python .cell-code}\n#analyze BMI < 30\n\nmale_df_bmi = df_male_smoker[df_male_smoker.bmi < 30]\nmale_avg_cost = round(np.mean(male_df_bmi.charges, axis = 0),2)\n#print(\"The average insurance cost for male smokers with a BMI of less than 30 equates to: ${charge}\".format(charge = male_avg_cost))\n\n#analyze BMI >= 30\n\nmale_df2_bmi = df_male_smoker[df_male_smoker.bmi >= 30]\nmale_avg_cost_2 = round(np.mean(male_df2_bmi.charges, axis = 0),2)\n#print(\"The average insurance cost for male smokers with a BMI of greater than or equal to 30 equates to: ${charge}\".format(charge = male_avg_cost_2))\n\n#Difference of Insurance Cost\nmale_diff_cost = male_avg_cost_2 - male_avg_cost\n#print(\"The difference in insurance cost from being at or over 30 BMI compared to being under 30 BMI for males is: ${diff}\".format(diff = male_diff_cost))\n\nmale_diff_cost_percent = 100*round(male_diff_cost / male_avg_cost_2, 2)\n#print('A male smoker will suffer an increase of {percent}% in their insurance cost by being obese (BMI >= 30)'.format(percent = male_diff_cost_percent))\n```\n:::\n\n\n### The analysis of female smokers reveals the following insights:\n\nCost Distribution: Similar to the previous analysis, there is a bimodal distribution in the insurance cost for female smokers, indicating the presence of underlying factors contributing to the cost variations.\n\nAverage Cost per Child: The barplot does not show a clear trend between the number of children and the average insurance cost for female smokers. However, it is worth noting that having five children seems to be associated with a slightly lower average insurance cost.\n\nScatterplot of Cost vs BMI with Region: The scatterplot demonstrates a visible linear relationship between BMI and insurance cost for female smokers. There are two clusters of individuals, but they both follow the linear relationship. Notably, when the BMI is greater than or equal to 30 (indicating obesity), there is a significant increase in insurance cost for female smokers. It is important to consider that BMI may not be a perfect measurement of obesity (as discussed in the results). No specific trends are observed with respect to the region.\n\nScatterplot of Cost vs Age with Children: The scatterplot shows a linear trend in insurance cost based on age, but it is split into two linear clusters. This finding aligns with the earlier observation that differences in BMI among individuals may contribute to the clusters. As expected, insurance cost gradually increases over time.\n\nAverage Cost per Region: The barplot of average cost per region does not provide any valuable insights for female smokers.\n\nBoxplot of Female Smoker Insurance Cost: The boxplot displays the spread of insurance cost among female smokers, highlighting the range of variation in costs.\n\nOverall, the analysis of female smokers provides insights into the relationship between factors such as BMI, age, and insurance cost.\n\n::: {.cell execution_count=8}\n``` {.python .cell-code}\n#seperate all female smokers from the main data set\ndf_female_smoker = df_smokers[df_smokers.sex == 'female']\n\nfig, ax = plt.subplots(2,3,figsize=(10,6))\nsns.set_style('darkgrid')\nsns.set(font_scale = 0.5)\n\n#histogram male smoker\nsns.histplot(df_female_smoker.charges, bins = 40, ax = ax[0,0])\nax[0,0].set_title('Female Smoker Insurance Cost Distribution')\nax[0,0].set_xlabel('Insurnance Cost (USD)')\n\n#barplot for insurance cost of female smokers per child\ndf_children = df_female_smoker.groupby('children').mean().reset_index()\n#print(df_children.head())\n\nsns.barplot(x = df_children.children, y = df_children.charges, ax = ax[0,1])\nax[0,1].set_title('Average Female Smoker Insurance Cost Per Child')\nax[0,1].set_xlabel('Number of Children')\nax[0,1].set_ylabel('Insurance Cost (USD)')\n\n#scatterplot for insurance cost of female smokers by BMI\nsns.scatterplot(x = df_female_smoker.bmi, y = df_female_smoker.charges,\n                hue = df_female_smoker.region,\n                size = df_female_smoker.region,\n                sizes = (7.5, 25), ax = ax[0,2])\nax[0,2].axvline(x = 30, color = 'gray', label = 'Obese BMI')\nax[0,2].set_title('Female Smoker Insurance Cost vs BMI')\nax[0,2].set_xlabel('BMI')\nax[0,2].set_ylabel('Insurance Costs (USD)')\n\n#scatterplot for insurance cost of female smokers by age\nsns.scatterplot(x = df_female_smoker.age, y = df_female_smoker.charges,\n                hue = df_female_smoker.children,\n                size = df_female_smoker.children,\n                sizes = (12.5, 25), ax = ax[1,0])\nax[1,0].set_title('Female Smoker Insurance Cost vs Age')\nax[1,0].set_xlabel('Age')\nax[1,0].set_ylabel('Insurance Costs (USD)')\n\n#barplot for insurance cost of female smokers per region\ndf_region = df_female_smoker.groupby('region').mean().reset_index()\n#print(df_region.head())\n\nsns.barplot(x = df_region.region,  y = df_region.charges, ax = ax[1,1])\nax[1,1].set_title('Average. Female Smoker Insurance Cost Per Region')\nax[1,1].set_xlabel('Region')\nax[1,1].set_ylabel('Insurance Cost (USD)')\n\n#boxplot of female smoker age vs bmi\nsns.boxplot(x = df_female_smoker.charges, ax = ax[1,2])\nax[1,2].set_title('Female Smoker Insurance Cost Boxplot')\nax[1,2].set_xlabel('Insurance Cost (USD)')\n\nplt.tight_layout(pad = 4)\nplt.show()\nplt.clf()\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-9-output-1.png){width=916 height=534}\n:::\n\n::: {.cell-output .cell-output-display}\n```\n<Figure size 672x480 with 0 Axes>\n```\n:::\n:::\n\n\nThe analysis of female smokers reveals findings that align with the observations made for male smokers. Specifically, the relationship between insurance cost and BMI for female smokers follows a similar pattern as observed in male smokers. Therefore, the conclusions drawn from the previous analysis regarding the impact of BMI on insurance cost can be applied to female smokers as well.\n\n::: {.cell execution_count=9}\n``` {.python .cell-code}\n#analyze BMI < 30\n\nfemale_df_bmi = df_female_smoker[df_female_smoker.bmi < 30]\nfemale_avg_cost = round(np.mean(female_df_bmi.charges, axis = 0),2)\n#print(\"The average insurance cost for female smokers with a BMI of less than 30 equates to: ${charge}\".format(charge = female_avg_cost))\n\n#analyze BMI >= 30\n\nfemale_df2_bmi = df_female_smoker[df_female_smoker.bmi >= 30]\nfemale_avg_cost_2 = round(np.mean(female_df2_bmi.charges, axis = 0),2)\n#print(\"The average insurance cost for female smokers with a BMI of greater than or equal to 30 equates to: ${charge}\".format(charge = female_avg_cost_2))\n\n#Difference of Insurance Cost\nfemale_diff_cost = female_avg_cost_2 - female_avg_cost\n#print(\"The difference in cost from being at or over 30 BMI compared to being under 30 BMI for females is: ${diff}\".format(diff = female_diff_cost))\n```\n:::\n\n\n### Comparing Average Insurance Costs: Male vs. Female Smokers\n\nWhen comparing the average insurance costs of male and female smokers, some notable observations emerge. Among smokers with a BMI below 30, male smokers pay approximately 1.34% more than their female counterparts. However, for smokers with a BMI of 30 or higher, male smokers pay approximately 1.42% less than their female counterparts. These findings indicate a gender-based variation in insurance costs, influenced by both BMI and smoking status.\n\n::: {.cell execution_count=10}\n``` {.python .cell-code}\n#Plot average insurance cost for male and female \ndf_bmi_less_than_30 = df_smokers[df_smokers.bmi < 30]\ndf_one = df_bmi_less_than_30.groupby('sex').mean().reset_index()\n\n#Get value\nmale_bmi_less_than_30 = df_one[df_one.sex == 'male'].charges.sum()\nfemale_bmi_less_than_30 = df_one[df_one.sex == 'female'].charges.sum()\n#print value\n\nmale_female_sum = male_bmi_less_than_30 + female_bmi_less_than_30\npor_male_less_30 = male_bmi_less_than_30 / male_female_sum\npor_female_less_30 = female_bmi_less_than_30 / male_female_sum\n\n\ndiff_por = round((por_male_less_30 - por_female_less_30), 4) * 100\n#print(\"Male smokers are expected to pay approximately {diff_por}% more than their female counterparts when their BMI < 30 \".format(diff_por = diff_por))\n\ndf_bmi_greater_than_or_equal_30 = df_smokers[df_smokers.bmi >= 30]\ndf_two = df_bmi_greater_than_or_equal_30.groupby('sex').mean().reset_index()\n\nmale_bmi_greq_30 = df_two[df_two.sex == 'male'].charges.sum()\nfemale_bmi_greq_30 = df_two[df_two.sex == 'female'].charges.sum()\n\n\nmale_female_sum = male_bmi_greq_30 + female_bmi_greq_30\npor_male_greq_30 = male_bmi_greq_30 / male_female_sum\npor_female_greq_30 = female_bmi_greq_30 / male_female_sum\n\ndiff_por_greq = round((por_male_greq_30 - por_female_greq_30), 4) * 100\ndiff_por_greq = abs(round(diff_por_greq, 4))\n#print(\"Male smokers are expected to pay approximately {diff_por_greq}% less than their female counterparts when their BMI >= 30\".format(diff_por_greq = diff_por_greq))\n\n#print(df_one)\n#print(df_two)\n#df3 = pd.concat([df_one, df_two])\n#print(df3)\n\nfig, ax = plt.subplots(1,2,figsize=(8,6))\nsns.set_style('darkgrid')\nsns.set(font_scale = 0.8)\n\n#BMI is less than 30\nsns.set_palette('bright')\nsns.barplot(x = df_one.sex, y = df_one.charges, ax = ax[0])\nax[0].set_xlabel('Sex')\nax[0].set_ylabel('Insurance Cost (USD)')\nax[0].set_title('Average Smoker Insurance Cost with BMI < 30')\n\n\n#BMI is greater than or equal to 30\nsns.set_palette('dark')\nsns.barplot(x = df_two.sex, y = df_two.charges, ax = ax[1])\nax[1].set_xlabel('Sex')\nax[1].set_ylabel('Insurance Cost (USD)')\nax[1].set_title('Average Smoker Insurance Cost with BMI >= 30')\n\nplt.tight_layout(pad = 4)\nplt.show()\nplt.clf\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-11-output-1.png){width=691 height=495}\n:::\n\n::: {.cell-output .cell-output-display execution_count=10}\n```\n<function matplotlib.pyplot.clf()>\n```\n:::\n:::\n\n\n## Approaching the Analysis of Nonsmokers\n\nConsidered Factors: To understand the underlying causes of outliers or extreme values, several key factors warrant examination, including region, BMI, sex, children, and age. However, it is important to acknowledge that identifying the precise factors contributing to these outliers may present challenges and require further investigation.\n\n### Analysis of Insurance Costs for Nonsmokers: Boxplot and Histogram Distribution\n\nThe distribution of insurance costs for nonsmokers exhibits a right-skewed pattern, indicating a higher concentration of lower-cost cases. The interquartile range suggests a relatively narrow spread between the first and third quartiles.\n\n::: {.cell execution_count=11}\n``` {.python .cell-code}\nIQR = stats.iqr(df_nonsmokers.charges, interpolation = 'midpoint')\nIQR = round(IQR, 2)\nprint(IQR)\n\n\nfig, (ax1, ax2) = plt.subplots(1,2,figsize=(8,6))\n#boxplot\nsns.boxplot(y = df_nonsmokers.charges, ax = ax1)\nax1.set_ylabel('Insurance cost (USD)')\nax1.set_title('Insurance Cost Boxplot for Nonsmokers')\n\n#histogram\nsns.histplot(df_nonsmokers.charges, bins = 40, ax = ax2)\nax2.set_xlabel('Insurance Cost (USD)')\nax2.set_title('Insurance Cost Distribution for Nonsmokers')\n\nplt.tight_layout(pad = 4)\nplt.show()\nplt.clf()\n#right skewed distribution...explain potential causes:  Male and Female? BMI?\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n7378.07\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-12-output-2.png){width=684 height=494}\n:::\n\n::: {.cell-output .cell-output-display}\n```\n<Figure size 672x480 with 0 Axes>\n```\n:::\n:::\n\n\n### Analysis of Insurance Costs for Nonsmokers\n\nThe interquartile range of insurance costs for nonsmokers is $7,378.07, indicating a relatively narrow spread of data between the first and third quartiles.\n\n::: {.cell execution_count=12}\n``` {.python .cell-code}\n#find mean of insurance cost for nonsmokers\nnonsmoker_mean = round(np.mean(df_nonsmokers.charges), 2)\n#print('The nonsmoker average insurance cost for being a smoker: ${mean}'.format(mean = nonsmoker_mean))\n\n#find median of insurance cost for nonsmokers\nnonsmoker_median = round(np.median(df_nonsmokers.charges), 2)\n#print('The nonsmoker median insurance cost for being a smoker: ${median}'.format(median = nonsmoker_median))\n\n#find standard deviation...\nnonsmoker_std = round(np.std(df_nonsmokers.charges),2)\n#print('The nonsmoker standard deviation is: ${std}'.format(std = nonsmoker_std))\n\n#let's see the variance\nnonsmoker_var = round(np.var(df_nonsmokers.charges),2)\n#print('The nonsmoker variance is: {var}'.format(var = nonsmoker_var))\n\n#maximum cost\nnonsmoker_max = round(np.max(df_nonsmokers.charges), 2)\n#print('The nonsmoker maximum insurance cost is: ${max}'.format(max = nonsmoker_max))\n\n#minimum cost\nnonsmoker_min = round(np.min(df_nonsmokers.charges), 2)\n#print('The nonsmoker minimum insurance cost is: ${min}'.format(min = nonsmoker_min))\n\n#For explaination a high standard deviation tells us that here are other reasons the cost is so high since it varies signifcantly\n```\n:::\n\n\n### Analyzing Male Nonsmokers: Key Findings\n\nGraph One: Cost Distribution\nThe cost distribution for male nonsmokers exhibits a right-skewed pattern. It is important to consider the median as the most appropriate measure of central tendency, given the presence of skewness in the distribution.\n\nGraph Two: Average Cost per Child\nThere is a notable trend indicating that having more children is associated with higher average insurance costs for male nonsmokers. However, an interesting exception is observed for individuals with five or more children, as their insurance costs show a significant decrease. The lowest average cost is observed for individuals with no children.\n\nGraph Three: Cost vs BMI with Region\nNo correlation is found between the insurance cost and BMI of male nonsmokers. This finding highlights the absence of a relationship between these two variables. Similarly, no discernible trends are observed with respect to different regions.\n\nGraph Four: Cost vs Age with Children\nA strong linear relationship is observed between insurance cost and age for male nonsmokers. Additionally, the number of children shows a secondary trend, where fewer children correspond to lower insurance costs, while more children align with higher insurance costs. It is worth noting that some outliers deviate from the overall trend line.\n\nGraph Five: Average Cost per Region\nNo significant insights can be drawn from the barplot of average cost per region for male nonsmokers. The data does not reveal any distinct variations among different regions in terms of insurance costs.\n\nGraph Six: Boxplot of Male Nonsmoker Insurance Cost\nThe boxplot provides valuable information about the spread of insurance costs for male nonsmokers. It allows for visualizing the range, quartiles, and potential outliers within the data.\n\nOverall, these analyses shed light on various factors influencing insurance costs for male nonsmokers, such as the number of children and age. However, the relationship between BMI and insurance cost appears to be inconclusive, while regional differences do not show significant variations.\n\n::: {.cell execution_count=13}\n``` {.python .cell-code}\n#seperate all male nonsmokers from the main data set\ndf_male_nonsmoker = df_nonsmokers[df_nonsmokers.sex == 'male']\n\n#print(male_nonsmoker.head())\n\nfig, ax = plt.subplots(2,3,figsize=(10,6))\nsns.set_style('darkgrid')\nsns.set(font_scale = 0.5)\n\n#histogram male nonsmoker\nsns.histplot(df_male_nonsmoker.charges, bins = 40, ax = ax[0,0])\nax[0,0].set_title('Male Nonsmoker Insurance Cost Distribution')\nax[0,0].set_xlabel('Insurnance Cost (USD)')\n\n#barplot for insurance cost of male nonsmokers per child\ndf_children = df_male_nonsmoker.groupby('children').mean().reset_index()\nsns.barplot(x = df_children.children, y = df_children.charges, ax = ax[0,1])\nax[0,1].set_title('Average Male Nonsmoker Insurance Cost Per Child')\nax[0,1].set_xlabel('Number of Children')\nax[0,1].set_ylabel('Insurance Cost (USD)')\n\n#scatterplot for insurance cost of male nonsmokers by BMI\nsns.scatterplot(x = df_male_nonsmoker.bmi, y = df_male_nonsmoker.charges,\n                hue = df_male_nonsmoker.region,\n                size = df_male_nonsmoker.region,\n                sizes = (7.5, 25), ax = ax[0,2])\nax[0,2].axvline(x = 30, color = 'gray', label = 'Obese BMI')\nax[0,2].set_title('Male Nonsmoker Insurance Cost vs BMI')\nax[0,2].set_xlabel('BMI')\nax[0,2].set_ylabel('Insurance Costs (USD)')\n\n#scatterplot for insurance cost of male nonsmokers by age\nsns.scatterplot(x = df_male_nonsmoker.age, y = df_male_nonsmoker.charges,\n                hue = df_male_nonsmoker.children,\n                size = df_male_nonsmoker.children, sizes = (12.5,25),\n                ax = ax[1,0])\nax[1,0].set_title('Male Nonsmoker Insurance Cost vs Age')\nax[1,0].set_xlabel('Age')\nax[1,0].set_ylabel('Insurance Costs (USD)')\n\n#barplot for insurance cost of male nonsmokers per region\ndf_region = df_male_nonsmoker.groupby('region').mean().reset_index()\nsns.barplot(x = df_region.region,  y = df_region.charges, ax = ax[1,1])\nax[1,1].set_title('Average Male Nonsmoker Insurance Cost Per Region')\nax[1,1].set_xlabel('Region')\nax[1,1].set_ylabel('Insurance Cost (USD)')\n\n#boxplot of male nonsmoker boxplot\nsns.boxplot(x = df_male_nonsmoker.charges, ax = ax[1,2])\nax[1,2].set_title('Male Nonsmoker Insurance Cost Boxplot')\nax[1,2].set_xlabel('Insurance Cost (USD)')\n\nplt.tight_layout(pad = 4)\nplt.show()\nplt.clf()\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-14-output-1.png){width=915 height=533}\n:::\n\n::: {.cell-output .cell-output-display}\n```\n<Figure size 672x480 with 0 Axes>\n```\n:::\n:::\n\n\n::: {.cell execution_count=14}\n``` {.python .cell-code}\n#highlight scatter plot for linear trend\n\nsns.set(font_scale = 0.8)\nplt.figure(figsize = (8, 6))\nsns.scatterplot(x = df_male_nonsmoker.age, y = df_male_nonsmoker.charges,\n                hue = df_male_nonsmoker.children,\n                size = df_male_nonsmoker.children,\n                sizes = (7.5, 20))\nplt.title('Male Nonsmoker Insurance Cost vs Age')\nplt.xlabel('Age')\nplt.ylabel('Insurance Costs (USD)')\nplt.legend(bbox_to_anchor = (1.0, 1))\n\nplt.show()\nplt.clf()\n#highlight this\n#solid evidence that as age increases, your insurance cost increases as well.\n#people with more children see a slightly higher cost overall \n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-15-output-1.png){width=732 height=522}\n:::\n\n::: {.cell-output .cell-output-display}\n```\n<Figure size 672x480 with 0 Axes>\n```\n:::\n:::\n\n\n### Analyzing Female Nonsmokers: A Comparison with Male Nonsmokers\n\nGraph One: Cost Distribution\nSimilar to male nonsmokers, the cost distribution for female nonsmokers exhibits a right-skewed pattern. This suggests that the median is a more appropriate measure of central tendency than the mean, considering the skewness in the distribution.\n\nGraph Two: Average Cost per Child\nSimilarly to male nonsmokers, there is a discernible trend indicating that having more children is associated with higher average insurance costs for female nonsmokers. However, consistent with the findings among smokers, females with five or more children experience a decrease in average costs. Notably, the lowest average cost is observed among females with no children.\n\nGraph Three: Cost vs BMI with Region\nAs with male nonsmokers, there is no correlation between the insurance cost and BMI among female nonsmokers. This lack of relationship remains consistent, and no significant trends are observed across different regions.\n\nGraph Four: Cost vs Age with Children\nIn line with the observations for male nonsmokers, there is a strong linear relationship between insurance cost and age among female nonsmokers. A secondary trend is also evident, indicating that insurance costs tend to be lower for females with fewer children and higher for those with more children. It is worth noting that outliers do not conform to the overall trend line.\n\nGraph Five: Average Cost per Region\nThere is a slight trend suggesting regional differences in insurance costs among female nonsmokers. On average, the northeast region exhibits higher costs compared to the southwest region.\n\nGraph Six: Boxplot of Male Smoker Insurance Cost\nWhile not directly related to the analysis of female nonsmokers, it is noteworthy to examine the spread of insurance costs among male smokers for comparative purposes\n\n::: {.cell execution_count=15}\n``` {.python .cell-code}\n#seperate all female nonsmokers from the main data set\ndf_female_nonsmoker = df_nonsmokers[df_nonsmokers.sex == 'female']\n\n#print(df_female_nonsmoker.head())\n\nfig, ax = plt.subplots(2,3,figsize=(10,6))\nsns.set_style('darkgrid')\nsns.set(font_scale = 0.5)\n\n#histogram Female nonsmoker\nsns.histplot(df_female_nonsmoker.charges, bins = 40, ax = ax[0,0])\nax[0,0].set_title('Female Nonsmoker Insurance Cost Distribution')\nax[0,0].set_xlabel('Insurnance Cost (USD)')\n\n#barplot for insurance cost of Female nonsmokers per child\ndf_children = df_female_nonsmoker.groupby('children').mean().reset_index()\nsns.barplot(x = df_children.children, y = df_children.charges, ax = ax[0,1])\nax[0,1].set_title('Average Female Nonsmoker Insurance Cost Per Child')\nax[0,1].set_xlabel('Number of Children')\nax[0,1].set_ylabel('Insurance Cost (USD)')\n\n#scatterplot for insurance cost of Female nonsmokers by BMI\nsns.scatterplot(x = df_female_nonsmoker.bmi, y = df_female_nonsmoker.charges,\n                hue = df_female_nonsmoker.region,\n                size = df_female_nonsmoker.region,\n                sizes = (7.5, 25), ax = ax[0,2])\nax[0,2].axvline(x = 30, color = 'gray', label = 'Obese BMI')\nax[0,2].set_title('Female Nonsmoker Insurance Cost vs BMI')\nax[0,2].set_xlabel('BMI')\nax[0,2].set_ylabel('Insurance Costs (USD)')\nax[0,2].legend(bbox_to_anchor = (1.0, 1))\n\n#scatterplot for insurance cost of Female nonsmokers by age\nsns.scatterplot(x = df_female_nonsmoker.age, y = df_female_nonsmoker.charges,\n                hue = df_female_nonsmoker.children,\n                size = df_female_nonsmoker.children, sizes = (12.5,25),\n                ax = ax[1,0])\nax[1,0].set_title('Female Nonsmoker Insurance Cost vs Age')\nax[1,0].set_xlabel('Age')\nax[1,0].set_ylabel('Insurance Costs (USD)')\n\n#barplot for insurance cost of Female nonsmokers per region\ndf_region = df_female_nonsmoker.groupby('region').mean().reset_index()\nsns.barplot(x = df_region.region,  y = df_region.charges, ax = ax[1,1])\nax[1,1].set_title('Average Female Nonsmoker Insurance Cost Per Region')\nax[1,1].set_xlabel('Region')\nax[1,1].set_ylabel('Insurance Cost (USD)')\n\n#boxplot of Female nonsmoker boxplot\nsns.boxplot(x = df_male_nonsmoker.charges, ax = ax[1,2])\nax[1,2].set_title('Male Nonsmoker Insurance Cost Boxplot')\nax[1,2].set_xlabel('Insurance Cost (USD)')\n\nplt.tight_layout(pad = 4)\nplt.show()\nplt.clf()\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-16-output-1.png){width=915 height=533}\n:::\n\n::: {.cell-output .cell-output-display}\n```\n<Figure size 672x480 with 0 Axes>\n```\n:::\n:::\n\n\n## Nonsmokers vs Smokers\n\nBased on the analysis conducted on smokers and nonsmokers, it can be observed that smoking status significantly impacts health insurance costs. Both male and female smokers experience higher insurance costs compared to their nonsmoking counterparts. Furthermore, nonsmokers tend to have a more favorable cost distribution, characterized by lower median costs and less variability. This highlights the importance of smoking cessation interventions and promoting a nonsmoking lifestyle to mitigate the financial burden associated with health insurance for both individuals and the healthcare system.\n\n::: {.cell execution_count=16}\n``` {.python .cell-code}\n#Nonsmokers\ndf_avg = df_nonsmokers.groupby('sex').mean().reset_index()\n\n\nnonsmoker_male =  round((df_avg[df_avg.sex == 'male'].charges.sum()),2)\nnonsmoker_female = round((df_avg[df_avg.sex == 'female'].charges.sum()),2)\ndiff = round((nonsmoker_female - nonsmoker_male), 2)\ntotal = nonsmoker_male + nonsmoker_female\nnonsmoker_percent_diff = round((((nonsmoker_female - nonsmoker_male) / total) * 100),2) \n\n\nprint(\"The average insurance cost for a nonsmoker male is ${avg}.\".format(avg = nonsmoker_male))\nprint(\"The average insurance cost for a nonsmoker female is ${avg}.\".format(avg = nonsmoker_female))\nprint(\"The average difference in insurance cost for nonsmoker male and female is ${diff}.\\n\".format(diff = diff))\nprint(\"The nonsmoker males are charged {percent}% less than their female counterpart.\\n\".format(percent = nonsmoker_percent_diff))\n\n#Smokers\ndf_avg2 = df_smokers.groupby('sex').mean().reset_index()\n\n\nsmoker_male =  round((df_avg2[df_avg2.sex == 'male'].charges.sum()),2)\nsmoker_female = round((df_avg2[df_avg2.sex == 'female'].charges.sum()),2)\ndiff2 = round((smoker_male - smoker_female), 2)\ntotal = smoker_male + smoker_female\nsmoker_percent_diff = round((((smoker_male - smoker_female) / total) * 100),2) \n\n\nprint(\"The average insurance cost for a smoker male is ${avg}.\".format(avg = smoker_male))\nprint(\"The average insurance cost for a smoker female is ${avg}.\".format(avg = smoker_female))\nprint(\"The average difference in insurance cost for smoker male and female is ${diff}.\\n\".format(diff = diff2))\nprint(\"The smoker males are charged {percent}% more than their female counterpart.\\n\".format(percent = smoker_percent_diff))\n\n#Comparision\n\nins_cost_diff_male = smoker_male - nonsmoker_male\nins_cost_diff_female = smoker_female - nonsmoker_female\nins_cost_avg_diff = diff2 - diff\n\n\nins_cost_percent_male = round((smoker_male / nonsmoker_male) * 100, 2)\nins_cost_percent_female = round((smoker_female / nonsmoker_female) * 100, 2)\n\n\n\nprint(\"On average, a male nonsmoker pays ${nonsmoker}, while a female smoker pays ${smoker}.\".format(nonsmoker = nonsmoker_male, smoker = smoker_male))\nprint(\"The difference in their insurance charges is ${diff_male}.\".format(diff_male = ins_cost_diff_male))\nprint(\"A male smoker will get charged approxmiately {percent}% more than a nonsmoker.\\n\".format(percent = ins_cost_percent_male))\n\nprint(\"On average, a female nonsmoker pays ${nonsmoker}, while a female smoker pays ${smoker}.\".format(nonsmoker = nonsmoker_female, smoker = smoker_female))\nprint(\"The difference in their insurance charges is ${diff_female}.\".format(diff_female = ins_cost_diff_female))\nprint(\"A female smoker will get charged approxmiately {percent}% more than a nonsmoker.\".format(percent = ins_cost_percent_female))\n\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nThe average insurance cost for a nonsmoker male is $8087.2.\nThe average insurance cost for a nonsmoker female is $8762.3.\nThe average difference in insurance cost for nonsmoker male and female is $675.1.\n\nThe nonsmoker males are charged 4.01% less than their female counterpart.\n\nThe average insurance cost for a smoker male is $33042.01.\nThe average insurance cost for a smoker female is $30679.0.\nThe average difference in insurance cost for smoker male and female is $2363.01.\n\nThe smoker males are charged 3.71% more than their female counterpart.\n\nOn average, a male nonsmoker pays $8087.2, while a female smoker pays $33042.01.\nThe difference in their insurance charges is $24954.81.\nA male smoker will get charged approxmiately 408.57% more than a nonsmoker.\n\nOn average, a female nonsmoker pays $8762.3, while a female smoker pays $30679.0.\nThe difference in their insurance charges is $21916.7.\nA female smoker will get charged approxmiately 350.12% more than a nonsmoker.\n```\n:::\n:::\n\n\n## Results\n\nThe impact of smoking on health insurance premiums is undeniable, as demonstrated by the substantial increases in charges for both male and female smokers. When coupled with a BMI of 30 or higher, smokers face an additional financial burden. Male smokers experience a significant 52% increase in insurance charges, while female smokers face a 49% rise. It is important to note that these increases are in addition to the base premium already charged to smokers.\n\nThe severity of the situation becomes apparent when comparing the costs borne by smokers and nonsmokers. Male smokers pay a staggering 408.57% more than their nonsmoking counterparts, while female smokers face an astronomical 350.12% increase. This data reinforces the notion that unhealthy lifestyle choices, such as smoking and an unhealthy BMI, result in punitive measures in the form of higher health insurance premiums. It is worth mentioning that insurance premiums gradually increase over time in line with the aging process.\n\nWhile this project provides valuable insights, there are still numerous avenues for further exploration. One potential direction involves applying machine learning techniques to assess the representativeness of the sample and refine the accuracy of the conclusions. Such analyses have the potential to drive advancements in the field of health insurance.\n\n## Further Study\n\nAccording to a reputable source (Medical News Today), BMI, which relies on height and weight measurements, is an inadequate indicator of body fat content. It fails to consider important factors such as muscle mass, bone density, overall body composition, and variations based on race and sex.\n\nFurthermore, health insurance companies employ a practice known as tobacco rating, as outlined in the Affordable Care Act (ACA). Smokers can be charged a tobacco surcharge of up to 50% (or premiums 1.5 times higher) compared to non-smokers. This allows insurance providers to adjust prices based on tobacco usage and the associated health risks.\n\nReferences:\n\n[Medical News Today: \"BMI (body mass index): What is it and is it useful?\"](https://www.medicalnewstoday.com/articles/265215)\n\n[HealthMarkets: \"Smoking and Health Insurance\"](https://www.healthmarkets.com/content/smoking-and-health-insurance)\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {}
  }
}